# -*- coding: utf-8 -*-
"""
Created on Mon Feb 12 18:13:08 2018

@author: emily
"""

import unittest
from parameterized import parameterized
import pipeline
import matlab
import numpy as np


class PipelineTest(unittest.TestCase):        
    
    # define some more assertions for our classes
    def assertModelEqual(self, actual, expected):
        # np.testing.assert_array_equal() will actually accept floats etc too
        np.testing.assert_array_almost_equal(actual.vs, expected.vs)
        np.testing.assert_array_almost_equal(actual.all_deps, expected.all_deps)
        np.testing.assert_array_equal(actual.idep, expected.idep) # integers
        self.assertAlmostEqual(actual.std_rf, expected.std_rf)
        self.assertAlmostEqual(actual.lam_rf, expected.lam_rf)
        self.assertAlmostEqual(actual.std_swd, expected.std_swd, places = 4)
    
    def assertCovarianceMatrixEqual(self, actual, expected):
        np.testing.assert_array_almost_equal(actual.R, expected.R, decimal = 6)
        np.testing.assert_array_almost_equal(actual.Covar, expected.Covar, decimal = 6)
        np.testing.assert_array_almost_equal(actual.invCovar, expected.invCovar, decimal = 6)
        self.assertAlmostEqual(actual.detCovar, expected.detCovar, places = 6)
        
    def assertFullVelModelEqual(self, actual, expected):
        np.testing.assert_array_almost_equal(actual.vs, expected.vs, decimal = 3)
        np.testing.assert_array_almost_equal(actual.vp, expected.vp, decimal = 3)
        np.testing.assert_array_almost_equal(actual.rho, expected.rho, decimal = 3)
        np.testing.assert_array_almost_equal(actual.thickness, 
                                             expected.thickness, decimal = 3)
        np.testing.assert_array_almost_equal(actual.avdep, 
                                             expected.avdep, decimal = 3)
        self.assertAlmostEqual(actual.ray_param, expected.ray_param, places = 4)
        
    def assertBodyWavesEqual(self, actual, expected):
        np.testing.assert_array_almost_equal(actual.amp_R, expected.amp_R, decimal = 2)
        np.testing.assert_array_almost_equal(actual.amp_Z, expected.amp_Z, decimal = 2)
        self.assertAlmostEqual(actual.dt, expected.dt, places = 2)
        
    def assertRotBodyWavesEqual(self, actual, expected):
        np.testing.assert_array_almost_equal(actual.amp_P, expected.amp_P, decimal = 2)
        np.testing.assert_array_almost_equal(actual.amp_SV, expected.amp_SV, decimal = 2)
        self.assertAlmostEqual(actual.dt, expected.dt, places = 2)
        
    def assertSynthRFalmostEqual(self, actual, expected):
        np.testing.assert_array_almost_equal(actual.amp, expected.amp,
                                             decimal = 1)
        # Note: I can't get this to work to 2 d.p. - maybe fft/ifft are
        #       being implemented slightly differently?
        self.assertAlmostEqual(actual.dt, expected.dt, places = 2)
        
    def assertSurfaceWaveDispEqual(self, actual, expected):
        np.testing.assert_array_almost_equal(actual.c, expected.c, 
                                             decimal = 2)
        np.testing.assert_array_equal(actual.period, expected.period)
        

    
    
    
    #  Test initial model 
    deps = np.concatenate((np.arange(0,10,0.2), 
                           np.arange(10,60,1), np.arange(60,201,5)))
    normdist =  np.random.normal(0,0.5,int(1e6)) # Gaussian distribution, std = 0.5
    
    @parameterized.expand([
        ("Seed == 1", normdist, 1,
             pipeline.Model(vs = np.array(1.17), all_deps = deps, idep = np.array(16), 
                            std_rf = 0.5, lam_rf = 0.2, std_swd = 0.15)),       
        ("Seed == 10", normdist, 10, 
             pipeline.Model(vs = 3.36, all_deps = deps, idep = 109, 
                            std_rf = 0.5, lam_rf = 0.2, std_swd = 0.15)),
    ])
       
    def test_InitialModel(self, name, normdist, random_seed, expected):
        model= pipeline.InitialModel(normdist,random_seed)
        self.assertModelEqual(model, expected)
        
    del deps, normdist
    
    
    
    # Test checking prior
    deps = np.append(np.arange(0,60,1), np.arange(60,201,5))
    lims = pipeline.Limits(
            vs = (0.5,5), dep = (0,200), std_rf = (0.005,0.5), 
            lam_rf = (0.05,0.5), std_swd = (0.01,0.2),
            )  
    model = pipeline.Model(
            vs = np.array([1.4,4,5]), all_deps = deps, idep = np.array([0,42,64]), 
            std_rf = 0.15, lam_rf = 0.2, std_swd = 0.15,
            )
    
    @parameterized.expand([
            ("Should work", lims, model, True),
            ("Vs too small", lims, model._replace(vs = np.array([0.4,1.4,4])), False),
            ("Vs too big", lims, model._replace(vs = np.array([0.5,1.4,5.6])), False),
            ("Vs lims", lims._replace(vs = (1.5,5)), model, False), 
            ("Dep ind wrong", lims, model._replace(idep = np.array([-1,42,89])), False),
            ("Dep lims", lims._replace(dep = (50, 100)), model, False),
            ("Std_rf", lims, model._replace(std_rf = 0.51),False),
            ("Std_swd", lims._replace(std_swd = (0,0.1)), model, False),
            ("Lam_rf", lims, model._replace(lam_rf = 1), False),
#            ("One layer", lims,
#                 model._replace(vs = np.array(1), idep = np.array(16)), True),
            ("One layer", lims,
                 model._replace(vs = np.array([1]), idep = np.array([16])), True)
            ])
    
    def test_CheckPrior(self,name,lims,model,expected):
        self.assertEqual(expected,pipeline.CheckPrior(model,lims))
    
    del deps, lims, model
    
    
    
    
    # Test covariance matrix calculation
    model = pipeline.Model(vs = 0, all_deps = 0, idep = 0, # irrelevant
            std_rf = np.sqrt(0.1), lam_rf = 0.2, std_swd = np.sqrt(0.2),
            )
    rf_obs = pipeline.RecvFunc(amp = np.arange(2), 
                               dt = 0.25)  # length and dt matter
    swd_obs = pipeline.SurfaceWaveDisp(period = np.arange(1), # only length matters
                                       c = np.arange(0)) # irrelevant 
    # Note that all determinants have undergone the fix (as in pipeline)
    # to make them easier to deal with - i.e. make all so floor(log10(det))=0
    
    @parameterized.expand([
            #("1x1 rf", model, rf_obs, swd_obs, pipeline.CovarianceMatrix(1,1,1)),
            ("2x2 rf, 1 sw", model, rf_obs, swd_obs,
                 pipeline.CovarianceMatrix(
                        R = np.array([[1, 0.928302], # calculated in Matlab (code gave
                             [0.928302, 1]]), # ouput as figure 4 from KL14)
                        Covar = np.array([[0.1, 0.0928302, 0],
                                 [0.0928302, 0.1, 0],
                                 [0,0,0.2]]),
                        invCovar = np.array([[72.33026556,-67.144357,0],
                                    [-67.144357,72.33026556,0],
                                    [0,0,5]]), 
                        detCovar = 2.7650942305, # 0.00027650942305,
                               ),
                         ),
            ("3x3 rf, 4 sw", model, rf_obs._replace(amp = np.arange(3)), 
                 swd_obs._replace(period = np.arange(4)),
                 pipeline.CovarianceMatrix(
                        R = np.array([[1, 0.928302, 0.818653],
                             [0.928302, 1, 0.928302],
                             [0.818653, 0.928302, 1]]),
                        Covar = np.array([[0.1, 0.0928302, 0.0818653,0,0,0,0],
                             [0.0928302, 0.1, 0.0928302,0,0,0,0],
                             [0.0818653, 0.0928302, 0.1,0,0,0,0],
                             [0,0,0,0.2,0,0,0],[0,0,0,0,0.2,0,0],
                             [0,0,0,0,0,0.2,0],[0,0,0,0,0,0,0.2]]),
                        invCovar = np.array([[80.1131353,-97.549094,24.970184,0,0,0,0],
                                    [-97.549094,191.11011086,-97.549094,0,0,0,0],
                                    [24.970184,-97.549094,80.1131353,0,0,0,0],
                                    [0,0,0,5,0,0,0],[0,0,0,0,5,0,0],
                                    [0,0,0,0,0,5,0],[0,0,0,0,0,0,5]]),
                        detCovar = 2.761189, #0.00000002761189,
                               ),
                         ),
            ("change std", model._replace(std_rf = np.sqrt(10), std_swd = 2),
                 rf_obs, swd_obs,
                 pipeline.CovarianceMatrix(
                        R = np.array([[1, 0.928302], # calculated in Matlab (code gave
                             [0.928302, 1]]), # ouput as figure 4 from KL14)
                        Covar = np.array([[10, 9.28302369, 0],
                                 [9.28302369, 10, 0],
                                 [0,0,4]]),
                        invCovar = np.array([[0.7233027,-0.671444,0],
                                    [-0.671444,0.7233027,0],
                                    [0,0,0.25]]), 
                        detCovar = 5.53018846104696, #55.3018846104696,
                               ),
                         ),
            ("change lam",model._replace(lam_rf = 1), rf_obs, swd_obs,
                 pipeline.CovarianceMatrix(
                        R = np.array([[1,0.35326101],
                              [0.35326101,1]]),
                       Covar = np.array([[0.1, 0.035326101, 0],
                                 [0.035326101, 0.1, 0],
                                 [0,0,0.2]]),
                        invCovar = np.array([[11.42587289,-4.0363154497,0],
                                    [-4.0363154497,11.42587289,0],
                                    [0,0,5]]), 
                        detCovar = 1.7504133111, #0.0017504133111,
                             ),
                         )
            ])
    def test_CalcCovarianceMatrix(self, name, model, rf_obs, swd_obs, expected):
        cov = pipeline.CalcCovarianceMatrix(model, rf_obs, swd_obs)
        self.assertCovarianceMatrixEqual(cov, expected)
    del model, rf_obs, swd_obs

        
    
    # test Synthetics for RF in a few steps...
    # 1. Test the velocity model change
    deps = np.concatenate((np.arange(0,10,0.2), np.arange(10,60,1), np.arange(60,201,5)))
    model = pipeline.Model(
            vs = np.array([4,4.5,4.7,5]), all_deps = deps, idep = np.array([60,80,108,120]), 
            std_rf = 0, lam_rf = 0, std_swd = 0, # irrelevant
            )
    @parameterized.expand([
            ("input model",model,pipeline.SynthModel(
                    vs = np.array([4.,4.5, 4.7,5.]), 
                    vp = np.array([6.9357, 7.875, 8.225, 8.75]),
                    thickness = np.array([30, 40, 60, 60]),
                    layertops = np.array([0, 30, 70, 130]),
                    avdep = np.array([15, 50, 100, 160]),
                    rho = np.array([2.9496, 3.4268, 3.4390, 3.4367]),
                    ray_param = 0.0618,
                    )
                ),
            ("vary vels", model._replace(vs = np.array([3,4.2,4.6,5.2])),
             pipeline.SynthModel(
                    vs = np.array([3,4.2,4.6,5.2]),
                    vp = np.array([5.0506,7.3307,8.05,9.1]),
                    thickness = np.array([30, 40, 60, 60]), 
                    layertops = np.array([0, 30, 70, 130]),
                    avdep = np.array([15, 50, 100, 160]),
                    rho = np.array([2.5426, 3.0674, 3.4329, 3.4406]),
                    ray_param = 0.0618,
                    )
             ),
             ("vary deps", model._replace(idep = np.array([10,50,85,125])),
              pipeline.SynthModel(
                    vs = np.array([4.,4.5, 4.7,5.]), 
                    vp = np.array([6.9357, 7.875, 8.225, 8.75]),
                    thickness = np.array([6., 21.5, 87.5, 87.5]), 
                    layertops = np.array([0, 6, 27.5, 115]),
                    avdep = np.array([3., 16.75, 71.25, 158.75]),
                    rho = np.array([2.9496, 3.4268, 3.4379, 3.4367]),
                    ray_param = 0.0618,
                    )
             ),
             ("vary both", model._replace(idep = np.array([10,50,110,125]),
                                          vs = np.array([4.,4.499999, 4.7,5.])),
              pipeline.SynthModel(
                    vs = np.array([4.,4.5, 4.7,5.]), 
                    vp = np.array([6.9357, 7.9062, 8.225, 8.75]),
                    thickness = np.array([6., 54., 87.5, 87.5]),
                    layertops = np.array([0, 6, 60, 147.5]),
                    avdep = np.array([3., 33., 103.75, 191.25]),
                    rho = np.array([2.9496, 3.2579, 3.4391, 3.4381]),
                    ray_param = 0.0618,
                    )
              ),
            ("Crustal vels only", model._replace(vs = np.array([1.7, 2.6, 3.6, 4.4])),
             pipeline.SynthModel(
                     vs = np.array([1.7, 2.6, 3.6, 4.4]),
                     vp = np.array([3.238876, 4.408495,6.1488126, 7.7179102]),
                     thickness = np.array([30., 40., 60., 60.]),
                     layertops = np.array([0, 30, 70, 130]),
                     avdep = np.array([15., 50., 100., 160.]),
                     rho = np.array([2.2723679, 2.4495676, 2.7493737, 3.193219]),
                     ray_param = 0.0618,
                     )
             ),
             ("Mantle vels only", model._replace(vs = np.array([4.5, 4.6, 4.7, 5.])),
              pipeline.SynthModel(
                     vs = np.array([4.5, 4.6, 4.7, 5.]),
                     vp = np.array([7.875, 8.05, 8.225, 8.75]),
                     thickness = np.array([30., 40., 60., 60.]),
                     layertops = np.array([0, 30, 70, 130]),
                     avdep = np.array([15., 50., 100., 160.]),
                     rho = np.array([3.4268, 3.431978, 3.438984, 3.43669]),
                     ray_param = 0.0618,
                      )
              ),
              ("Last layer only", model._replace(vs = np.array([4.7]),
                                                 idep = np.array([128])),
                pipeline.SynthModel(vs = np.array([4.7]), vp = np.array([8.225]),
                                    thickness = np.array(deps[128]),
                                    layertops = np.array([0]), 
                                    avdep = np.array(deps[128]/2),
                                    rho = np.array([3.439]), ray_param = 0.0618)
                
                ),
            
            ])
    def test_MakeFullVelModel(self, name, model, expected):
        fullvel = pipeline.MakeFullModel(model)
        self.assertFullVelModelEqual(fullvel, expected)
    
    del model
    
    # Test propagator matrix
    model = pipeline.Model(
            vs = np.array([4,4.6]), all_deps = deps, idep = np.array([60,80]), 
            std_rf = 0, lam_rf = 0, std_swd = 0, # irrelevant
            )
    i_loop = 1
    @parameterized.expand([
            ("Moho only", model, i_loop,
             np.array([[-0.6205, 1j*0.3189, 0.0044, 1j*-0.001],
                  [1j*0.115, -1.8854, 1j*-0.0014, 0.0025],
                  [-1.3889, 1j*-0.3424, -0.0018, 1j*-0.0038],
                  [1j*0.526, 0.9235, 1j*0.001, 0.0062]])
             ),
            ("Change wavenumber", model, 349.,
             np.array([[0.1657, 1j*1.5101, -0.00203124, 1j*-0.00091424],
                  [1j*0.5551, 0.7971, 1j*-0.00535876, -0.00120837],
                  [-0.1656, 1j*0.8819, -0.0003388096, 1j*0.0086396689],
                  [1j*-1.343, -0.0489916, 1j*-0.00099158, 0.00102660]])
            ),
            ("Change model", model._replace(vs = np.array([3.5, 4.7])), 349,
             np.array([[0.02145, 1j*-0.2944, 0.005172, 1j*0.000808],
                      [1j*-0.1184,	-1.786, 1j*0.001907, 0.003193],
                      [1.443,	1j*0.07356, 0.002563, 1j*0.001433],
                      [1j*-0.1079, 0.008377, 1j*-0.0007377, -0.00808]])
            ),
            ("Change model slow", model._replace(vs = np.array([1.2, 3.5]),
                                               idep = np.array([23, 35])),
            109, np.array([[-0.41367, 1.0027j, -0.0020859, -0.012886j],
                           [0.1545j, 0.30185, -0.02812j, -0.0009798],
                           [-1.4598, -0.1868j, -0.0026856, -0.03802j],
                           [0.44619j, -0.032956, 0.01043j, 0.011559]])
            ),
            ("Add layers", model._replace(vs = np.array([1.2, 3.5, 4.4, 4.7]),
                                          idep = np.array([23, 35, 60, 100])),
             35, np.array([[-0.14738, 0.36886j, 0.0056826, -0.008675j],
                           [-0.05274j, -0.51406, -0.01805j, 0.00478],
                           [0.15073, -0.11593j, 0.006755, -0.0125j],
                           [0.6842j, 0.07583, 0.006988j, -0.01986]])
                    
                    ),
    
    ])  
    
    def test_PropagatorMat(self, name, model, i_loop, expected):
        wavenumber = i_loop/102.4*0.0618*2*np.pi
        fullmodel = pipeline.MakeFullModel(model)
        Jacobian = pipeline._CalcPropagatorMatrix(fullmodel,wavenumber,0)
        np.testing.assert_array_almost_equal(Jacobian, expected, decimal = 3)
    
    del i_loop
    
    
    # Test bpfilt - there are some arbitrary parameters (set in matlab.py)
    # that need to have different defaults to give the same vals as Matlab
    @parameterized.expand([
            ("Test", 0.15, 5, 100, 20, 1, 0.25, 0.5, 1,
             np.array([0.31, 0.32, 0.33, 0.33, 0.32, 0.31, 0.29, 0.25, 0.21, 
                       0.15, 0.09, 0.02, -0.05, -0.13, -0.20, -0.26, -0.32, -0.37, 
                       -0.40, -0.42, -0.42, -0.41, -0.38, -0.33, -0.28, -0.21, -0.14, 
                       -0.07, -0.00, 0.06, 0.12, 0.17, 0.20, 0.22, 0.22, 0.21, 
                       0.18, 0.14, 0.09, 0.03, -0.03, -0.09, -0.15, -0.20, -0.24, 
                       -0.27, -0.28, -0.28, -0.27, -0.24, -0.19, -0.14, -0.08, -0.01, 
                       0.05, 0.12, 0.17, 0.22, 0.26, 0.28, 0.29, 0.29, 0.27, 
                       0.23, 0.19, 0.13, 0.07, 0.01, -0.05, -0.11, -0.16, -0.20, 
                       -0.22, -0.24, -0.23, -0.22, -0.18, -0.14, -0.08, -0.02, 0.04, 
                       0.11, 0.17, 0.22, 0.26, 0.29, 0.31, 0.32, 0.30, 0.27, 
                       0.23, 0.18, 0.12, 0.06, -0.00, -0.07, -0.13, -0.17, -0.21, 
                       -0.24, -0.24, -0.24, -0.22, -0.19, -0.14, -0.09, -0.03, 0.03, 
                       0.08, 0.14, 0.18, 0.22, 0.24, 0.25, 0.24, 0.21, 0.18, 
                       0.13, 0.08, 0.02, -0.05, -0.11, -0.16, -0.20, -0.24, -0.25, 
                       -0.25, -0.22, -0.18, -0.12, -0.04, 0.05, 0.16, 0.27])
             ),
             ("Change dt", 0.25, 5, 100, 20, 1, 0.25, 0.5, 1,
             np.array([0.42, 0.42, 0.41, 0.38, 0.33, 0.25, 0.14, 0.03, -0.10, 
                       -0.21, -0.31, -0.37, -0.38, -0.36, -0.29, -0.20, -0.09, 0.02, 
                       0.11, 0.17, 0.20, 0.18, 0.12, 0.03, -0.07, -0.17, -0.26, 
                       -0.32, -0.34, -0.32, -0.26, -0.17, -0.06, 0.04, 0.13, 0.19, 
                       0.22, 0.20, 0.14, 0.06, -0.04, -0.15, -0.23, -0.29, -0.30, 
                       -0.28, -0.22, -0.13, -0.02, 0.09, 0.18, 0.24, 0.27, 0.25, 
                       0.20, 0.11, 0.01, -0.08, -0.17, -0.22, -0.23, -0.21, -0.14, 
                       -0.04, 0.07, 0.19, 0.29, 0.36, 0.39, 0.38, 0.33, 0.25, 
                       0.15, 0.05, -0.05, -0.13, -0.19, -0.21, -0.22, -0.21])
             ),
            ("Change short_T", 0.25, 1, 100, 20, 1, 0.25, 0.5, 1,
             np.array([0.47, 0.24, 0.37, 0.89, 1.20, 0.86, 0.38, 0.31, 0.17, 
                       -0.47, -1.05, -1.02, -0.85, -1.03, -1.06, -0.49, 0.14, 0.27, 
                       0.34, 0.80, 1.13, 0.80, 0.33, 0.26, 0.12, -0.51, -1.08, 
                       -1.05, -0.88, -1.05, -1.08, -0.50, 0.13, 0.26, 0.34, 0.81, 
                       1.14, 0.82, 0.36, 0.29, 0.16, -0.47, -1.04, -1.00, -0.82, 
                       -0.99, -1.01, -0.43, 0.21, 0.35, 0.43, 0.91, 1.24, 0.92, 
                       0.47, 0.40, 0.28, -0.34, -0.90, -0.86, -0.67, -0.83, -0.85, 
                       -0.27, 0.38, 0.53, 0.62, 1.10, 1.44, 1.13, 0.68, 0.62, 
                       0.51, -0.11, -0.67, -0.61, -0.42, -0.58, -0.58, 0.00])
             ),
            ("Change long_T", 0.25, 10, 50, 20, 1, 0.25, 0.5, 1,
             np.array([0.33, 0.28, 0.22, 0.17, 0.13, 0.08, 0.04, 0.00, -0.03, 
                       -0.07, -0.09, -0.11, -0.13, -0.14, -0.14, -0.14, -0.14, -0.13, 
                       -0.13, -0.12, -0.11, -0.11, -0.10, -0.10, -0.09, -0.09, -0.08, 
                       -0.07, -0.07, -0.06, -0.04, -0.03, -0.02, -0.01, 0.00, 0.01, 
                       0.02, 0.02, 0.02, 0.03, 0.03, 0.03, 0.03, 0.03, 0.03, 
                       0.04, 0.04, 0.05, 0.06, 0.07, 0.07, 0.08, 0.08, 0.09, 
                       0.09, 0.09, 0.09, 0.08, 0.08, 0.08, 0.08, 0.08, 0.08, 
                       0.08, 0.08, 0.08, 0.07, 0.07, 0.05, 0.04, 0.02, 0.00, 
                       -0.02, -0.05, -0.08, -0.10, -0.13, -0.16, -0.18, -0.21]),
             ),
            ("Change Tlength", 0.5, 2, 50, 10, 1, 0.25, 0.5, 1,
             np.array([0.25, 0.46, 0.68, 0.50, -0.16, -0.86, -1.14, -0.83, -0.12, 
                       0.59, 0.89, 0.61, -0.07, -0.76, -1.05, -0.77, -0.04, 0.74, 
                       0.89, 0.16]),
             ),
            ("Change sin freq", 0.5, 2, 50, 10, 1, 0.1, 0.5, 1,
             np.array([-0.44, -0.55, -0.27, 0.13, 0.38, 0.50, 0.54, 0.50, 0.38, 
                       0.21, 0.00, -0.20, -0.36, -0.46, -0.49, -0.43, -0.24, 0.12, 
                       0.39, 0.30]),
            ),
    ])
    
    def test_BpFilt(self, name, dt, short_T, long_T, Tlength, sin_A_sc, sin_F_sc, 
                    cos_A_sc, cos_F_sc, expected):
        t = np.arange(0, Tlength, dt)
        time_series = (sin_A_sc*np.sin(sin_F_sc*2*np.pi*t) + 
                       cos_A_sc*np.cos(cos_F_sc*2*np.pi*t))
        filtered = matlab.BpFilt(time_series, short_T, long_T, dt)
        np.testing.assert_array_almost_equal(expected, filtered,
                                             decimal = 2)
                                             
    
    # Test whole synthetics process

    @parameterized.expand([
            ("Moho only", model,
             pipeline.BodyWaveform(
                     amp_R = np.array([-0.01, -0.01, -0.01, -0.01, 
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, 
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, 
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, 
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, 
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, 
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, 
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.02, -0.02, -0.02, 
                       -0.03, -0.03, -0.03, -0.03, -0.02, -0.01, 0.00, 0.02, 
                       0.05, 0.09, 0.14, 0.19, 0.26, 0.32, 0.39, 0.45, 
                       0.50, 0.53, 0.54, 0.54, 0.51, 0.47, 0.41, 0.34, 
                       0.28, 0.21, 0.15, 0.10, 0.06, 0.03, 0.01, -0.01, 
                       -0.02, -0.03, -0.03, -0.03, -0.03, -0.02, -0.02, -0.02, 
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, 
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, 
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, 
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, 
                       -0.01, -0.01, -0.00, 0.00, 0.01, 0.01, 0.02, 0.03, 
                       0.04, 0.05, 0.06, 0.07, 0.08, 0.08, 0.08, 0.08, 
                       0.07, 0.06, 0.05, 0.04, 0.03, 0.02, 0.01, 0.01, 
                       -0.00, -0.00, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, 
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, 
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, 
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, 
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, 
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, 
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, 
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.00, -0.00, 
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.02, -0.02, 
                       -0.03, -0.03, -0.04, -0.04, -0.05, -0.05, -0.05, -0.05, 
                       -0.05, -0.05, -0.04, -0.04, -0.03, -0.03, -0.02, -0.02, 
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, 
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, 
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, 
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, 
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.00, -0.00, 
                       0.00, 0.01, 0.01, 0.02, 0.03, 0.03, 0.04, 0.05, 
                       0.05, 0.05, 0.05, 0.05, 0.05, 0.04, 0.03, 0.03, 
                       0.02, 0.01, 0.01, 0.00, -0.00, -0.00, -0.01, -0.01, 
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, 
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, 
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, 
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.01, -0.01, -0.02, -0.03, -0.03, -0.04, -0.06, 
                       -0.07, -0.08, -0.09, -0.10, -0.10, -0.10, -0.10, -0.10, 
                       -0.09, -0.08, -0.06, -0.05, -0.04, -0.03, -0.02, -0.02, 
                       -0.01, -0.01, -0.00, -0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.01, -0.01, 
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, 
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, 
                       -0.01, -0.01, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, 
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, 
                       -0.01, -0.01, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.01, 0.01, 
                       0.01, 0.01, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, 0.00, 0.00, 0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 0.00, 
                       0.00, 0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00]),
                amp_Z = np.array([-0.01, -0.01, -0.01, -0.01, 
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, 
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, 
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, 
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, 
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, 
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, 
                       -0.01, -0.01, -0.02, -0.02, -0.02, -0.03, -0.03, -0.04, 
                       -0.04, -0.05, -0.05, -0.05, -0.04, -0.02, 0.01, 0.04, 
                       0.10, 0.17, 0.26, 0.36, 0.47, 0.59, 0.71, 0.82, 
                       0.91, 0.97, 1.00, 0.99, 0.94, 0.85, 0.75, 0.63, 
                       0.51, 0.39, 0.29, 0.19, 0.12, 0.06, 0.02, -0.01, 
                       -0.03, -0.04, -0.05, -0.05, -0.05, -0.04, -0.04, -0.03, 
                       -0.02, -0.02, -0.02, -0.01, -0.01, -0.01, -0.01, -0.01, 
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, 
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, 
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, 
                       -0.01, -0.01, -0.01, -0.01, -0.02, -0.02, -0.02, -0.02, 
                       -0.03, -0.03, -0.03, -0.03, -0.04, -0.04, -0.04, -0.04, 
                       -0.03, -0.03, -0.03, -0.02, -0.02, -0.02, -0.02, -0.01, 
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, 
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, 
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, 
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, 
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, 
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, 
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, 
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, 
                       -0.01, -0.01, -0.01, -0.01, -0.02, -0.02, -0.03, -0.04, 
                       -0.05, -0.06, -0.07, -0.08, -0.08, -0.09, -0.09, -0.09, 
                       -0.09, -0.08, -0.08, -0.07, -0.06, -0.05, -0.04, -0.03, 
                       -0.02, -0.02, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, 
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, 
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, 
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, 
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, 
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.02, 
                       -0.02, -0.03, -0.04, -0.04, -0.05, -0.06, -0.07, -0.08, 
                       -0.09, -0.09, -0.09, -0.09, -0.08, -0.08, -0.07, -0.06, 
                       -0.05, -0.04, -0.03, -0.02, -0.02, -0.01, -0.01, -0.01, 
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, 
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, 
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, 
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, 
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, 
                       -0.01, -0.01, -0.01, -0.00, -0.00, -0.00, 0.00, 0.00, 
                       0.01, 0.01, 0.01, 0.01, 0.02, 0.02, 0.02, 0.01, 
                       0.01, 0.01, 0.01, 0.00, 0.00, -0.00, -0.00, -0.00, 
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.01, -0.01, -0.01, -0.01, -0.01, 
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, 
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, 
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, 
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.00, 
                       -0.00, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, 
                       -0.01, -0.01, -0.01, -0.01, -0.00, -0.00, -0.00, 0.00, 
                       0.00, 0.00, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 
                       0.01, 0.01, 0.01, 0.00, 0.00, 0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, 
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, 
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, 
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, 
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, 
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, 
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, 
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, 
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.01, -0.01, -0.01, -0.01, -0.01, 
                       -0.01, -0.01, -0.01, -0.01, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.01, -0.01, -0.01, 
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00]),
                    dt = 0.05
                    )
                    ),
                    ("More complex model", 
                     model._replace(vs = np.array([1.8, 3.5, 4, 4.6, 4.8]),
                                    idep = np.array([12, 38, 60, 80,121])),
                        pipeline.BodyWaveform(
                        amp_R = np.array([-0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, 
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.00, 
                       0.01, 0.02, 0.04, 0.06, 0.08, 0.11, 0.13, 0.16, 
                       0.19, 0.21, 0.22, 0.22, 0.22, 0.21, 0.19, 0.16, 
                       0.13, 0.11, 0.08, 0.05, 0.03, 0.01, 0.00, -0.01, 
                       -0.01, -0.01, -0.00, 0.01, 0.03, 0.05, 0.07, 0.10, 
                       0.12, 0.15, 0.18, 0.20, 0.21, 0.22, 0.21, 0.20, 
                       0.18, 0.16, 0.13, 0.11, 0.08, 0.06, 0.04, 0.03, 
                       0.02, 0.01, 0.01, 0.01, 0.02, 0.03, 0.04, 0.04, 
                       0.05, 0.06, 0.06, 0.05, 0.05, 0.04, 0.02, 0.01, 
                       -0.01, -0.03, -0.04, -0.06, -0.07, -0.08, -0.08, -0.08, 
                       -0.08, -0.07, -0.06, -0.05, -0.05, -0.04, -0.03, -0.03, 
                       -0.02, -0.02, -0.01, -0.00, 0.01, 0.02, 0.03, 0.05, 
                       0.08, 0.10, 0.13, 0.16, 0.19, 0.21, 0.23, 0.24, 
                       0.23, 0.22, 0.21, 0.18, 0.16, 0.13, 0.10, 0.08, 
                       0.06, 0.04, 0.03, 0.02, 0.01, 0.00, -0.00, -0.01, 
                       -0.02, -0.03, -0.05, -0.07, -0.09, -0.11, -0.13, -0.15, 
                       -0.16, -0.17, -0.17, -0.17, -0.16, -0.14, -0.12, -0.10, 
                       -0.08, -0.06, -0.05, -0.04, -0.03, -0.02, -0.02, -0.02, 
                       -0.02, -0.03, -0.03, -0.04, -0.05, -0.05, -0.07, -0.08, 
                       -0.09, -0.10, -0.11, -0.12, -0.13, -0.14, -0.14, -0.13, 
                       -0.13, -0.12, -0.11, -0.09, -0.08, -0.07, -0.06, -0.05, 
                       -0.04, -0.03, -0.02, -0.01, -0.01, 0.00, 0.01, 0.01, 
                       0.02, 0.03, 0.04, 0.04, 0.05, 0.06, 0.06, 0.07, 
                       0.07, 0.07, 0.07, 0.06, 0.06, 0.05, 0.05, 0.04, 
                       0.03, 0.02, 0.01, 0.00, -0.00, -0.01, -0.02, -0.02, 
                       -0.03, -0.03, -0.03, -0.04, -0.04, -0.05, -0.05, -0.06, 
                       -0.06, -0.07, -0.08, -0.08, -0.09, -0.09, -0.10, -0.09, 
                       -0.09, -0.09, -0.08, -0.07, -0.07, -0.06, -0.06, -0.05, 
                       -0.05, -0.05, -0.05, -0.05, -0.05, -0.04, -0.04, -0.03, 
                       -0.03, -0.02, -0.01, 0.01, 0.02, 0.03, 0.04, 0.05, 
                       0.06, 0.06, 0.07, 0.07, 0.06, 0.06, 0.05, 0.05, 
                       0.04, 0.03, 0.03, 0.02, 0.02, 0.01, 0.01, 0.00, 
                       0.00, -0.00, -0.00, -0.00, 0.00, 0.00, 0.01, 0.01, 
                       0.01, 0.02, 0.02, 0.02, 0.03, 0.03, 0.03, 0.03, 
                       0.03, 0.02, 0.02, 0.02, 0.01, 0.01, 0.01, 0.01, 
                       0.01, 0.00, 0.00, 0.00, 0.00, 0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, 0.00, 0.01, 0.01, 
                       0.02, 0.02, 0.03, 0.04, 0.04, 0.04, 0.04, 0.04, 
                       0.03, 0.03, 0.02, 0.02, 0.01, 0.01, 0.00, 0.00, 
                       -0.00, -0.00, -0.00, 0.00, 0.00, 0.01, 0.01, 0.01, 
                       0.01, 0.02, 0.02, 0.02, 0.02, 0.02, 0.02, 0.02, 
                       0.02, 0.02, 0.02, 0.02, 0.02, 0.02, 0.02, 0.02, 
                       0.02, 0.02, 0.02, 0.02, 0.02, 0.01, 0.01, 0.00, 
                       -0.00, -0.01, -0.02, -0.03, -0.04, -0.04, -0.05, -0.06, 
                       -0.06, -0.07, -0.07, -0.07, -0.07, -0.07, -0.06, -0.06, 
                       -0.05, -0.05, -0.04, -0.03, -0.02, -0.01, -0.01, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.01, -0.01, -0.01, -0.02, 
                       -0.03, -0.03, -0.04, -0.05, -0.05, -0.06, -0.06, -0.07, 
                       -0.07, -0.07, -0.06, -0.06, -0.05, -0.05, -0.04, -0.03, 
                       -0.02, -0.02, -0.01, -0.01, -0.00, -0.00, -0.00, 0.00, 
                       0.00, 0.00, -0.00, -0.00, -0.01, -0.01, -0.01, -0.02, 
                       -0.02, -0.03, -0.03, -0.03, -0.03, -0.02, -0.02, -0.01, 
                       -0.01, -0.00, -0.00, 0.00, 0.00, 0.01, 0.01, 0.00, 
                       0.00, 0.00, -0.00, -0.01, -0.01, -0.01, -0.01, -0.01, 
                       -0.01, -0.01, -0.01, -0.00, -0.00, 0.00, 0.01, 0.01, 
                       0.01, 0.02, 0.02, 0.02, 0.02, 0.01, 0.01, 0.01, 
                       0.00, 0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 0.00, 
                       0.00, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 
                       0.01, 0.01, 0.01, 0.00, -0.00, -0.00, -0.01, -0.01, 
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, 
                       -0.01, -0.00, -0.00, -0.00, 0.00, 0.00, 0.01, 0.01, 
                       0.01, 0.02, 0.02, 0.02, 0.03, 0.03, 0.03, 0.03, 
                       0.02, 0.02, 0.02, 0.01, 0.01, 0.00, -0.00, -0.00, 
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.00, -0.00, 
                       0.00, 0.00, 0.01, 0.01, 0.01, 0.01, 0.02, 0.02, 
                       0.02, 0.02, 0.02, 0.02, 0.02, 0.01, 0.01, 0.01, 
                       0.01, 0.00, 0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.01, -0.01, -0.01, -0.01, -0.02, -0.02, -0.02, -0.02, 
                       -0.02, -0.02, -0.02, -0.01, -0.01, -0.01, -0.00, -0.00, 
                       0.00, 0.00, 0.01, 0.01, 0.01, 0.01, 0.01, 0.00, 
                       0.00, 0.00, 0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, 0.00, 0.00, 0.00, 0.01, 0.01, 0.01, 0.01, 
                       0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 
                       0.01, 0.01, 0.01, 0.01, 0.00, 0.00, -0.00, -0.00, 
                       -0.01, -0.01, -0.01, -0.02, -0.02, -0.02, -0.02, -0.02, 
                       -0.02, -0.02, -0.02, -0.01, -0.01, -0.01, -0.01, -0.01, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.01, 
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, 
                       -0.01, -0.01, -0.01, -0.01, -0.00, -0.00, -0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.01, -0.01, -0.01, -0.00, -0.00, -0.00, 
                       -0.00, 0.00, 0.00, 0.00, 0.01, 0.01, 0.01, 0.01, 
                       0.00, 0.00, 0.00, 0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.01, -0.01, -0.01, -0.01, 
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, 
                       -0.01, -0.01, -0.01, -0.00, -0.00, -0.00, 0.00, 0.00, 
                       0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 
                       0.01, 0.01, 0.01, 0.01, 0.00, 0.00, 0.00, 0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 
                       0.01, 0.01, 0.01, 0.01]),
                        amp_Z = np.array([-0.01, -0.01, -0.01, -0.01, 
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, 
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, 
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, 
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, 
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, 
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, 
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, 
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, 
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, 
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, 
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, 
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, 
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, 
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, 
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, 
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, 
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, 
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, 
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, 
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, 
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, 
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, 
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, 
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, 
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, 
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, 
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, 
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, 
                       -0.01, -0.01, -0.01, -0.01, -0.02, -0.02, -0.02, -0.03, 
                       -0.04, -0.04, -0.04, -0.05, -0.04, -0.03, -0.02, 0.01, 
                       0.05, 0.11, 0.18, 0.26, 0.37, 0.48, 0.60, 0.72, 
                       0.83, 0.92, 0.98, 1.00, 0.98, 0.93, 0.85, 0.74, 
                       0.63, 0.50, 0.39, 0.28, 0.19, 0.12, 0.06, 0.02, 
                       -0.01, -0.03, -0.05, -0.05, -0.05, -0.05, -0.05, -0.05, 
                       -0.05, -0.05, -0.05, -0.05, -0.04, -0.04, -0.04, -0.04, 
                       -0.03, -0.03, -0.03, -0.02, -0.02, -0.01, -0.01, -0.01, 
                       -0.01, -0.00, -0.00, 0.00, 0.00, 0.00, -0.00, -0.01, 
                       -0.01, -0.02, -0.04, -0.06, -0.08, -0.11, -0.14, -0.18, 
                       -0.22, -0.26, -0.29, -0.32, -0.34, -0.35, -0.35, -0.33, 
                       -0.30, -0.27, -0.23, -0.19, -0.15, -0.11, -0.08, -0.05, 
                       -0.04, -0.02, -0.01, -0.01, -0.01, -0.01, -0.02, -0.02, 
                       -0.03, -0.04, -0.05, -0.06, -0.06, -0.07, -0.07, -0.07, 
                       -0.07, -0.07, -0.06, -0.06, -0.05, -0.04, -0.03, -0.02, 
                       -0.02, -0.01, -0.01, -0.01, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.01, -0.01, -0.01, -0.01, -0.02, -0.02, -0.02, 
                       -0.02, -0.02, -0.01, -0.01, 0.00, 0.01, 0.02, 0.03, 
                       0.04, 0.04, 0.04, 0.04, 0.04, 0.03, 0.03, 0.02, 
                       0.01, 0.00, -0.00, -0.01, -0.01, -0.02, -0.02, -0.02, 
                       -0.02, -0.02, -0.01, -0.01, -0.00, 0.00, 0.01, 0.01, 
                       0.02, 0.02, 0.03, 0.03, 0.03, 0.03, 0.02, 0.02, 
                       0.01, 0.01, 0.01, 0.00, -0.00, -0.01, -0.01, -0.01, 
                       -0.02, -0.02, -0.02, -0.02, -0.02, -0.03, -0.02, -0.02, 
                       -0.02, -0.02, -0.02, -0.02, -0.01, -0.01, -0.01, -0.01, 
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, 
                       -0.01, -0.01, -0.01, -0.00, -0.00, -0.00, -0.00, -0.01, 
                       -0.01, -0.02, -0.03, -0.04, -0.05, -0.06, -0.07, -0.09, 
                       -0.10, -0.10, -0.10, -0.10, -0.10, -0.09, -0.08, -0.07, 
                       -0.05, -0.04, -0.03, -0.02, -0.01, -0.01, 0.00, 0.01, 
                       0.01, 0.01, 0.02, 0.02, 0.02, 0.02, 0.03, 0.03, 
                       0.03, 0.03, 0.03, 0.02, 0.02, 0.02, 0.01, 0.01, 
                       0.00, -0.00, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, 
                       -0.01, -0.02, -0.02, -0.02, -0.02, -0.02, -0.02, -0.02, 
                       -0.02, -0.02, -0.02, -0.01, -0.01, -0.00, 0.00, 0.01, 
                       0.01, 0.02, 0.02, 0.03, 0.03, 0.03, 0.03, 0.03, 
                       0.03, 0.02, 0.02, 0.02, 0.01, 0.01, 0.01, 0.01, 
                       0.01, 0.01, 0.01, 0.00, 0.00, 0.00, -0.00, -0.01, 
                       -0.01, -0.01, -0.02, -0.02, -0.02, -0.02, -0.02, -0.02, 
                       -0.01, -0.01, -0.01, -0.00, 0.00, 0.00, 0.01, 0.01, 
                       0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.00, 0.00, 
                       -0.00, -0.00, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, 
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, 
                       -0.01, -0.01, -0.01, -0.01, -0.02, -0.02, -0.02, -0.02, 
                       -0.02, -0.02, -0.02, -0.01, -0.01, -0.01, -0.01, -0.01, 
                       -0.00, 0.00, 0.01, 0.01, 0.01, 0.02, 0.02, 0.02, 
                       0.02, 0.02, 0.01, 0.01, 0.01, 0.00, 0.00, -0.00, 
                       -0.00, -0.00, -0.01, -0.01, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, 0.00, 0.00, 0.00, 0.00, -0.00, -0.00, -0.00, 
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, 
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, 0.00, 0.00, 0.00, 
                       0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.00, 0.00, 
                       -0.00, -0.00, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, 
                       -0.01, -0.01, -0.01, -0.00, -0.00, -0.00, -0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.01, 0.01, 0.01, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.01, -0.01, 
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.02, -0.02, -0.02, 
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, 
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.01, 0.01, 0.01, 0.01, 0.00, 0.00, 
                       0.00, 0.00, 0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.00, 
                       0.00, 0.00, 0.00, 0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00]),
                        dt = 0.05
                            ),
                        ),
            ("Moho and LAB", 
                     model._replace(vs = np.array([4, 4.7, 4.5]),
                                    idep = np.array([60, 80,100])),
                        pipeline.BodyWaveform(
                        amp_R = np.array([-0.01, -0.01, -0.01, -0.01, 
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, 
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, 
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, 
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, 
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, 
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, 
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, 
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, 
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, 
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, 
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, 
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.02, 
                       -0.02, -0.02, -0.03, -0.03, -0.03, -0.03, -0.02, -0.01, 
                       0.00, 0.03, 0.06, 0.10, 0.14, 0.20, 0.26, 0.33, 
                       0.40, 0.46, 0.50, 0.53, 0.54, 0.54, 0.51, 0.46, 
                       0.40, 0.34, 0.27, 0.21, 0.15, 0.10, 0.06, 0.03, 
                       0.01, -0.01, -0.02, -0.03, -0.03, -0.03, -0.03, -0.02, 
                       -0.02, -0.02, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, 
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, 
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, 
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, 
                       -0.01, -0.01, -0.01, -0.01, -0.00, 0.00, 0.01, 0.02, 
                       0.03, 0.04, 0.05, 0.07, 0.08, 0.09, 0.09, 0.10, 
                       0.09, 0.09, 0.08, 0.07, 0.06, 0.05, 0.03, 0.02, 
                       0.01, 0.01, 0.00, -0.00, -0.01, -0.01, -0.01, -0.01, 
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, 
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, 
                       -0.02, -0.02, -0.02, -0.03, -0.03, -0.03, -0.03, -0.03, 
                       -0.03, -0.03, -0.03, -0.03, -0.02, -0.02, -0.02, -0.01, 
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.01, -0.01, -0.01, -0.01, -0.01, 
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.01, -0.01, -0.01, -0.01, -0.01, 
                       -0.02, -0.02, -0.03, -0.03, -0.04, -0.05, -0.05, -0.05, 
                       -0.06, -0.05, -0.05, -0.05, -0.04, -0.04, -0.03, -0.03, 
                       -0.02, -0.02, -0.01, -0.01, -0.01, -0.01, -0.01, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.01, -0.01, -0.01, 
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, 
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, 
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, 
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, 
                       -0.00, -0.00, 0.00, 0.01, 0.01, 0.02, 0.03, 0.04, 
                       0.04, 0.05, 0.05, 0.06, 0.06, 0.06, 0.05, 0.05, 
                       0.04, 0.03, 0.02, 0.02, 0.01, 0.01, 0.00, 0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, 
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.01, -0.01, -0.02, -0.03, -0.04, 
                       -0.05, -0.06, -0.07, -0.09, -0.10, -0.10, -0.11, -0.11, 
                       -0.11, -0.10, -0.09, -0.08, -0.07, -0.05, -0.04, -0.03, 
                       -0.02, -0.02, -0.01, -0.01, -0.00, -0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.01, -0.01, 
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, 
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, 
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, 
                       -0.01, -0.01, -0.01, -0.01, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, 0.00, 0.00, 0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, 
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.00, -0.00, -0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.01, 0.01, 0.01, 
                       0.01, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.01, 0.01, 0.01, 0.01, 
                       0.01, 0.01, 0.01, 0.01, 0.01, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00]),
                        amp_Z = np.array([-0.01, -0.01, -0.01, -0.01, 
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, 
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, 
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, 
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, 
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, 
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, 
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, 
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, 
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, 
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, 
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, 
                       -0.01, -0.01, -0.01, -0.01, -0.02, -0.02, -0.02, -0.03, 
                       -0.03, -0.04, -0.05, -0.05, -0.05, -0.05, -0.04, -0.02, 
                       0.01, 0.05, 0.11, 0.18, 0.27, 0.37, 0.49, 0.61, 
                       0.73, 0.84, 0.92, 0.98, 1.00, 0.98, 0.93, 0.84, 
                       0.74, 0.62, 0.49, 0.38, 0.27, 0.18, 0.11, 0.05, 
                       0.01, -0.02, -0.04, -0.05, -0.05, -0.05, -0.05, -0.04, 
                       -0.04, -0.03, -0.02, -0.02, -0.02, -0.01, -0.01, -0.01, 
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, 
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, 
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, 
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.02, -0.02, 
                       -0.02, -0.03, -0.03, -0.03, -0.04, -0.04, -0.04, -0.04, 
                       -0.04, -0.04, -0.04, -0.03, -0.03, -0.03, -0.02, -0.02, 
                       -0.02, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, 
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, 
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, 
                       -0.01, -0.01, -0.01, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.01, -0.01, -0.01, -0.01, 
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, 
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, 
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, 
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.02, -0.03, 
                       -0.03, -0.04, -0.05, -0.06, -0.07, -0.08, -0.09, -0.10, 
                       -0.10, -0.10, -0.10, -0.09, -0.08, -0.07, -0.06, -0.05, 
                       -0.04, -0.03, -0.02, -0.02, -0.01, -0.01, -0.01, -0.01, 
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, 
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, 
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, 
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, 
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, 
                       -0.01, -0.02, -0.02, -0.03, -0.04, -0.05, -0.06, -0.07, 
                       -0.08, -0.09, -0.10, -0.10, -0.10, -0.10, -0.09, -0.08, 
                       -0.07, -0.06, -0.05, -0.04, -0.03, -0.02, -0.01, -0.01, 
                       -0.00, 0.00, 0.00, 0.00, 0.01, 0.00, 0.00, 0.00, 
                       0.00, -0.00, -0.00, -0.00, -0.01, -0.01, -0.01, -0.01, 
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, 
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, 
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, 
                       -0.01, -0.01, -0.01, -0.01, -0.00, -0.00, -0.00, 0.00, 
                       0.00, 0.01, 0.01, 0.01, 0.01, 0.02, 0.02, 0.02, 
                       0.02, 0.01, 0.01, 0.01, 0.01, 0.00, 0.00, -0.00, 
                       -0.00, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, 
                       -0.01, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.01, -0.01, -0.01, 
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, 
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.00, -0.00, 
                       -0.00, 0.00, 0.00, 0.00, 0.01, 0.01, 0.01, 0.01, 
                       0.01, 0.01, 0.01, 0.00, 0.00, 0.00, 0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.01, -0.01, -0.01, -0.01, 
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.00, -0.00, 
                       -0.00, 0.00, 0.00, 0.01, 0.01, 0.01, 0.01, 0.01, 
                       0.01, 0.01, 0.01, 0.01, 0.01, 0.00, 0.00, 0.00, 
                       -0.00, -0.00, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, 
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, 
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, 
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, 
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, 
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, 
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, 
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, 
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, 
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, 
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, 
                       -0.01, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, 
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, 
                       -0.01, -0.01, -0.01, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.01, -0.01, 
                       -0.01, -0.01, -0.01, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00]),
                        dt = 0.05
                            ),
                        ),
            ])
        
    def test_CalcSynthWV(self, name, model, expected):
        out = pipeline._SynthesiseWV(pipeline.MakeFullModel(model))
        self.assertBodyWavesEqual(out, expected)
        
        
        
    @parameterized.expand([
            ("Moho only", model,
             pipeline.RotBodyWaveform(
                     amp_P = np.array([-0.01, -0.01, -0.01, -0.01, 
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, 
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, 
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, 
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, 
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, 
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, 
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.02, -0.02, -0.02, 
                       -0.03, -0.03, -0.03, -0.03, -0.02, -0.01, 0.00, 0.02, 
                       0.06, 0.09, 0.14, 0.20, 0.27, 0.33, 0.40, 0.46, 
                       0.51, 0.55, 0.56, 0.56, 0.53, 0.48, 0.42, 0.36, 
                       0.29, 0.22, 0.16, 0.11, 0.07, 0.03, 0.01, -0.01, 
                       -0.02, -0.03, -0.03, -0.03, -0.03, -0.02, -0.02, -0.02, 
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, 
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, 
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, 
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, 
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, 
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, 
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, 
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, 
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, 
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, 
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, 
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, 
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, 
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, 
                       -0.01, -0.01, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.01, -0.01, -0.01, -0.01, -0.01, -0.02, -0.02, 
                       -0.03, -0.03, -0.04, -0.04, -0.05, -0.05, -0.05, -0.05, 
                       -0.05, -0.05, -0.04, -0.04, -0.03, -0.03, -0.02, -0.02, 
                       -0.01, -0.01, -0.01, -0.01, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.01, -0.01, -0.01, 
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, 
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, 
                       -0.01, -0.01, -0.01, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.01, -0.01, -0.01, 
                       -0.01, -0.01, -0.02, -0.02, -0.02, -0.03, -0.03, -0.03, 
                       -0.04, -0.04, -0.04, -0.04, -0.03, -0.03, -0.03, -0.02, 
                       -0.02, -0.02, -0.01, -0.01, -0.01, -0.01, -0.01, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.01, -0.01, -0.01, -0.01, 
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, 
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.01, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.01, -0.01, -0.01, 
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, 0.00, 0.00, 0.00, 0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00]),
                     amp_SV = np.array([-0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, 0.00, 0.00, 0.01, 0.01, 0.02, 0.02, 
                       0.03, 0.03, 0.04, 0.04, 0.04, 0.05, 0.05, 0.04, 
                       0.04, 0.04, 0.03, 0.02, 0.02, 0.01, 0.01, 0.01, 
                       0.00, 0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 0.00, 0.00, 
                       0.01, 0.01, 0.01, 0.02, 0.02, 0.03, 0.04, 0.04, 
                       0.04, 0.05, 0.05, 0.05, 0.04, 0.04, 0.03, 0.03, 
                       0.02, 0.02, 0.01, 0.01, 0.00, 0.00, 0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       -0.00, -0.00, -0.00, -0.01, -0.01, -0.02, -0.02, -0.03, 
                       -0.03, -0.04, -0.04, -0.05, -0.05, -0.05, -0.05, -0.05, 
                       -0.04, -0.04, -0.03, -0.02, -0.02, -0.01, -0.01, -0.01, 
                       -0.00, -0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, -0.00, -0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 0.00, 0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00]),
                        dt = 0.05),
                )
            ])
    def test_RotatetoPSV(self, name, model, expected):
        model = pipeline.MakeFullModel(model)
        wv = pipeline._SynthesiseWV(model)
        self.assertRotBodyWavesEqual(
                pipeline._RotateToPSV(wv, model.vp[0], model.vs[0], model.ray_param),
                expected)
        
    @parameterized.expand([
            ("Moho only", model, pipeline.RotBodyWaveform(
                     amp_P = np.array([0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, 
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, 
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, 
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, 
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, 
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, 
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, 
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, 
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, 
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, 
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, 
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, 
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, 
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, 
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, 
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, 
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, 
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, 
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, 
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, 
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, 
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, 
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, 
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, 
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, 
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, 
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, 
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, 
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, 
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, 
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, 
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, 
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, 
                       -0.02, -0.02, -0.02, -0.02, -0.03, -0.03, -0.04, -0.04, 
                       -0.04, -0.04, -0.04, -0.04, -0.03, -0.01, 0.00, 0.03, 
                       0.06, 0.10, 0.14, 0.18, 0.23, 0.28, 0.33, 0.38, 
                       0.42, 0.45, 0.47, 0.47, 0.47, 0.45, 0.43, 0.39, 
                       0.35, 0.30, 0.25, 0.20, 0.15, 0.11, 0.07, 0.04, 
                       0.01, -0.01, -0.02, -0.03, -0.04, -0.04, -0.04, -0.04, 
                       -0.04, -0.03, -0.03, -0.03, -0.02, -0.02, -0.02, -0.01, 
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, 
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, 
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, 
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, 
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, 
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, 
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, 
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, 
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, 
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, 
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, 
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, 
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, 
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, 
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.02, -0.02, -0.02, 
                       -0.03, -0.03, -0.04, -0.04, -0.04, -0.05, -0.05, -0.05, 
                       -0.05, -0.05, -0.05, -0.04, -0.04, -0.04, -0.03, -0.03, 
                       -0.02, -0.02, -0.02, -0.01, -0.01, -0.01, -0.01, -0.01, 
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, 
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, 
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, 
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, 
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, 
                       -0.01, -0.01, -0.02, -0.02, -0.02, -0.02, -0.03, -0.03, 
                       -0.03, -0.03, -0.03, -0.03, -0.03, -0.03, -0.03, -0.03, 
                       -0.03, -0.02, -0.02, -0.02, -0.01, -0.01, -0.01, -0.01, 
                       -0.01, -0.01, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.01, 
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.01, 
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, 
                       -0.01, -0.01, -0.01, -0.01, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.01, 0.01, 0.01, 0.01, 
                       0.01, 0.01, 0.01, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00]),
                    amp_SV = np.array([0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, 0.00, 0.00, 0.01, 0.01, 0.01, 0.02, 
                       0.02, 0.03, 0.03, 0.03, 0.04, 0.04, 0.04, 0.04, 
                       0.04, 0.03, 0.03, 0.03, 0.02, 0.02, 0.02, 0.01, 
                       0.01, 0.01, 0.00, 0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 0.00, 0.00, 
                       0.01, 0.01, 0.01, 0.02, 0.02, 0.03, 0.03, 0.03, 
                       0.04, 0.04, 0.04, 0.04, 0.04, 0.04, 0.03, 0.03, 
                       0.03, 0.02, 0.02, 0.01, 0.01, 0.01, 0.00, 0.00, 
                       0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       -0.00, -0.00, -0.00, -0.01, -0.01, -0.02, -0.02, -0.02, 
                       -0.03, -0.03, -0.04, -0.04, -0.04, -0.04, -0.04, -0.04, 
                       -0.04, -0.04, -0.04, -0.03, -0.03, -0.02, -0.02, -0.01, 
                       -0.01, -0.01, -0.00, -0.00, -0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00]),
                    dt = 0.05
                     )
            ),
            ])
    def test_PrepWaveform(self, name, model, expected):
        model = pipeline.MakeFullModel(model)
        wv = pipeline._SynthesiseWV(model)
        wv = pipeline._RotateToPSV(wv, model.vp[0], model.vs[0], model.ray_param)
        self.assertRotBodyWavesEqual(pipeline._PrepWaveform(wv, Ts = [1, 50]),
                                     expected)

        
    @parameterized.expand([
            ("Moho only parent", model, -1,
             np.array([0.27, 0.26, 0.24, 0.25, 
                       0.29, 0.34, 0.35, 0.34, 0.34, 0.34, 0.33, 0.33, 
                       0.33, 0.34, 0.34, 0.32, 0.30, 0.30, 0.31, 0.30, 
                       0.29, 0.27, 0.26, 0.25, 0.24, 0.23, 0.22, 0.21, 
                       0.20, 0.18, 0.17, 0.16, 0.15, 0.14, 0.12, 0.10, 
                       0.09, 0.09, 0.08, 0.07, 0.06, 0.05, 0.04, 0.04, 
                       0.03, 0.03, 0.02, 0.02, 0.02, 0.01, 0.01, 0.01, 
                       0.01, 0.01, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.01, 
                       0.01, 0.01, 0.01, 0.01, 0.02, 0.02, 0.02, 0.03, 
                       0.03, 0.04, 0.04, 0.05, 0.06, 0.07, 0.08, 0.09, 
                       0.09, 0.10, 0.12, 0.14, 0.15, 0.16, 0.17, 0.18, 
                       0.20, 0.21, 0.22, 0.23, 0.24, 0.25, 0.26, 0.27, 
                       0.29, 0.30, 0.31, 0.30, 0.30, 0.32, 0.34, 0.34, 
                       0.33, 0.33, 0.33, 0.34, 0.34, 0.34, 0.35, 0.34, 
                       0.29, 0.25, 0.24, 0.26])),
            ("Moho only D5", model, 5,
             np.array([-0.01 + 0.00j, -0.01 + 0.00j, -0.01 + 0.01j, 0.00 + 0.00j, 
                       -0.00 -0.00j, -0.01 -0.00j, -0.00 + 0.00j, -0.00 + 0.00j, 
                       -0.00 + 0.01j, 0.01 + 0.00j, 0.00 -0.01j, -0.01 -0.00j, 
                       -0.00 + 0.01j, 0.00 + 0.00j, -0.00 + 0.01j, 0.01 + 0.01j, 
                       0.00 -0.01j, -0.01 -0.00j, -0.00 + 0.01j, 0.00 + 0.00j, 
                       0.00 + 0.00j, 0.00 + 0.00j, 0.00 -0.00j, -0.00 -0.00j, 
                       -0.00 + 0.00j, 0.00 + 0.00j, 0.00 -0.00j, 0.00 + 0.00j, 
                       0.00 -0.00j, -0.00 -0.00j, -0.00 + 0.00j, 0.00 + 0.00j, 
                       0.00 + 0.00j, 0.00 + 0.00j, 0.00 -0.00j, -0.00 -0.00j, 
                       -0.00 + 0.00j, 0.00 + 0.00j, 0.00 -0.00j, 0.00 -0.00j, 
                       0.00 -0.00j, -0.00 -0.00j, -0.00 + 0.00j, 0.00 + 0.00j, 
                       0.00 -0.00j, 0.00 -0.00j, 0.00 -0.00j, -0.00 -0.00j, 
                       -0.00 + 0.00j, 0.00 + 0.00j, 0.00 -0.00j, 0.00 -0.00j, 
                       -0.00 -0.00j, -0.00 -0.00j, -0.00 -0.00j, -0.00 + 0.00j, 
                       0.00 + 0.00j, 0.00 -0.00j, -0.00 -0.00j, -0.00 -0.00j, 
                       -0.00 -0.00j, -0.00 + 0.00j, 0.00 + 0.00j, 0.00 -0.00j, 
                       -0.00 -0.00j, -0.00 -0.00j, -0.00 + 0.00j, -0.00 + 0.00j, 
                       0.00 + 0.00j, 0.00 -0.00j, -0.00 -0.00j, -0.00 + 0.00j, 
                       0.00 + 0.00j, -0.00 + 0.00j, 0.00 + 0.00j, 0.00 -0.00j, 
                       -0.00 -0.00j, -0.00 + 0.00j, -0.00 + 0.00j, -0.00 + 0.00j, 
                       0.00 + 0.00j, 0.00 -0.00j, -0.00 -0.00j, -0.00 + 0.00j, 
                       0.00 + 0.00j, 0.00 + 0.00j, 0.00 + 0.00j, 0.00 -0.00j, 
                       -0.00 -0.00j, -0.00 + 0.00j, 0.00 + 0.00j, 0.00 + 0.00j, 
                       0.00 + 0.00j, 0.00 -0.00j, -0.00 -0.00j, -0.00 + 0.00j, 
                       0.00 + 0.00j, 0.00 + 0.00j, 0.00 -0.00j, 0.00 -0.00j, 
                       0.00 -0.00j, -0.00 -0.00j, -0.00 + 0.00j, 0.00 + 0.00j, 
                       0.00 -0.00j, 0.00 -0.00j, 0.00 -0.00j, -0.00 -0.00j, 
                       -0.00 + 0.00j, 0.00 + 0.00j, 0.00 -0.00j, 0.00 -0.00j, 
                       -0.00 -0.00j, -0.00 -0.00j, -0.00 + 0.00j, 0.00 + 0.00j, 
                       0.00 -0.00j, -0.00 -0.00j, -0.00 -0.00j, -0.00 -0.00j, 
                       -0.00 + 0.00j, 0.00 + 0.00j, 0.00 -0.00j, -0.00 -0.00j, 
                       -0.00 -0.00j, -0.00 + 0.00j, -0.00 + 0.00j, -0.00 + 0.00j, 
                       0.00 -0.00j, -0.00 -0.00j, -0.00 + 0.00j, -0.00 + 0.00j, 
                       -0.00 + 0.00j, -0.00 + 0.00j, 0.00 + 0.00j, -0.00 -0.00j, 
                       -0.00 + 0.00j, -0.00 + 0.00j, 0.00 + 0.00j, 0.00 + 0.00j, 
                       0.00 + 0.00j, -0.00 -0.00j, -0.00 + 0.00j, -0.00 + 0.00j, 
                       0.00 + 0.00j, -0.00 + 0.00j, 0.00 + 0.00j, 0.00 -0.00j, 
                       -0.00 + 0.00j, 0.00 -0.00j, -0.00 + 0.00j, 0.00 -0.00j, 
                       -0.00 + 0.00j, 0.00 + 0.00j, -0.00 + 0.00j, 0.00 + 0.00j, 
                       -0.00 + 0.00j, 0.00 + 0.00j, -0.00 -0.00j, 0.00 + 0.00j, 
                       -0.00 -0.00j, -0.00 + 0.00j, -0.00 -0.00j, -0.00 + 0.00j, 
                       0.00 + 0.00j, -0.00 + 0.00j, 0.00 -0.00j, 0.00 + 0.00j, 
                       0.00 -0.00j, -0.00 -0.00j, 0.00 -0.00j, -0.00 + 0.00j, 
                       0.00 + 0.00j, -0.00 + 0.00j, 0.00 + 0.00j, -0.00 + 0.00j, 
                       0.00 + 0.00j, 0.00 -0.00j, 0.00 + 0.00j, 0.00 -0.00j, 
                       0.00 + 0.00j, -0.00 -0.00j, -0.00 + 0.00j, 0.00 + 0.00j, 
                       -0.00 + 0.00j, 0.00 + 0.00j, 0.00 + 0.00j, 0.00 + 0.00j, 
                       0.00 -0.00j, 0.00 -0.00j, -0.00 + 0.00j, 0.00 + 0.00j, 
                       -0.00 + 0.00j, 0.00 + 0.00j, 0.00 + 0.00j, 0.00 + 0.00j, 
                       0.00 -0.00j, 0.00 + 0.00j, 0.00 -0.00j, 0.00 -0.00j, 
                       0.00 -0.00j, -0.00 -0.00j, 0.00 -0.00j, 0.00 + 0.00j, 
                       0.00 + 0.00j, 0.00 + 0.00j, 0.00 -0.00j, 0.00 -0.00j, 
                       0.00 -0.00j, -0.00 -0.00j, 0.00 -0.00j, -0.00 -0.00j, 
                       0.00 + 0.00j, -0.00 + 0.00j, 0.00 + 0.00j, 0.00 -0.00j, 
                       0.00 + 0.00j, 0.00 -0.00j, 0.00 -0.00j, 0.00 -0.00j, 
                       -0.00 -0.00j, 0.00 -0.00j, -0.00 + 0.00j, 0.00 -0.00j, 
                       0.00 + 0.00j, 0.00 -0.00j, 0.00 -0.00j, 0.00 -0.00j, 
                       0.00 -0.00j, -0.00 -0.00j, -0.00 -0.00j, 0.00 + 0.00j, 
                       -0.00 -0.00j, 0.00 -0.00j, 0.00 -0.00j, 0.00 + 0.00j, 
                       0.00 -0.00j, 0.00 -0.00j, 0.00 -0.00j, -0.00 -0.00j, 
                       -0.00 -0.00j, -0.00 + 0.00j, 0.00 -0.00j, -0.00 -0.00j, 
                       0.00 + 0.00j, 0.00 -0.00j, 0.00 -0.00j, 0.00 -0.00j, 
                       0.00 -0.00j, -0.00 -0.00j, -0.00 -0.00j, -0.00 + 0.00j, 
                       -0.00 + 0.00j, 0.00 -0.00j, 0.00 -0.00j, 0.00 -0.00j, 
                       -0.00 -0.00j, 0.00 -0.00j, -0.00 -0.00j, -0.00 -0.00j, 
                       0.00 + 0.00j, -0.00 -0.00j, -0.00 + 0.00j, 0.00 -0.00j, 
                       -0.00 + 0.00j, 0.00 -0.00j, -0.00 -0.00j, -0.00 -0.00j, 
                       -0.00 -0.00j, -0.00 + 0.00j, -0.00 + 0.00j, -0.00 + 0.00j, 
                       0.00 + 0.00j, 0.00 -0.00j, -0.00 -0.00j, -0.00 -0.00j, 
                       -0.00 -0.00j, -0.00 + 0.00j, -0.00 -0.00j, -0.00 -0.00j, 
                       -0.00 + 0.00j, -0.00 + 0.00j, 0.00 + 0.00j, 0.00 + 0.00j, 
                       0.00 + 0.00j, -0.00 -0.00j, -0.00 -0.00j, -0.00 -0.00j, 
                       -0.00 -0.00j, -0.00 + 0.00j, -0.00 + 0.00j, 0.00 -0.00j, 
                       -0.00 + 0.00j, -0.00 -0.00j, -0.00 -0.00j, 0.00 -0.00j, 
                       -0.00 -0.00j, -0.00 -0.00j, -0.00 -0.00j, -0.00 + 0.00j, 
                       -0.00 + 0.00j, -0.00 + 0.00j, 0.00 + 0.00j, -0.00 + 0.00j, 
                       -0.00 -0.00j, -0.00 -0.00j, -0.00 + 0.00j, -0.00 -0.00j, 
                       -0.00 + 0.00j, -0.00 + 0.00j, -0.00 + 0.00j, 0.00 + 0.00j, 
                       0.00 + 0.00j, 0.00 + 0.00j, 0.00 + 0.00j, 0.00 -0.00j, 
                       -0.00 -0.00j, -0.00 -0.00j, -0.00 + 0.00j, -0.00 + 0.00j, 
                       -0.00 + 0.00j, 0.00 + 0.00j, 0.00 -0.00j, -0.00 -0.00j, 
                       0.00 + 0.00j, -0.00 -0.00j, -0.00 -0.00j, -0.00 -0.00j, 
                       -0.00 -0.00j, -0.00 + 0.00j, -0.00 + 0.00j, 0.00 + 0.00j, 
                       0.00 -0.00j, 0.00 + 0.00j, 0.00 + 0.00j, -0.00 + 0.00j, 
                       -0.00 + 0.00j, 0.00 + 0.00j, 0.00 + 0.00j, 0.00 + 0.00j, 
                       -0.00 -0.00j, -0.00 + 0.00j, 0.00 + 0.00j, 0.00 + 0.00j, 
                       -0.00 + 0.00j, -0.00 + 0.00j, -0.00 + 0.00j, -0.00 + 0.00j, 
                       0.00 + 0.00j, 0.00 + 0.00j, 0.00 -0.00j, 0.00 + 0.00j, 
                       0.00 -0.00j, -0.00 -0.00j, -0.00 + 0.00j, 0.00 + 0.00j, 
                       0.00 + 0.00j, 0.00 + 0.00j, -0.00 + 0.00j, 0.00 + 0.00j, 
                       0.00 + 0.00j, 0.00 + 0.00j, 0.00 -0.00j, 0.00 -0.00j, 
                       0.00 -0.00j, -0.00 -0.00j, 0.00 + 0.00j, 0.00 + 0.00j, 
                       0.00 -0.00j, 0.00 -0.00j, 0.00 -0.00j, 0.00 -0.00j, 
                       0.00 -0.00j, 0.00 -0.00j, 0.00 -0.00j, -0.00 -0.00j, 
                       -0.00 + 0.00j, -0.00 + 0.00j, -0.00 + 0.00j, -0.00 + 0.00j, 
                       0.00 + 0.00j, 0.00 -0.00j, -0.00 -0.00j, 0.00 + 0.00j, 
                       0.00 -0.00j, 0.00 + 0.00j, 0.00 + 0.00j, 0.00 -0.00j, 
                       0.00 + 0.00j, 0.00 + 0.00j, 0.00 + 0.00j, 0.00 -0.00j, 
                       -0.00 + 0.00j, -0.00 + 0.00j, -0.00 + 0.00j, -0.00 + 0.00j, 
                       0.00 + 0.00j, 0.00 -0.00j, -0.00 -0.00j, 0.00 -0.00j, 
                       0.00 -0.00j, 0.00 -0.00j, 0.00 -0.00j, 0.00 -0.00j, 
                       -0.00 -0.00j, -0.00 + 0.00j, -0.00 + 0.00j, -0.00 + 0.00j, 
                       0.00 -0.00j, -0.00 -0.00j, -0.00 + 0.00j, -0.00 + 0.00j, 
                       -0.00 + 0.00j, -0.00 + 0.00j, 0.00 + 0.00j, -0.00 + 0.00j, 
                       -0.00 + 0.00j, 0.00 + 0.00j, 0.00 + 0.00j, 0.00 + 0.00j, 
                       0.00 + 0.00j, 0.00 -0.00j, -0.00 -0.00j, -0.00 -0.00j, 
                       0.00 -0.00j, 0.00 -0.00j, 0.00 -0.00j, -0.00 -0.00j, 
                       -0.00 + 0.00j, 0.00 -0.00j, 0.00 -0.00j, 0.00 -0.00j, 
                       0.00 -0.00j, 0.00 -0.00j, 0.00 -0.00j, -0.00 + 0.00j, 
                       0.00 + 0.00j, 0.00 + 0.00j, 0.00 + 0.00j, 0.00 -0.00j, 
                       0.00 -0.00j, -0.00 -0.00j, -0.00 -0.00j, -0.00 -0.00j, 
                       -0.00 -0.00j, -0.00 + 0.00j, 0.00 -0.00j, 0.00 -0.00j, 
                       0.00 -0.00j, 0.00 -0.00j, 0.00 + 0.00j, 0.00 -0.00j, 
                       0.00 -0.00j, 0.00 -0.00j, -0.00 + 0.00j, -0.00 + 0.00j, 
                       0.00 + 0.00j, 0.00 + 0.00j, 0.00 + 0.00j, 0.00 -0.00j, 
                       -0.00 -0.00j, -0.00 + 0.00j, -0.00 + 0.00j, -0.00 + 0.00j, 
                       -0.00 + 0.00j, -0.00 + 0.00j, -0.00 + 0.00j, -0.00 + 0.00j, 
                       0.00 + 0.00j, 0.00 -0.00j, 0.00 -0.00j, -0.00 -0.00j, 
                       -0.00 -0.00j, -0.00 -0.00j, -0.00 + 0.00j, 0.00 + 0.00j, 
                       0.00 + 0.00j, 0.00 -0.00j, -0.00 -0.00j, -0.00 + 0.00j, 
                       -0.00 + 0.00j, 0.00 + 0.00j, 0.00 -0.00j, 0.00 + 0.00j, 
                       -0.00 -0.00j, -0.00 + 0.00j, 0.00 + 0.00j, 0.00 + 0.00j, 
                       0.00 -0.00j, 0.00 -0.00j, 0.00 -0.00j, -0.00 -0.00j, 
                       -0.00 -0.00j, 0.00 + 0.00j, 0.00 -0.00j, -0.00 -0.00j, 
                       -0.00 -0.00j, -0.00 -0.00j, -0.00 + 0.00j, -0.00 + 0.00j, 
                       0.00 -0.00j, -0.00 -0.00j, -0.00 -0.00j, -0.00 + 0.00j, 
                       -0.00 + 0.00j, 0.00 + 0.00j, 0.00 + 0.00j, 0.00 -0.00j, 
                       -0.00 -0.00j, -0.00 + 0.00j, -0.00 + 0.00j, 0.00 + 0.00j, 
                       0.00 + 0.00j, 0.00 -0.00j, -0.00 -0.00j, -0.00 -0.00j, 
                       -0.00 + 0.00j, 0.00 + 0.00j, 0.00 -0.00j, 0.00 -0.00j, 
                       -0.00 -0.00j, -0.00 -0.00j, -0.00 + 0.00j, -0.00 + 0.00j, 
                       0.00 + 0.00j, -0.00 -0.00j, -0.00 -0.00j, -0.00 + 0.00j, 
                       -0.00 + 0.00j, -0.00 + 0.00j, 0.00 + 0.00j, 0.00 -0.00j, 
                       -0.00 + 0.00j, -0.00 + 0.00j, 0.00 + 0.00j, 0.00 + 0.00j, 
                       0.00 + 0.00j, 0.00 -0.00j, 0.00 -0.00j, -0.00 -0.00j, 
                       -0.00 + 0.00j, 0.00 -0.00j, 0.00 + 0.00j, 0.00 -0.00j, 
                       -0.00 -0.00j, -0.00 -0.00j, -0.00 + 0.00j, 0.00 + 0.00j, 
                       0.00 -0.00j, 0.00 -0.00j, -0.00 -0.00j, -0.00 + 0.00j, 
                       -0.00 + 0.00j, -0.00 + 0.00j, 0.00 + 0.00j, 0.00 + 0.00j, 
                       0.00 -0.00j, -0.00 -0.00j, -0.00 -0.00j, -0.00 -0.00j, 
                       -0.00 -0.00j, -0.00 -0.00j, -0.00 -0.00j, -0.00 -0.00j, 
                       -0.00 + 0.00j, 0.00 + 0.00j, 0.00 -0.00j, 0.00 -0.00j, 
                       0.00 -0.00j, -0.00 -0.00j, -0.00 -0.00j, 0.00 + 0.00j, 
                       0.00 + 0.00j, 0.00 + 0.00j, 0.00 -0.00j, 0.00 + 0.00j, 
                       0.00 + 0.00j, 0.00 + 0.00j, 0.00 + 0.00j, -0.00 -0.00j, 
                       -0.00 + 0.00j, -0.00 + 0.00j, -0.00 + 0.00j, -0.00 + 0.00j, 
                       0.00 + 0.00j, 0.00 + 0.00j, 0.00 -0.00j, 0.00 -0.00j, 
                       0.00 -0.00j, -0.00 -0.00j, 0.00 + 0.00j, 0.00 + 0.00j, 
                       0.00 + 0.00j, 0.00 + 0.00j, 0.00 + 0.00j, 0.00 + 0.00j, 
                       -0.00 -0.00j, -0.00 + 0.00j, 0.00 + 0.00j, 0.00 + 0.00j, 
                       0.00 + 0.00j, -0.00 + 0.00j, -0.00 + 0.00j, 0.00 + 0.00j, 
                       0.00 -0.00j, 0.00 -0.00j, 0.00 -0.00j, 0.00 -0.00j, 
                       -0.00 -0.00j, -0.00 -0.00j, 0.00 -0.00j, -0.00 -0.00j, 
                       -0.00 -0.00j, -0.00 -0.00j, -0.00 -0.00j, -0.00 + 0.00j, 
                       0.00 + 0.00j, -0.00 -0.00j, -0.00 -0.00j, -0.00 -0.00j, 
                       -0.00 + 0.00j, 0.00 + 0.00j, 0.00 + 0.00j, 0.00 + 0.00j, 
                       0.00 + 0.00j, 0.00 + 0.00j, -0.00 + 0.00j, 0.00 + 0.00j, 
                       0.00 -0.00j, -0.00 -0.00j, -0.00 -0.00j, -0.00 -0.00j, 
                       -0.00 -0.00j, 0.00 + 0.00j, 0.00 -0.00j, 0.00 -0.00j, 
                       0.00 -0.00j, 0.00 + 0.00j, 0.00 -0.00j, 0.00 -0.00j, 
                       0.00 + 0.00j, 0.00 -0.00j, -0.00 + 0.00j, 0.00 + 0.00j, 
                       0.00 -0.00j, -0.00 -0.00j, -0.00 -0.00j, -0.00 -0.00j, 
                       -0.00 -0.00j, -0.00 + 0.00j, 0.00 + 0.00j, 0.00 + 0.00j, 
                       0.00 + 0.00j, 0.00 + 0.00j, 0.00 + 0.00j, 0.00 + 0.00j, 
                       0.00 + 0.00j, 0.00 -0.00j, 0.00 -0.00j, -0.00 + 0.00j, 
                       0.00 + 0.00j, 0.00 + 0.00j, 0.00 + 0.00j, 0.00 -0.00j, 
                       0.00 -0.00j, 0.00 -0.00j, -0.00 -0.00j, 0.00 -0.00j, 
                       0.00 -0.00j, 0.00 -0.00j, -0.00 -0.00j, -0.00 + 0.00j, 
                       0.00 + 0.00j, 0.00 -0.00j, 0.00 + 0.00j, 0.00 -0.00j, 
                       0.00 -0.00j, -0.00 -0.00j, -0.00 -0.00j, -0.00 -0.00j, 
                       -0.00 -0.00j, 0.00 -0.00j, 0.00 -0.00j, -0.00 -0.00j, 
                       -0.00 + 0.00j, 0.00 -0.00j, 0.00 -0.00j, 0.00 -0.00j, 
                       -0.00 -0.00j, -0.00 -0.00j, 0.00 -0.00j, 0.00 -0.00j, 
                       0.00 + 0.00j, 0.00 -0.00j, -0.00 -0.00j, -0.00 -0.00j, 
                       -0.00 + 0.00j, -0.00 + 0.00j, -0.00 + 0.00j, -0.00 + 0.00j, 
                       0.00 -0.00j, -0.00 + 0.00j, 0.00 + 0.00j, 0.00 -0.00j, 
                       -0.00 -0.00j, -0.00 -0.00j, -0.00 -0.00j, -0.00 + 0.00j, 
                       -0.00 + 0.00j, 0.00 + 0.00j, 0.00 -0.00j, 0.00 -0.00j, 
                       0.00 -0.00j, 0.00 -0.00j, -0.00 -0.00j, -0.00 -0.00j, 
                       -0.00 -0.00j, -0.00 + 0.00j, -0.00 -0.00j, -0.00 + 0.00j, 
                       -0.00 + 0.00j, -0.00 -0.00j, 0.00 -0.00j, -0.00 -0.00j, 
                       -0.00 -0.00j, -0.00 -0.00j, -0.00 + 0.00j, -0.00 + 0.00j, 
                       -0.00 + 0.00j, 0.00 + 0.00j, -0.00 + 0.00j, -0.00 + 0.00j, 
                       -0.00 -0.00j, 0.00 + 0.00j, -0.00 -0.00j, -0.00 -0.00j, 
                       -0.00 + 0.00j, -0.00 + 0.00j, -0.00 + 0.00j, -0.00 + 0.00j, 
                       0.00 -0.00j, 0.00 -0.00j, 0.00 -0.00j, -0.00 -0.00j, 
                       -0.00 -0.00j, -0.00 + 0.00j, -0.00 + 0.00j, -0.00 -0.00j, 
                       -0.00 + 0.00j, -0.00 + 0.00j, -0.00 + 0.00j, 0.00 + 0.00j, 
                       0.00 -0.00j, -0.00 -0.00j, -0.00 -0.00j, -0.00 -0.00j, 
                       -0.00 + 0.00j, -0.00 + 0.00j, -0.00 + 0.00j, 0.00 + 0.00j, 
                       -0.00 -0.00j, 0.00 + 0.00j, -0.00 -0.00j, -0.00 + 0.00j, 
                       0.00 -0.00j, -0.00 + 0.00j, -0.00 + 0.00j, 0.00 + 0.00j, 
                       -0.00 + 0.00j, 0.00 + 0.00j, 0.00 + 0.00j, 0.00 + 0.00j, 
                       -0.00 -0.00j, -0.00 -0.00j, -0.00 + 0.00j, -0.00 + 0.00j, 
                       0.00 + 0.00j, 0.00 + 0.00j, 0.00 + 0.00j, 0.00 + 0.00j, 
                       0.00 -0.00j, -0.00 + 0.00j, 0.00 + 0.00j, -0.00 -0.00j, 
                       -0.00 + 0.00j, -0.00 + 0.00j, 0.00 + 0.00j, 0.00 + 0.00j, 
                       0.00 + 0.00j, 0.00 -0.00j, 0.00 + 0.00j, 0.00 + 0.00j, 
                       -0.00 + 0.00j, 0.00 -0.00j, -0.00 + 0.00j, -0.00 + 0.00j, 
                       0.00 + 0.00j, 0.00 + 0.00j, 0.00 + 0.00j, 0.00 + 0.00j, 
                       0.00 -0.00j, 0.00 + 0.00j, -0.00 -0.00j, 0.00 + 0.00j, 
                       -0.00 + 0.00j, 0.00 + 0.00j, 0.00 + 0.00j, 0.00 + 0.00j, 
                       0.00 -0.00j, 0.00 + 0.00j, 0.00 -0.00j, -0.00 -0.00j, 
                       0.00 -0.00j, -0.00 + 0.00j, 0.00 + 0.00j, -0.00 + 0.00j, 
                       0.00 + 0.00j, 0.00 + 0.00j, 0.00 + 0.00j, 0.00 -0.00j, 
                       0.00 -0.00j, 0.00 -0.00j, 0.00 + 0.00j, -0.00 + 0.00j, 
                       0.00 + 0.00j, 0.00 + 0.00j, 0.00 + 0.00j, 0.00 -0.00j, 
                       0.00 + 0.00j, 0.00 -0.00j, 0.00 -0.00j, 0.00 -0.00j, 
                       -0.00 -0.00j, 0.00 -0.00j, -0.00 -0.00j, 0.00 + 0.00j, 
                       0.00 + 0.00j, 0.00 -0.00j, 0.00 -0.00j, 0.00 -0.00j, 
                       -0.00 -0.00j, 0.00 -0.00j, -0.00 -0.00j, -0.00 + 0.00j, 
                       0.00 -0.00j, 0.00 + 0.00j, 0.00 -0.00j, 0.00 + 0.00j, 
                       0.00 -0.00j, -0.00 -0.00j, 0.00 -0.00j, -0.00 -0.00j, 
                       0.00 -0.00j, -0.00 -0.00j, 0.00 + 0.00j, -0.00 + 0.00j, 
                       0.00 + 0.00j, 0.00 -0.00j, 0.00 + 0.00j, -0.00 -0.00j, 
                       0.00 -0.00j, -0.00 -0.00j, -0.00 + 0.00j, -0.00 -0.00j, 
                       -0.00 + 0.00j, 0.00 -0.00j, -0.00 + 0.00j, 0.00 -0.00j, 
                       -0.00 -0.00j, 0.00 -0.00j, -0.00 -0.00j, 0.00 -0.00j, 
                       -0.00 -0.00j, 0.00 + 0.00j, -0.00 -0.00j, 0.00 + 0.00j, 
                       -0.00 -0.00j, 0.00 + 0.00j, 0.00 -0.00j, -0.00 -0.00j, 
                       0.00 -0.00j, -0.00 -0.00j, -0.00 -0.00j, -0.00 + 0.00j, 
                       0.00 -0.00j, 0.00 -0.00j, 0.00 -0.00j, -0.00 -0.00j, 
                       -0.00 -0.00j, -0.00 + 0.00j, 0.00 -0.00j, -0.00 -0.00j, 
                       -0.00 -0.00j, -0.00 -0.00j, -0.00 -0.00j, -0.00 + 0.00j, 
                       0.00 + 0.00j, -0.00 -0.00j, -0.00 -0.00j, -0.00 -0.00j, 
                       -0.00 + 0.00j, -0.00 + 0.00j, 0.00 + 0.00j, 0.00 -0.00j, 
                       -0.00 -0.00j, -0.00 + 0.00j, -0.00 + 0.00j, -0.00 + 0.00j, 
                       0.00 + 0.00j, 0.00 -0.00j, -0.00 -0.00j, -0.00 + 0.00j, 
                       -0.00 + 0.00j, 0.00 + 0.00j, 0.00 + 0.00j, 0.00 -0.00j, 
                       -0.00 -0.00j, -0.00 + 0.00j, 0.00 + 0.00j, 0.00 + 0.00j, 
                       0.00 + 0.00j, 0.00 -0.00j, -0.00 -0.00j, -0.00 + 0.00j, 
                       0.00 + 0.00j, 0.00 + 0.00j, 0.00 + 0.00j, 0.00 -0.00j, 
                       0.00 -0.00j, -0.00 -0.00j, -0.00 + 0.00j, 0.00 + 0.00j, 
                       0.00 -0.00j, 0.00 -0.00j, 0.00 -0.00j, -0.00 -0.00j, 
                       -0.00 + 0.00j, 0.00 + 0.00j, 0.00 -0.00j, 0.00 -0.00j, 
                       0.00 -0.00j, -0.00 -0.00j, -0.00 + 0.00j, 0.00 + 0.00j, 
                       0.00 -0.00j, -0.00 -0.00j, -0.00 -0.00j, -0.00 -0.00j, 
                       -0.00 + 0.00j, 0.00 + 0.00j, 0.00 -0.00j, -0.00 -0.00j, 
                       0.00 -0.00j, -0.00 -0.00j, -0.00 + 0.00j, 0.00 + 0.00j, 
                       0.00 -0.00j, -0.00 -0.00j, -0.00 -0.00j, -0.00 + 0.00j, 
                       -0.00 + 0.00j, 0.00 + 0.00j, 0.00 -0.00j, -0.00 -0.00j, 
                       -0.00 + 0.00j, -0.00 + 0.00j, -0.00 + 0.00j, 0.00 + 0.00j, 
                       0.00 -0.00j, -0.00 -0.00j, -0.00 + 0.00j, -0.00 + 0.00j, 
                       -0.00 + 0.00j, 0.00 + 0.00j, 0.00 + 0.00j, 0.00 -0.00j, 
                       -0.00 -0.00j, -0.00 + 0.00j, 0.00 + 0.00j, 0.00 + 0.00j, 
                       0.00 + 0.00j, 0.00 -0.00j, -0.00 -0.00j, -0.00 + 0.00j, 
                       0.00 + 0.00j, 0.00 + 0.00j, 0.00 + 0.00j, 0.00 -0.00j, 
                       -0.00 -0.00j, -0.00 + 0.00j, 0.00 + 0.00j, 0.00 -0.00j, 
                       0.00 -0.00j, 0.00 -0.00j, -0.00 -0.00j, -0.00 + 0.00j, 
                       0.00 + 0.00j, 0.00 -0.00j, 0.00 + 0.00j, 0.00 -0.00j, 
                       -0.00 -0.00j, -0.00 + 0.00j, 0.00 + 0.00j, 0.00 -0.00j, 
                       0.00 -0.00j, 0.00 -0.00j, -0.00 -0.01j, -0.01 + 0.00j, 
                       0.00 + 0.01j, 0.01 -0.01j, -0.00 -0.01j, 0.00 -0.00j, 
                       -0.00 -0.01j, -0.01 + 0.00j, 0.00 + 0.01j, 0.01 -0.00j, 
                       -0.00 -0.01j, -0.00 -0.00j, -0.00 -0.00j, -0.01 + 0.00j, 
                       -0.00 + 0.00j, 0.00 -0.00j, -0.01 -0.01j, -0.01 + -0.00j])),           
            ])
    def test_ETMTMSumFFT(self, name, model, which_daughter, expected):
        model = pipeline.MakeFullModel(model)
        wv = pipeline._SynthesiseWV(model)
        wv = pipeline._RotateToPSV(wv, model.vp[0], model.vs[0], model.ray_param)
        wv = pipeline._PrepWaveform(wv, Ts = [1, 50])
        win_length = 50
        num_windows = 7
        n_samp = 2**(int(win_length / wv.dt).bit_length())
        tapers = matlab.slepian(n_samp, num_windows)
        i_t0 = int(wv.amp_P.size/2)
        incident_win = i_t0+int(n_samp/2)*np.array([-1, 1])
        Parent = wv.amp_P[incident_win[0]:incident_win[1]]
        
        i_shift = 0.1
        pad = np.zeros(int(np.ceil(n_samp*i_shift)))
        Daughter_all = np.concatenate([pad, wv.amp_SV, pad])
        i_starts = np.arange(0,Daughter_all.size-(n_samp - 1), int(i_shift*n_samp))
        
        if which_daughter < 0:
            Daughter = Parent
        else:
            Daughter = matlab.Taper(
                    Daughter_all[i_starts[which_daughter]:i_starts[which_daughter]+n_samp], 
                             int(n_samp/5), int(n_samp/5), int(4*n_samp/5))
        
        np.testing.assert_array_almost_equal(
                pipeline._ETMTMSumFFT(tapers, Parent, Daughter, num_windows),
                expected, decimal = 2)
    
    
    
    # And finally, check the RF calculation 
    @parameterized.expand([
            ("Moho only", model, 
             pipeline.RecvFunc(amp = np.array([-0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, 0.00, 0.00, -0.00, -0.01, 0.00, 
                       0.03, 0.06, 0.06, 0.03, 0.00, -0.01, -0.00, 0.00, 
                       0.00, 0.00, -0.00, -0.00, -0.00, 0.00, 0.01, 0.01, 
                       0.00, 0.00, -0.00, -0.00, 0.00, 0.00, 0.00, -0.00, 
                       -0.00, -0.00, 0.00, 0.00, -0.00, -0.01, -0.00, 0.03, 
                       0.06, 0.08, 0.05, 0.01, -0.01, -0.01, -0.00, 0.00, 
                       -0.00, -0.00, 0.00, 0.01, -0.01, -0.06, -0.09, -0.07, 
                       -0.03, 0.00, 0.01, 0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.01, -0.01, -0.01, -0.01, -0.00, -0.01, 
                       -0.01, -0.01, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.01, 0.01, 0.01, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.01, 
                       0.01, 0.01, 0.01, 0.00]), dt = 0.25)),
            ("Moho, LAB", model._replace(vs = np.array([4, 4.7, 4.6]),
                                         idep = np.array([60, 80, 110])),
            pipeline.RecvFunc(amp = np.array([-0.01, -0.00, -0.00, -0.00, 
                       -0.00, -0.00, -0.00, 0.00, 0.00, -0.00, -0.01, 0.00, 
                       0.04, 0.07, 0.07, 0.04, 0.00, -0.01, -0.00, 0.00, 
                       -0.00, -0.01, -0.01, -0.01, -0.00, 0.00, 0.01, 0.01, 
                       0.01, 0.00, -0.00, -0.00, 0.00, 0.00, 0.00, -0.00, 
                       -0.00, -0.00, 0.00, 0.00, -0.00, -0.01, -0.00, 0.03, 
                       0.07, 0.08, 0.05, 0.01, -0.01, -0.01, -0.00, 0.00, 
                       -0.00, -0.00, 0.01, 0.01, -0.01, -0.06, -0.09, -0.08, 
                       -0.03, 0.00, 0.01, 0.00, -0.00, -0.00, -0.00, -0.00, 
                       -0.00, -0.01, -0.01, -0.01, -0.01, -0.01, -0.00, -0.01, 
                       -0.01, -0.01, -0.00, -0.00, 0.00, 0.00, -0.00, 0.00, 
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.01, 0.01, 0.01, 0.00, 0.00, 0.00, 
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.01, 0.01, 
                       0.01, 0.01, 0.01, 0.00]), dt = 0.25)),
    
    
        ])
    def test_CalcSynthRF(self, name, model, expected):
        model = pipeline.MakeFullModel(model)
        self.assertSynthRFalmostEqual(pipeline.SynthesiseRF(model), expected)
    
    del deps, model
    
    # Test surface wave dispersion calculations
    swd_obs = pipeline.SurfaceWaveDisp(period = 1/np.arange(0.02, 0.11, 0.01),
                                       c = np.array([3.9583, 3.8536, 3.6781,
                                                     3.4724, 3.3217, 3.2340,
                                                     3.1850, 3.1572, 3.1410]))
    deps = np.concatenate((np.arange(0,10,0.2), np.arange(10,60,1), np.arange(60,201,5)))
    model = pipeline.Model(vs = np.array([3.4, 4.5]), all_deps = deps,
                           idep = np.array([60, 80]),  
                           std_rf = 0, lam_rf = 0, std_swd = 0) # irrelevant
    
    @parameterized.expand([("Moho only", model, 3.1099)])
    def test_homogeneous(self, name, model, expected):
        model = pipeline.MakeFullModel(model)
        self.assertAlmostEqual(
                pipeline._CalcRaylPhaseVelInHalfSpace(model.vp[0], model.vs[0]),
                expected, places = 4)
        
    
    @parameterized.expand([
            ("Moho only", model, swd_obs, 0.9, 0, 1.2031),
            ("Moho only", model, swd_obs, 1.5, 3, 3.6431),
            ("Three layers", model._replace(vs = np.array([3.2, 4.0, 4.6]),
                                            idep = np.array([20, 50, 90])),
                                swd_obs, 1.5, 3, 0.5127),
            ("Many layers", model._replace(vs = np.array([3.2, 3.5, 3.8, 4.2, 4.5]),
                                           idep = np.array([3, 15, 42, 60, 90])),
                                swd_obs, 1.9, 8, 10.5059),
            ("Many slow layers", model._replace(vs =np.array([0.7, 1.8, 2.2, 3.5]),
                                                idep = np.array([2, 10, 60, 101])),
                                swd_obs._replace(period = np.array([47])),
                                1.32, 0, 94.0398),
            ("Exact match", model._replace(vs = np.array([3.2, 3.5, 3.8, 4.2, 4.5]),
                                           idep = np.array([3, 15, 42, 60, 90])),
                                swd_obs, 2, 7, 6.33),
        ])
    def test_secular(self, name, model, swd_obs, k_sc, swd_i, expected):
        # k_sc should be between 0.9-2; swd_i between 0-len(swd_obs.period)-1
        model = pipeline.MakeFullModel(model)
        if k_sc <= 1: 
            v = k_sc * np.min(model.vs)
        else:
            v = ((k_sc-1)*np.diff([np.min(model.vs), np.max(model.vs)]) + 
                    np.min(model.vs))
        om = 2*np.pi/swd_obs.period[swd_i]
        mu = model.rho * model.vs**2
        self.assertAlmostEqual(pipeline._Secular(om/v, om, model.thickness,
                                                 mu, model.rho, model.vp, 
                                                 model.vs),
            expected, places = 4)
    
    
    @parameterized.expand([
            ("Moho only", model, swd_obs),
            ("Halfspace only", model._replace(vs = np.array([3.]),
                                              idep = np.array([40])),
                                swd_obs._replace(c = np.ones((9))*2.7406)),
            ("Complicated model", model._replace(vs = np.array([4., 1.2, 4.3, 2.7, 3.1]),
                                                 idep = np.array([2, 17, 42, 58, 91])),
                                swd_obs._replace(c = np.array([2.7731, 2.6669, 2.5958,
                                                               2.5647, 2.5514, 2.5301,
                                                               2.4498, 2.1482, 1.8616]))),
            ])
    
    def test_SurfaceWaveDisp(self, name, model, swd_obs):
        model = pipeline.MakeFullModel(model)
        self.assertSurfaceWaveDispEqual(pipeline.SynthesiseSWD(model, swd_obs.period, 1e6),
                                        swd_obs)
        
# =============================================================================
#       Test model acceptance things
# =============================================================================
    
#   Calculate misfit
    deps = np.concatenate((np.arange(0,10,0.2), np.arange(10,60,1), np.arange(60,201,5)))
    model = pipeline.Model(vs = np.array([3.4, 4.5]), all_deps = deps,
                           idep = np.array([60, 80]),  
                           std_rf = 0.1, lam_rf = 0.2, std_swd = 0.2)
    swd_obs = pipeline.SurfaceWaveDisp(c = 0, period = 1/np.arange(0.02,0.11,0.01))
    
    @parameterized.expand([
            ("Moho only", model, swd_obs, 2, 0.8054187),
            ("More complicated", model._replace(vs = np.array([1.8, 2.5, 3.7, 4.7, 4.6]),
                                                idep = np.array([12, 30, 42, 68, 120])),
                        swd_obs, 2, 0.8419192),
            ("Worse misfit", model, swd_obs, 0, 30.4233547)
            ])
    
    def test_Mahalanobis(self, name, model, swd_obs, round_to, expected):
        fullmodel = pipeline.MakeFullModel(model)
        rf_obs = pipeline.SynthesiseRF(fullmodel)
        swd_obs = pipeline.SynthesiseSWD(fullmodel, swd_obs.period, 1e6)
        cov = pipeline.CalcCovarianceMatrix(model, rf_obs, swd_obs)
        rf_obs = rf_obs.amp; swd_obs = swd_obs.c
        out = pipeline.Mahalanobis(rf_obs, np.round(rf_obs,round_to), swd_obs,
                                   np.round(swd_obs,round_to),cov.invCovar)
        self.assertAlmostEqual(out, expected, places = 1) #3)

    
    m_change = pipeline.ModelChange(theta = 0, old_param = 0, new_param = 0,
                                    which_change = '')
    
#    Calculate acceptance probability
    @parameterized.expand([
            ("Simple Vs Improvement", 0.7, 1.5, 0, 0, 
             m_change._replace(which_change = 'Vs'), 1),
            ("Simple Vs Worse", 1.5, 0.7, 0, 0, 
             m_change._replace(which_change = 'Vs'), 0.67),
            ("Simple Dep Worse", 1.5, 0.7, 0, 0, 
             m_change._replace(which_change = 'Dep'),0.67),
            ("Simple Death Worse", 1.5, 0.7, 0, 0,
             m_change._replace(which_change = 'Death', theta = 1, 
                               old_param = 3.4, new_param = 3.6),
                               0.05),
             ("Simple Death Worse", 1.5, 0.7, 0, 0,
             m_change._replace(which_change = 'Death', theta = 1, 
                               old_param = 4.3, new_param = 3.3),
                               0.16),
            ("Simple Death Worse", 1.5, 0.7, 0, 0,
             m_change._replace(which_change = 'Death', theta = 1, 
                               old_param = 1.3, new_param = 3.3),
                               0.07),
            ("Simple Birth Worse", 4.2, 0.2, 0, 0,
             m_change._replace(which_change = 'Birth', theta = 1, 
                               old_param = 3.7, new_param = 3.3),
                               0.92),
            ("Simple Birth Better", 0.2, 0.3, 0, 0,
             m_change._replace(which_change = 'Birth', theta = 1, 
                               old_param = 3.7, new_param = 3.3),
                               1),
            ("Simple Noise Worse", 1.5, 0.7, 1, 1,
             m_change._replace(which_change = 'Noise'), 0.67),
            ("Simple Noise Worse", 1.5, 0.7, 1, 2,
             m_change._replace(which_change = 'Noise'), 1),
            ("Simple Noise Worse", 1.5, 0.7, 0.75, 0.25,
             m_change._replace(which_change = 'Noise'), 0.223),
            
            ])
    
    def test_AcceptFromLikelihood(self, name, fit_to_obs_m, fit_to_obs_m0, 
                         cov_m, cov_m0, model_change, expected):
        keep_yn = np.zeros(10000)
        cov_m = pipeline.CovarianceMatrix(0,0,R=0, detCovar = cov_m)
        cov_m0 = pipeline.CovarianceMatrix(0,0,R=0, detCovar = cov_m0)
        for k in range(keep_yn.size):
            keep_yn[k] = pipeline.AcceptFromLikelihood(fit_to_obs_m, 
                   fit_to_obs_m0, cov_m, cov_m0, model_change)[0]
        self.assertAlmostEqual(np.mean(keep_yn), expected, places = 1)
    
    model = pipeline.Model(vs = np.array([4, 4.5]), idep = np.array([6, 8]), 
                           all_deps = np.arange(0.,100.,5), 
                           std_rf = 0, lam_rf = 0, std_swd = 0)
    @parameterized.expand([
            ("Moho only", model,  np.array([4, 4, 4, 4, 4, 4, 4, 
                                            4, 4, 4, 4, 4, 4, 4,
                                            4.5, 4.5, 4.5, 4.5, 4.5,
                                            4.5, 4.5, 4.5, 4.5, 4.5,
                                            4.5, 4.5, 4.5, 4.5, 4.5,
                                            4.5, 4.5, 4.5, 4.5, 4.5,
                                            4.5, 4.5, 4.5, 4.5, 4.5])),
            ("More complex", model._replace(vs = np.array([1.8, 2.7, 3.5, 4.4, 4.8]),
                                            idep = np.array([2,4,7,10,15])),
                        np.array([1.8, 1.8, 1.8, 1.8, 1.8, 1.8,
                                  2.7, 2.7, 2.7, 2.7, 2.7, 
                                  3.5, 3.5, 3.5, 3.5, 3.5, 3.5,
                                  4.4, 4.4, 4.4, 4.4, 4.4, 4.4, 4.4, 4.4,
                                  4.8, 4.8, 4.8, 4.8, 4.8, 4.8, 4.8, 4.8,
                                  4.8, 4.8, 4.8, 4.8, 4.8, 4.8])),
            ])
    def test_SaveModel(self, name, model, expected):
        fullmodel = pipeline.MakeFullModel(model)
        ddeps=np.zeros(model.all_deps.size*2-1)
        ddeps[::2] = model.all_deps
        ddeps[1::2] = model.all_deps[:-1]+np.diff(model.all_deps)/2
        np.testing.assert_array_equal(
                pipeline.SaveModel(fullmodel, ddeps), expected)
        
    del model, m_change, deps, swd_obs
    
# =============================================================================
#         Test the whole thing???!
# =============================================================================
#    all_lims = pipeline.Limits(
#            vs = (0.5,5.5), dep = (0,200), std_rf = (0,0.05),
#            lam_rf = (0.05, 0.5), std_swd = (0,0.15))
#    deps = np.concatenate((np.arange(0,10,0.2), np.arange(10,60,1), np.arange(60,201,5)))
#    model = pipeline.Model(vs = np.array([3.4, 4.5]), all_deps = deps,
#                           idep = np.array([60, 80]),  
#                           std_rf = 0, lam_rf = 0, std_swd = 0)
#    
#    def test_JointInversion(self, name, model, all_lims, rndm_sd, max_it):
#        rf_obs = pipeline.SynthesiseRF(pipeline.MakeFullModel(model))
#        swd_obs = pipeline.SynthesiseSWD(pipeline.MakeFullModel(model), 1/np.arange(0.02,0.1, 0.01))
#        out = pipeline.JointInversion(rf_obs, swd_obs, all_lims, max_it, rndm_sd)
#    

    

if __name__ == "__main__":
    unittest.main()