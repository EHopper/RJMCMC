# -*- coding: utf-8 -*-
"""
Created on Mon Feb 12 18:13:08 2018

@author: emily
"""

import random
import unittest
from parameterized import parameterized
import pipeline
import matlab
import numpy as np


class PipelineTest(unittest.TestCase):

    # define some more assertions for our classes
    def assertModelEqual(self, actual, expected):
        # np.testing.assert_array_equal() will actually accept floats etc too
        np.testing.assert_array_almost_equal(actual.vs, expected.vs)
        np.testing.assert_array_almost_equal(actual.all_deps, expected.all_deps)
        np.testing.assert_array_equal(actual.idep, expected.idep) # integers
        np.testing.assert_array_equal(actual.std_rf_sc, expected.std_rf_sc)
        np.testing.assert_array_equal(actual.lam_rf, expected.lam_rf)
        self.assertAlmostEqual(actual.std_swd_sc, expected.std_swd_sc, places = 4)

    def assertCovarianceMatrixEqual(self, actual, expected):
        np.testing.assert_array_almost_equal(actual.R, expected.R, decimal = 6)
        np.testing.assert_array_almost_equal(actual.Covar, expected.Covar, decimal = 6)
        np.testing.assert_array_almost_equal(actual.invCovar, expected.invCovar, decimal = 4)
        self.assertAlmostEqual(actual.detCovar, expected.detCovar, places = 4)

    def assertFullVelModelEqual(self, actual, expected):
        np.testing.assert_array_almost_equal(actual.vs, expected.vs, decimal = 3)
        np.testing.assert_array_almost_equal(actual.vp, expected.vp, decimal = 3)
        np.testing.assert_array_almost_equal(actual.rho, expected.rho, decimal = 3)
        np.testing.assert_array_almost_equal(actual.thickness,
                                             expected.thickness, decimal = 3)
        np.testing.assert_array_almost_equal(actual.avdep,
                                             expected.avdep, decimal = 3)

    def assertBodyWavesEqual(self, actual, expected):
        np.testing.assert_array_almost_equal(actual.amp_R, expected.amp_R, decimal = 2)
        np.testing.assert_array_almost_equal(actual.amp_Z, expected.amp_Z, decimal = 2)
        self.assertAlmostEqual(actual.dt, expected.dt, places = 2)

    def assertRotBodyWavesEqual(self, actual, expected):
        np.testing.assert_array_almost_equal(actual.parent, expected.parent, decimal = 2)
        np.testing.assert_array_almost_equal(actual.daughter, expected.daughter, decimal = 2)
        self.assertAlmostEqual(actual.dt, expected.dt, places = 2)

    def assertSynthRFalmostEqual(self, actual, expected):
        np.testing.assert_array_almost_equal(actual.amp, expected.amp,
                                             decimal = 2)
        # Note: I can't get this to work to 2 d.p. - maybe fft/ifft are
        #       being implemented slightly differently?
        self.assertAlmostEqual(actual.dt, expected.dt, places = 2)
        self.assertAlmostEqual(actual.ray_param, expected.ray_param, places = 4)
        self.assertEqual(actual.rf_phase, expected.rf_phase)

    def assertSurfaceWaveDispEqual(self, actual, expected):
        np.testing.assert_array_almost_equal(actual.c, expected.c,
                                             decimal = 2)
        np.testing.assert_array_equal(actual.period, expected.period)
        np.testing.assert_array_almost_equal(actual.std, expected.std,
                                             decimal = 2)

    def assertSynthModelEqual(self, actual, expected):
        np.testing.assert_array_equal(actual.vs, expected.vs)
        np.testing.assert_array_equal(actual.vp, expected.vp)
        np.testing.assert_array_equal(actual.rho, expected.rho)
        np.testing.assert_array_equal(actual.thickness, expected.thickness)
        np.testing.assert_array_equal(actual.layertops, expected.layertops)
        np.testing.assert_array_equal(actual.avdep, expected.avdep)





    #  Test initial model
    deps = np.concatenate((np.arange(0,10,0.2),
                           np.arange(10,60,1), np.arange(60,201,5)))
    normdist =  np.random.normal(0,0.5,int(1e6)) # Gaussian distribution, std = 0.5


    @parameterized.expand([
        ("Seed == 1", normdist, 1,
             pipeline.Model(vs = np.array(1.04), all_deps = deps, idep = np.array(16),
                            std_rf_sc = 1, lam_rf = 0.2, std_swd_sc = 1)),
        ("Seed == 10", normdist, 10,
             pipeline.Model(vs = 2.79, all_deps = deps, idep = 109,
                            std_rf_sc = 1, lam_rf = 0.2, std_swd_sc = 1)),
    ])

    def test_InitialModel(self, name, normdist, random_seed, expected):
        fake_rf = pipeline.RecvFunc(normdist, 0, 0, '', 0, [0], 0, '')

        random.seed(a = random_seed)
        np.random.seed(seed = random_seed+1)

        model= pipeline.InitialModel([fake_rf])
        self.assertModelEqual(model, expected)

    del deps, normdist



    # Test checking prior
    deps = np.append(np.arange(0,60,1), np.arange(60,201,5))
    lims = pipeline.Limits(
            vs = (0.5,5), dep = (0,200), std_rf_sc = (1,2),
            lam_rf = (0.05,0.5), std_swd_sc = (1,2),
            crustal_thick = (-1,)
            )
    model = pipeline.Model(
            vs = np.array([1.4,4,5]), all_deps = deps, idep = np.array([0,42,64]),
            std_rf_sc = 1, lam_rf = 0.2, std_swd_sc = 1,
            )

    @parameterized.expand([
            ("Should work", lims, model, True),
            ("Vs too small", lims, model._replace(vs = np.array([0.4,1.4,4])), False),
            ("Vs too big", lims, model._replace(vs = np.array([0.5,1.4,5.6])), False),
            ("Vs lims", lims._replace(vs = (1.5,5)), model, False),
            ("Dep ind wrong", lims, model._replace(idep = np.array([-1,42,89])), False),
            ("Dep lims", lims._replace(dep = (50, 100)), model, False),
            ("Std_rf", lims, model._replace(std_rf_sc = 0.51),False),
            ("Std_swd", lims._replace(std_swd_sc = (0,0.1)), model, False),
            ("Lam_rf", lims, model._replace(lam_rf = 1), False),
#            ("One layer", lims,
#                 model._replace(vs = np.array(1), idep = np.array(16)), True),
            ("One layer", lims,
                 model._replace(vs = np.array([1]), idep = np.array([16])), True)
            #("Shouldn't work", lims._replace(crustal_thick = (200,)), model, False),
            ])

    def test_CheckPrior(self,name,lims,model,expected):
        self.assertEqual(expected,pipeline.CheckPrior(model,lims))

    del deps, lims, model




    # Test covariance matrix calculation
    model = pipeline.Model(vs = 0, all_deps = 0, idep = 0, # irrelevant
            std_rf_sc = np.array([1.]), lam_rf = np.array([0.2]),
            std_swd_sc = 1.,
            )
    rf_obs = pipeline.RecvFunc(amp = np.arange(2),
                               dt = 0.25,  # length and dt matter
                               std = np.sqrt(0.1)*np.ones(2,),
                               ray_param = 0.0618, std_sc = 1,
                               rf_phase ='Ps', filter_corners = [1,100],
                               weight_by = 'even',
                               )
    swd_obs = pipeline.SurfaceWaveDisp(period = np.arange(1), # only length matters
                                       c = np.arange(0), # irrelevant
                                       std = np.sqrt(0.2),
                                       )
    # Note that all determinants have undergone the fix (as in pipeline)
    # to make them easier to deal with - i.e. make all so floor(log10(det))=0

    @parameterized.expand([
            #("1x1 rf", model, rf_obs, swd_obs, pipeline.CovarianceMatrix(1,1,1)),
            ("2x2 rf, 1 sw", model, [rf_obs], swd_obs,
                 pipeline.CovarianceMatrix(
                        R = np.array([[1, 0.928302], # calculated in Matlab (code gave
                             [0.928302, 1]]), # ouput as figure 4 from KL14)
                        Covar = np.array([[0.1, 0.0928302, 0],
                                 [0.0928302, 0.1, 0],
                                 [0,0,0.2]]),
                        invCovar = np.array([[72.33026556,-67.144357,0],
                                    [-67.144357,72.33026556,0],
                                    [0,0,5]]),
                        detCovar = 2.7650942305, # 0.00027650942305,
                               ),
                         ),
            ("3x3 rf, 4 sw", model, [rf_obs._replace(amp = np.arange(3),
                                    std = np.sqrt(0.1)*np.ones(3,))],
                 swd_obs._replace(period = np.arange(4),
                                  std = np.sqrt(0.2)*np.ones(4,)),
                 pipeline.CovarianceMatrix(
                        R = np.array([[1, 0.928302, 0.818653],
                             [0.928302, 1, 0.928302],
                             [0.818653, 0.928302, 1]]),
                        Covar = np.array([[0.1, 0.0928302, 0.0818653,0,0,0,0],
                             [0.0928302, 0.1, 0.0928302,0,0,0,0],
                             [0.0818653, 0.0928302, 0.1,0,0,0,0],
                             [0,0,0,0.2,0,0,0],[0,0,0,0,0.2,0,0],
                             [0,0,0,0,0,0.2,0],[0,0,0,0,0,0,0.2]]),
                        invCovar = np.array([[80.1131353,-97.549094,24.970184,0,0,0,0],
                                    [-97.549094,191.11011086,-97.549094,0,0,0,0],
                                    [24.970184,-97.549094,80.1131353,0,0,0,0],
                                    [0,0,0,5,0,0,0],[0,0,0,0,5,0,0],
                                    [0,0,0,0,0,5,0],[0,0,0,0,0,0,5]]),
                        detCovar = 2.761189, #0.00000002761189,
                               ),
                         ),
            ("change std", model._replace(std_rf_sc = np.array([100]), std_swd_sc = 20),
                 [rf_obs], swd_obs,
                 pipeline.CovarianceMatrix(
                        R = np.array([[1, 0.928302], # calculated in Matlab (code gave
                             [0.928302, 1]]), # ouput as figure 4 from KL14)
                        Covar = np.array([[10, 9.28302369, 0],
                                 [9.28302369, 10, 0],
                                 [0,0,4]]),
                        invCovar = np.array([[0.7233027,-0.671444,0],
                                    [-0.671444,0.7233027,0],
                                    [0,0,0.25]]),
                        detCovar = 5.53018846104696, #55.3018846104696,
                               ),
                         ),
            ("change lam",model._replace(lam_rf = np.array([1])), [rf_obs], swd_obs,
                 pipeline.CovarianceMatrix(
                        R = np.array([[1,0.35326101],
                              [0.35326101,1]]),
                       Covar = np.array([[0.1, 0.035326101, 0],
                                 [0.035326101, 0.1, 0],
                                 [0,0,0.2]]),
                        invCovar = np.array([[11.42587289,-4.0363154497,0],
                                    [-4.0363154497,11.42587289,0],
                                    [0,0,5]]),
                        detCovar = 1.7504133111, #0.0017504133111,
                             ),
                         ),
                 ("Change std_sc", model, [rf_obs._replace(amp = np.arange(3),
                                            std = np.sqrt(0.1)*np.ones(3,), std_sc = 2)],
                     swd_obs._replace(period = np.arange(4), std = np.sqrt(0.2)*np.ones(4,)),
                     pipeline.CovarianceMatrix(
                            R = np.array([[1, 0.928302, 0.818653],
                                 [0.928302, 1, 0.928302],
                                 [0.818653, 0.928302, 1]]),
                            Covar = np.array([[0.2, 0.18566, 0.1637306,0,0,0,0],
                                 [0.18566, 0.2, 0.18566,0,0,0,0],
                                 [0.1637306, 0.18566, 0.2,0,0,0,0],
                                 [0,0,0,0.2,0,0,0],[0,0,0,0,0.2,0,0],
                                 [0,0,0,0,0,0.2,0],[0,0,0,0,0,0,0.2]]),
                            invCovar = np.array([[40.05654985567,-48.774514414,12.485075634,0,0,0,0],
                                        [-48.774514414,95.5549927,-48.774514414,0,0,0,0],
                                        [12.485075634,-48.774514414,40.05654985567,0,0,0,0],
                                        [0,0,0,5,0,0,0],[0,0,0,0,5,0,0],
                                        [0,0,0,0,0,5,0],[0,0,0,0,0,0,5]]),
                            detCovar = 2.20895305, #0.00000002761189,
                                   ),
                             ),
               ("List of two 2x2 rf, 1 sw",
                    model._replace(std_rf_sc = np.array([1,2]),
                                   lam_rf = np.array([0.2, 0.15])),
                    [rf_obs, rf_obs._replace(std_sc = 1.5, rf_phase = 'Sp')], swd_obs,
                    pipeline.CovarianceMatrix(
                        R = np.array([[1, 0.928302, 0., 0.],
                             [0.928302, 1., 0., 0.],
                             [0., 0., 1., 0.950113],
                             [0., 0., 0.950113, 1.]]),
                        Covar = np.array([[0.1, 0.0928302, 0., 0., 0],
                                 [0.0928302, 0.1, 0., 0., 0.],
                                 [0., 0., 0.3, 0.2850338, 0.],
                                 [0., 0., 0.2850338, 0.3, 0.],
                                 [0., 0., 0., 0., 0.2]]),
                        invCovar = np.array([[72.33026556,-67.144357,0., 0., 0.],
                                    [-67.144357,72.33026556,0., 0., 0.],
                                    [0., 0., 34.2632655, -32.5539626, 0.],
                                    [0., 0., -32.5539626, 34.2632655, 0.],
                                    [0., 0., 0., 0., 5.]]),
                        detCovar = 7.5657958 # 75657957.528858,
                               ),
                         ),
            ])
    def test_CalcCovarianceMatrix(self, name, model, rf_obs, swd_obs, expected):
        cov = pipeline.CalcCovarianceMatrix(model, rf_obs, swd_obs)
        cov = cov._replace(detCovar = cov.detCovar / (10**int(np.log10(cov.detCovar))))
        self.assertCovarianceMatrixEqual(cov, expected)
    del model, rf_obs, swd_obs



    # test Synthetics for RF in a few steps...
    # 1. Test the velocity model change
    deps = np.concatenate((np.arange(0,10,0.2), np.arange(10,60,1), np.arange(60,201,5)))
    model = pipeline.Model(
            vs = np.array([4,4.5,4.7,5]), all_deps = deps, idep = np.array([60,80,108,120]),
            std_rf_sc = 0, lam_rf = 0, std_swd_sc = 0, # irrelevant
            )
    @parameterized.expand([
            ("input model",model,pipeline.SynthModel(
                    vs = np.array([4.,4.5, 4.7,5.]),
                    vp = np.array([6.9357, 7.875, 8.225, 8.75]),
                    thickness = np.array([30, 40, 60, 60]),
                    layertops = np.array([0, 30, 70, 130]),
                    avdep = np.array([15, 50, 100, 160]),
                    rho = np.array([2.9496, 3.4268, 3.4390, 3.4367]),
                    )
                ),
            ("vary vels", model._replace(vs = np.array([3,4.2,4.6,5.2])),
             pipeline.SynthModel(
                    vs = np.array([3,4.2,4.6,5.2]),
                    vp = np.array([5.0506,7.3307,8.05,9.1]),
                    thickness = np.array([30, 40, 60, 60]),
                    layertops = np.array([0, 30, 70, 130]),
                    avdep = np.array([15, 50, 100, 160]),
                    rho = np.array([2.5426, 3.0674, 3.4329, 3.4406]),
                    )
             ),
             ("vary deps", model._replace(idep = np.array([10,50,85,125])),
              pipeline.SynthModel(
                    vs = np.array([4.,4.5, 4.7,5.]),
                    vp = np.array([6.9357, 7.875, 8.225, 8.75]),
                    thickness = np.array([6., 21.5, 87.5, 87.5]),
                    layertops = np.array([0, 6, 27.5, 115]),
                    avdep = np.array([3., 16.75, 71.25, 158.75]),
                    rho = np.array([2.9496, 3.4268, 3.4379, 3.4367]),
                    )
             ),
             ("vary both", model._replace(idep = np.array([10,50,110,125]),
                                          vs = np.array([4.,4.499999, 4.7,5.])),
              pipeline.SynthModel(
                    vs = np.array([4.,4.5, 4.7,5.]),
                    vp = np.array([6.9357, 7.9062, 8.225, 8.75]),
                    thickness = np.array([6., 54., 87.5, 87.5]),
                    layertops = np.array([0, 6, 60, 147.5]),
                    avdep = np.array([3., 33., 103.75, 191.25]),
                    rho = np.array([2.9496, 3.2579, 3.4391, 3.4381]),
                    )
              ),
            ("Crustal vels only", model._replace(vs = np.array([1.7, 2.6, 3.6, 4.4])),
             pipeline.SynthModel(
                     vs = np.array([1.7, 2.6, 3.6, 4.4]),
                     vp = np.array([3.238876, 4.408495,6.1488126, 7.7179102]),
                     thickness = np.array([30., 40., 60., 60.]),
                     layertops = np.array([0, 30, 70, 130]),
                     avdep = np.array([15., 50., 100., 160.]),
                     rho = np.array([2.2723679, 2.4495676, 2.7493737, 3.193219]),
                     )
             ),
             ("Mantle vels only", model._replace(vs = np.array([4.5, 4.6, 4.7, 5.])),
              pipeline.SynthModel(
                     vs = np.array([4.5, 4.6, 4.7, 5.]),
                     vp = np.array([7.875, 8.05, 8.225, 8.75]),
                     thickness = np.array([30., 40., 60., 60.]),
                     layertops = np.array([0, 30, 70, 130]),
                     avdep = np.array([15., 50., 100., 160.]),
                     rho = np.array([3.4268, 3.431978, 3.438984, 3.43669]),
                      )
              ),
              ("Last layer only", model._replace(vs = np.array([4.7]),
                                                 idep = np.array([128])),
                pipeline.SynthModel(vs = np.array([4.7]), vp = np.array([8.225]),
                                    thickness = np.array(deps[128]),
                                    layertops = np.array([0]),
                                    avdep = np.array(deps[128]/2),
                                    rho = np.array([3.439]),
                                    )

                ),

            ])
    def test_MakeFullVelModel(self, name, model, expected):
        fullvel = pipeline.MakeFullModel(model)
        self.assertFullVelModelEqual(fullvel, expected)

    del model

    # Test propagator matrix
    model = pipeline.Model(
            vs = np.array([4,4.6]), all_deps = deps, idep = np.array([60,80]),
            std_rf_sc = 0, lam_rf = 0, std_swd_sc = 0, # irrelevant
            )
    i_loop = 1
    @parameterized.expand([
            ("Moho only", model, i_loop,
             np.array([[-0.6205, 1j*0.3189, 0.0044, 1j*-0.001],
                  [1j*0.115, -1.8854, 1j*-0.0014, 0.0025],
                  [-1.3889, 1j*-0.3424, -0.0018, 1j*-0.0038],
                  [1j*0.526, 0.9235, 1j*0.001, 0.0062]])
             ),
            ("Change wavenumber", model, 349.,
             np.array([[0.1657, 1j*1.5101, -0.00203124, 1j*-0.00091424],
                  [1j*0.5551, 0.7971, 1j*-0.00535876, -0.00120837],
                  [-0.1656, 1j*0.8819, -0.0003388096, 1j*0.0086396689],
                  [1j*-1.343, -0.0489916, 1j*-0.00099158, 0.00102660]])
            ),
            ("Change model", model._replace(vs = np.array([3.5, 4.7])), 349,
             np.array([[0.02145, 1j*-0.2944, 0.005172, 1j*0.000808],
                      [1j*-0.1184,	-1.786, 1j*0.001907, 0.003193],
                      [1.443,	1j*0.07356, 0.002563, 1j*0.001433],
                      [1j*-0.1079, 0.008377, 1j*-0.0007377, -0.00808]])
            ),
            ("Change model slow", model._replace(vs = np.array([1.2, 3.5]),
                                               idep = np.array([23, 35])),
            109, np.array([[-0.41367, 1.0027j, -0.0020859, -0.012886j],
                           [0.1545j, 0.30185, -0.02812j, -0.0009798],
                           [-1.4598, -0.1868j, -0.0026856, -0.03802j],
                           [0.44619j, -0.032956, 0.01043j, 0.011559]])
            ),
            ("Add layers", model._replace(vs = np.array([1.2, 3.5, 4.4, 4.7]),
                                          idep = np.array([23, 35, 60, 100])),
             35, np.array([[-0.14738, 0.36886j, 0.0056826, -0.008675j],
                           [-0.05274j, -0.51406, -0.01805j, 0.00478],
                           [0.15073, -0.11593j, 0.006755, -0.0125j],
                           [0.6842j, 0.07583, 0.006988j, -0.01986]])

                    ),

    ])

    def test_PropagatorMat(self, name, model, i_loop, expected):
        wavenumber = i_loop/102.4*0.0618*2*np.pi
        fullmodel = pipeline.MakeFullModel(model)
        c = 1/0.0618
        Jacobian = pipeline._CalcPropagatorMatrix(fullmodel,c,wavenumber,0)
        np.testing.assert_array_almost_equal(Jacobian, expected, decimal = 3)

    del i_loop


    # Test bpfilt - there are some arbitrary parameters (set in matlab.py)
    # that need to have different defaults to give the same vals as Matlab
    @parameterized.expand([
            ("Test", 0.15, 5, 100, 20, 1, 0.25, 0.5, 1,
             np.array([0.31, 0.32, 0.33, 0.33, 0.32, 0.31, 0.29, 0.25, 0.21,
                       0.15, 0.09, 0.02, -0.05, -0.13, -0.20, -0.26, -0.32, -0.37,
                       -0.40, -0.42, -0.42, -0.41, -0.38, -0.33, -0.28, -0.21, -0.14,
                       -0.07, -0.00, 0.06, 0.12, 0.17, 0.20, 0.22, 0.22, 0.21,
                       0.18, 0.14, 0.09, 0.03, -0.03, -0.09, -0.15, -0.20, -0.24,
                       -0.27, -0.28, -0.28, -0.27, -0.24, -0.19, -0.14, -0.08, -0.01,
                       0.05, 0.12, 0.17, 0.22, 0.26, 0.28, 0.29, 0.29, 0.27,
                       0.23, 0.19, 0.13, 0.07, 0.01, -0.05, -0.11, -0.16, -0.20,
                       -0.22, -0.24, -0.23, -0.22, -0.18, -0.14, -0.08, -0.02, 0.04,
                       0.11, 0.17, 0.22, 0.26, 0.29, 0.31, 0.32, 0.30, 0.27,
                       0.23, 0.18, 0.12, 0.06, -0.00, -0.07, -0.13, -0.17, -0.21,
                       -0.24, -0.24, -0.24, -0.22, -0.19, -0.14, -0.09, -0.03, 0.03,
                       0.08, 0.14, 0.18, 0.22, 0.24, 0.25, 0.24, 0.21, 0.18,
                       0.13, 0.08, 0.02, -0.05, -0.11, -0.16, -0.20, -0.24, -0.25,
                       -0.25, -0.22, -0.18, -0.12, -0.04, 0.05, 0.16, 0.27])
             ),
             ("Change dt", 0.25, 5, 100, 20, 1, 0.25, 0.5, 1,
             np.array([0.42, 0.42, 0.41, 0.38, 0.33, 0.25, 0.14, 0.03, -0.10,
                       -0.21, -0.31, -0.37, -0.38, -0.36, -0.29, -0.20, -0.09, 0.02,
                       0.11, 0.17, 0.20, 0.18, 0.12, 0.03, -0.07, -0.17, -0.26,
                       -0.32, -0.34, -0.32, -0.26, -0.17, -0.06, 0.04, 0.13, 0.19,
                       0.22, 0.20, 0.14, 0.06, -0.04, -0.15, -0.23, -0.29, -0.30,
                       -0.28, -0.22, -0.13, -0.02, 0.09, 0.18, 0.24, 0.27, 0.25,
                       0.20, 0.11, 0.01, -0.08, -0.17, -0.22, -0.23, -0.21, -0.14,
                       -0.04, 0.07, 0.19, 0.29, 0.36, 0.39, 0.38, 0.33, 0.25,
                       0.15, 0.05, -0.05, -0.13, -0.19, -0.21, -0.22, -0.21])
             ),
            ("Change short_T", 0.25, 1, 100, 20, 1, 0.25, 0.5, 1,
             np.array([0.47, 0.24, 0.37, 0.89, 1.20, 0.86, 0.38, 0.31, 0.17,
                       -0.47, -1.05, -1.02, -0.85, -1.03, -1.06, -0.49, 0.14, 0.27,
                       0.34, 0.80, 1.13, 0.80, 0.33, 0.26, 0.12, -0.51, -1.08,
                       -1.05, -0.88, -1.05, -1.08, -0.50, 0.13, 0.26, 0.34, 0.81,
                       1.14, 0.82, 0.36, 0.29, 0.16, -0.47, -1.04, -1.00, -0.82,
                       -0.99, -1.01, -0.43, 0.21, 0.35, 0.43, 0.91, 1.24, 0.92,
                       0.47, 0.40, 0.28, -0.34, -0.90, -0.86, -0.67, -0.83, -0.85,
                       -0.27, 0.38, 0.53, 0.62, 1.10, 1.44, 1.13, 0.68, 0.62,
                       0.51, -0.11, -0.67, -0.61, -0.42, -0.58, -0.58, 0.00])
             ),
            ("Change long_T", 0.25, 10, 50, 20, 1, 0.25, 0.5, 1,
             np.array([0.33, 0.28, 0.22, 0.17, 0.13, 0.08, 0.04, 0.00, -0.03,
                       -0.07, -0.09, -0.11, -0.13, -0.14, -0.14, -0.14, -0.14, -0.13,
                       -0.13, -0.12, -0.11, -0.11, -0.10, -0.10, -0.09, -0.09, -0.08,
                       -0.07, -0.07, -0.06, -0.04, -0.03, -0.02, -0.01, 0.00, 0.01,
                       0.02, 0.02, 0.02, 0.03, 0.03, 0.03, 0.03, 0.03, 0.03,
                       0.04, 0.04, 0.05, 0.06, 0.07, 0.07, 0.08, 0.08, 0.09,
                       0.09, 0.09, 0.09, 0.08, 0.08, 0.08, 0.08, 0.08, 0.08,
                       0.08, 0.08, 0.08, 0.07, 0.07, 0.05, 0.04, 0.02, 0.00,
                       -0.02, -0.05, -0.08, -0.10, -0.13, -0.16, -0.18, -0.21]),
             ),
            ("Change Tlength", 0.5, 2, 50, 10, 1, 0.25, 0.5, 1,
             np.array([0.25, 0.46, 0.68, 0.50, -0.16, -0.86, -1.14, -0.83, -0.12,
                       0.59, 0.89, 0.61, -0.07, -0.76, -1.05, -0.77, -0.04, 0.74,
                       0.89, 0.16]),
             ),
            ("Change sin freq", 0.5, 2, 50, 10, 1, 0.1, 0.5, 1,
             np.array([-0.44, -0.55, -0.27, 0.13, 0.38, 0.50, 0.54, 0.50, 0.38,
                       0.21, 0.00, -0.20, -0.36, -0.46, -0.49, -0.43, -0.24, 0.12,
                       0.39, 0.30]),
            ),
    ])

    def test_BpFilt(self, name, dt, short_T, long_T, Tlength, sin_A_sc, sin_F_sc,
                    cos_A_sc, cos_F_sc, expected):
        t = np.arange(0, Tlength, dt)
        time_series = (sin_A_sc*np.sin(sin_F_sc*2*np.pi*t) +
                       cos_A_sc*np.cos(cos_F_sc*2*np.pi*t))
        filtered = matlab.BpFilt(time_series, short_T, long_T, dt)
        np.testing.assert_array_almost_equal(expected, filtered,
                                             decimal = 2)


    # Test whole synthetics process
    rf_in = pipeline.RecvFunc(amp = np.array([0]), std = np.array([0]),
                              dt = 0.25, rf_phase = 'Ps',
                              ray_param = 0.0618, std_sc = 1,
                              filter_corners = [1,100], weight_by = 'even')


    @parameterized.expand([
            ("Moho only", model, rf_in,
             pipeline.BodyWaveform(
                     amp_R = np.array([-0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.02, -0.02, -0.02,
                       -0.03, -0.03, -0.03, -0.03, -0.02, -0.01, 0.00, 0.02,
                       0.05, 0.09, 0.14, 0.19, 0.26, 0.32, 0.39, 0.45,
                       0.50, 0.53, 0.54, 0.54, 0.51, 0.47, 0.41, 0.34,
                       0.28, 0.21, 0.15, 0.10, 0.06, 0.03, 0.01, -0.01,
                       -0.02, -0.03, -0.03, -0.03, -0.03, -0.02, -0.02, -0.02,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.00, 0.00, 0.01, 0.01, 0.02, 0.03,
                       0.04, 0.05, 0.06, 0.07, 0.08, 0.08, 0.08, 0.08,
                       0.07, 0.06, 0.05, 0.04, 0.03, 0.02, 0.01, 0.01,
                       -0.00, -0.00, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.00, -0.00,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.02, -0.02,
                       -0.03, -0.03, -0.04, -0.04, -0.05, -0.05, -0.05, -0.05,
                       -0.05, -0.05, -0.04, -0.04, -0.03, -0.03, -0.02, -0.02,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.00, -0.00,
                       0.00, 0.01, 0.01, 0.02, 0.03, 0.03, 0.04, 0.05,
                       0.05, 0.05, 0.05, 0.05, 0.05, 0.04, 0.03, 0.03,
                       0.02, 0.01, 0.01, 0.00, -0.00, -0.00, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.01, -0.01, -0.02, -0.03, -0.03, -0.04, -0.06,
                       -0.07, -0.08, -0.09, -0.10, -0.10, -0.10, -0.10, -0.10,
                       -0.09, -0.08, -0.06, -0.05, -0.04, -0.03, -0.02, -0.02,
                       -0.01, -0.01, -0.00, -0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.01, 0.01,
                       0.01, 0.01, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, 0.00, 0.00, 0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 0.00,
                       0.00, 0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00]),
                amp_Z = np.array([-0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.02, -0.02, -0.02, -0.03, -0.03, -0.04,
                       -0.04, -0.05, -0.05, -0.05, -0.04, -0.02, 0.01, 0.04,
                       0.10, 0.17, 0.26, 0.36, 0.47, 0.59, 0.71, 0.82,
                       0.91, 0.97, 1.00, 0.99, 0.94, 0.85, 0.75, 0.63,
                       0.51, 0.39, 0.29, 0.19, 0.12, 0.06, 0.02, -0.01,
                       -0.03, -0.04, -0.05, -0.05, -0.05, -0.04, -0.04, -0.03,
                       -0.02, -0.02, -0.02, -0.01, -0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.02, -0.02, -0.02, -0.02,
                       -0.03, -0.03, -0.03, -0.03, -0.04, -0.04, -0.04, -0.04,
                       -0.03, -0.03, -0.03, -0.02, -0.02, -0.02, -0.02, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.02, -0.02, -0.03, -0.04,
                       -0.05, -0.06, -0.07, -0.08, -0.08, -0.09, -0.09, -0.09,
                       -0.09, -0.08, -0.08, -0.07, -0.06, -0.05, -0.04, -0.03,
                       -0.02, -0.02, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.02,
                       -0.02, -0.03, -0.04, -0.04, -0.05, -0.06, -0.07, -0.08,
                       -0.09, -0.09, -0.09, -0.09, -0.08, -0.08, -0.07, -0.06,
                       -0.05, -0.04, -0.03, -0.02, -0.02, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.00, -0.00, -0.00, 0.00, 0.00,
                       0.01, 0.01, 0.01, 0.01, 0.02, 0.02, 0.02, 0.01,
                       0.01, 0.01, 0.01, 0.00, 0.00, -0.00, -0.00, -0.00,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.01, -0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.00,
                       -0.00, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.00, -0.00, -0.00, 0.00,
                       0.00, 0.00, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01,
                       0.01, 0.01, 0.01, 0.00, 0.00, 0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.01, -0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00]),
                    dt = 0.05
                    )
                    ),
                    ("More complex model",
                     model._replace(vs = np.array([1.8, 3.5, 4, 4.6, 4.8]),
                                    idep = np.array([12, 38, 60, 80,121])),
                    rf_in, pipeline.BodyWaveform(
                        amp_R = np.array([-0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.00,
                       0.01, 0.02, 0.04, 0.06, 0.08, 0.11, 0.13, 0.16,
                       0.19, 0.21, 0.22, 0.22, 0.22, 0.21, 0.19, 0.16,
                       0.13, 0.11, 0.08, 0.05, 0.03, 0.01, 0.00, -0.01,
                       -0.01, -0.01, -0.00, 0.01, 0.03, 0.05, 0.07, 0.10,
                       0.12, 0.15, 0.18, 0.20, 0.21, 0.22, 0.21, 0.20,
                       0.18, 0.16, 0.13, 0.11, 0.08, 0.06, 0.04, 0.03,
                       0.02, 0.01, 0.01, 0.01, 0.02, 0.03, 0.04, 0.04,
                       0.05, 0.06, 0.06, 0.05, 0.05, 0.04, 0.02, 0.01,
                       -0.01, -0.03, -0.04, -0.06, -0.07, -0.08, -0.08, -0.08,
                       -0.08, -0.07, -0.06, -0.05, -0.05, -0.04, -0.03, -0.03,
                       -0.02, -0.02, -0.01, -0.00, 0.01, 0.02, 0.03, 0.05,
                       0.08, 0.10, 0.13, 0.16, 0.19, 0.21, 0.23, 0.24,
                       0.23, 0.22, 0.21, 0.18, 0.16, 0.13, 0.10, 0.08,
                       0.06, 0.04, 0.03, 0.02, 0.01, 0.00, -0.00, -0.01,
                       -0.02, -0.03, -0.05, -0.07, -0.09, -0.11, -0.13, -0.15,
                       -0.16, -0.17, -0.17, -0.17, -0.16, -0.14, -0.12, -0.10,
                       -0.08, -0.06, -0.05, -0.04, -0.03, -0.02, -0.02, -0.02,
                       -0.02, -0.03, -0.03, -0.04, -0.05, -0.05, -0.07, -0.08,
                       -0.09, -0.10, -0.11, -0.12, -0.13, -0.14, -0.14, -0.13,
                       -0.13, -0.12, -0.11, -0.09, -0.08, -0.07, -0.06, -0.05,
                       -0.04, -0.03, -0.02, -0.01, -0.01, 0.00, 0.01, 0.01,
                       0.02, 0.03, 0.04, 0.04, 0.05, 0.06, 0.06, 0.07,
                       0.07, 0.07, 0.07, 0.06, 0.06, 0.05, 0.05, 0.04,
                       0.03, 0.02, 0.01, 0.00, -0.00, -0.01, -0.02, -0.02,
                       -0.03, -0.03, -0.03, -0.04, -0.04, -0.05, -0.05, -0.06,
                       -0.06, -0.07, -0.08, -0.08, -0.09, -0.09, -0.10, -0.09,
                       -0.09, -0.09, -0.08, -0.07, -0.07, -0.06, -0.06, -0.05,
                       -0.05, -0.05, -0.05, -0.05, -0.05, -0.04, -0.04, -0.03,
                       -0.03, -0.02, -0.01, 0.01, 0.02, 0.03, 0.04, 0.05,
                       0.06, 0.06, 0.07, 0.07, 0.06, 0.06, 0.05, 0.05,
                       0.04, 0.03, 0.03, 0.02, 0.02, 0.01, 0.01, 0.00,
                       0.00, -0.00, -0.00, -0.00, 0.00, 0.00, 0.01, 0.01,
                       0.01, 0.02, 0.02, 0.02, 0.03, 0.03, 0.03, 0.03,
                       0.03, 0.02, 0.02, 0.02, 0.01, 0.01, 0.01, 0.01,
                       0.01, 0.00, 0.00, 0.00, 0.00, 0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, 0.00, 0.01, 0.01,
                       0.02, 0.02, 0.03, 0.04, 0.04, 0.04, 0.04, 0.04,
                       0.03, 0.03, 0.02, 0.02, 0.01, 0.01, 0.00, 0.00,
                       -0.00, -0.00, -0.00, 0.00, 0.00, 0.01, 0.01, 0.01,
                       0.01, 0.02, 0.02, 0.02, 0.02, 0.02, 0.02, 0.02,
                       0.02, 0.02, 0.02, 0.02, 0.02, 0.02, 0.02, 0.02,
                       0.02, 0.02, 0.02, 0.02, 0.02, 0.01, 0.01, 0.00,
                       -0.00, -0.01, -0.02, -0.03, -0.04, -0.04, -0.05, -0.06,
                       -0.06, -0.07, -0.07, -0.07, -0.07, -0.07, -0.06, -0.06,
                       -0.05, -0.05, -0.04, -0.03, -0.02, -0.01, -0.01, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.01, -0.01, -0.01, -0.02,
                       -0.03, -0.03, -0.04, -0.05, -0.05, -0.06, -0.06, -0.07,
                       -0.07, -0.07, -0.06, -0.06, -0.05, -0.05, -0.04, -0.03,
                       -0.02, -0.02, -0.01, -0.01, -0.00, -0.00, -0.00, 0.00,
                       0.00, 0.00, -0.00, -0.00, -0.01, -0.01, -0.01, -0.02,
                       -0.02, -0.03, -0.03, -0.03, -0.03, -0.02, -0.02, -0.01,
                       -0.01, -0.00, -0.00, 0.00, 0.00, 0.01, 0.01, 0.00,
                       0.00, 0.00, -0.00, -0.01, -0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.00, -0.00, 0.00, 0.01, 0.01,
                       0.01, 0.02, 0.02, 0.02, 0.02, 0.01, 0.01, 0.01,
                       0.00, 0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 0.00,
                       0.00, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01,
                       0.01, 0.01, 0.01, 0.00, -0.00, -0.00, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.00, -0.00, -0.00, 0.00, 0.00, 0.01, 0.01,
                       0.01, 0.02, 0.02, 0.02, 0.03, 0.03, 0.03, 0.03,
                       0.02, 0.02, 0.02, 0.01, 0.01, 0.00, -0.00, -0.00,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.00, -0.00,
                       0.00, 0.00, 0.01, 0.01, 0.01, 0.01, 0.02, 0.02,
                       0.02, 0.02, 0.02, 0.02, 0.02, 0.01, 0.01, 0.01,
                       0.01, 0.00, 0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.01, -0.01, -0.01, -0.01, -0.02, -0.02, -0.02, -0.02,
                       -0.02, -0.02, -0.02, -0.01, -0.01, -0.01, -0.00, -0.00,
                       0.00, 0.00, 0.01, 0.01, 0.01, 0.01, 0.01, 0.00,
                       0.00, 0.00, 0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, 0.00, 0.00, 0.00, 0.01, 0.01, 0.01, 0.01,
                       0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01,
                       0.01, 0.01, 0.01, 0.01, 0.00, 0.00, -0.00, -0.00,
                       -0.01, -0.01, -0.01, -0.02, -0.02, -0.02, -0.02, -0.02,
                       -0.02, -0.02, -0.02, -0.01, -0.01, -0.01, -0.01, -0.01,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.00, -0.00, -0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.01, -0.01, -0.01, -0.00, -0.00, -0.00,
                       -0.00, 0.00, 0.00, 0.00, 0.01, 0.01, 0.01, 0.01,
                       0.00, 0.00, 0.00, 0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.00, -0.00, -0.00, 0.00, 0.00,
                       0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01,
                       0.01, 0.01, 0.01, 0.01, 0.00, 0.00, 0.00, 0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01,
                       0.01, 0.01, 0.01, 0.01]),
                        amp_Z = np.array([-0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.02, -0.02, -0.02, -0.03,
                       -0.04, -0.04, -0.04, -0.05, -0.04, -0.03, -0.02, 0.01,
                       0.05, 0.11, 0.18, 0.26, 0.37, 0.48, 0.60, 0.72,
                       0.83, 0.92, 0.98, 1.00, 0.98, 0.93, 0.85, 0.74,
                       0.63, 0.50, 0.39, 0.28, 0.19, 0.12, 0.06, 0.02,
                       -0.01, -0.03, -0.05, -0.05, -0.05, -0.05, -0.05, -0.05,
                       -0.05, -0.05, -0.05, -0.05, -0.04, -0.04, -0.04, -0.04,
                       -0.03, -0.03, -0.03, -0.02, -0.02, -0.01, -0.01, -0.01,
                       -0.01, -0.00, -0.00, 0.00, 0.00, 0.00, -0.00, -0.01,
                       -0.01, -0.02, -0.04, -0.06, -0.08, -0.11, -0.14, -0.18,
                       -0.22, -0.26, -0.29, -0.32, -0.34, -0.35, -0.35, -0.33,
                       -0.30, -0.27, -0.23, -0.19, -0.15, -0.11, -0.08, -0.05,
                       -0.04, -0.02, -0.01, -0.01, -0.01, -0.01, -0.02, -0.02,
                       -0.03, -0.04, -0.05, -0.06, -0.06, -0.07, -0.07, -0.07,
                       -0.07, -0.07, -0.06, -0.06, -0.05, -0.04, -0.03, -0.02,
                       -0.02, -0.01, -0.01, -0.01, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.01, -0.01, -0.01, -0.01, -0.02, -0.02, -0.02,
                       -0.02, -0.02, -0.01, -0.01, 0.00, 0.01, 0.02, 0.03,
                       0.04, 0.04, 0.04, 0.04, 0.04, 0.03, 0.03, 0.02,
                       0.01, 0.00, -0.00, -0.01, -0.01, -0.02, -0.02, -0.02,
                       -0.02, -0.02, -0.01, -0.01, -0.00, 0.00, 0.01, 0.01,
                       0.02, 0.02, 0.03, 0.03, 0.03, 0.03, 0.02, 0.02,
                       0.01, 0.01, 0.01, 0.00, -0.00, -0.01, -0.01, -0.01,
                       -0.02, -0.02, -0.02, -0.02, -0.02, -0.03, -0.02, -0.02,
                       -0.02, -0.02, -0.02, -0.02, -0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.00, -0.00, -0.00, -0.00, -0.01,
                       -0.01, -0.02, -0.03, -0.04, -0.05, -0.06, -0.07, -0.09,
                       -0.10, -0.10, -0.10, -0.10, -0.10, -0.09, -0.08, -0.07,
                       -0.05, -0.04, -0.03, -0.02, -0.01, -0.01, 0.00, 0.01,
                       0.01, 0.01, 0.02, 0.02, 0.02, 0.02, 0.03, 0.03,
                       0.03, 0.03, 0.03, 0.02, 0.02, 0.02, 0.01, 0.01,
                       0.00, -0.00, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.02, -0.02, -0.02, -0.02, -0.02, -0.02, -0.02,
                       -0.02, -0.02, -0.02, -0.01, -0.01, -0.00, 0.00, 0.01,
                       0.01, 0.02, 0.02, 0.03, 0.03, 0.03, 0.03, 0.03,
                       0.03, 0.02, 0.02, 0.02, 0.01, 0.01, 0.01, 0.01,
                       0.01, 0.01, 0.01, 0.00, 0.00, 0.00, -0.00, -0.01,
                       -0.01, -0.01, -0.02, -0.02, -0.02, -0.02, -0.02, -0.02,
                       -0.01, -0.01, -0.01, -0.00, 0.00, 0.00, 0.01, 0.01,
                       0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.00, 0.00,
                       -0.00, -0.00, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.02, -0.02, -0.02, -0.02,
                       -0.02, -0.02, -0.02, -0.01, -0.01, -0.01, -0.01, -0.01,
                       -0.00, 0.00, 0.01, 0.01, 0.01, 0.02, 0.02, 0.02,
                       0.02, 0.02, 0.01, 0.01, 0.01, 0.00, 0.00, -0.00,
                       -0.00, -0.00, -0.01, -0.01, -0.00, -0.00, -0.00, -0.00,
                       -0.00, 0.00, 0.00, 0.00, 0.00, -0.00, -0.00, -0.00,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, 0.00, 0.00, 0.00,
                       0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.00, 0.00,
                       -0.00, -0.00, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.00, -0.00, -0.00, -0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.01, 0.01, 0.01, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.02, -0.02, -0.02,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.01, 0.01, 0.01, 0.01, 0.00, 0.00,
                       0.00, 0.00, 0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.00,
                       0.00, 0.00, 0.00, 0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00]),
                        dt = 0.05
                            ),
                        ),
            ("Moho and LAB",
                     model._replace(vs = np.array([4, 4.7, 4.5]),
                                    idep = np.array([60, 80,100])), rf_in,
                        pipeline.BodyWaveform(
                        amp_R = np.array([-0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.02,
                       -0.02, -0.02, -0.03, -0.03, -0.03, -0.03, -0.02, -0.01,
                       0.00, 0.03, 0.06, 0.10, 0.14, 0.20, 0.26, 0.33,
                       0.40, 0.46, 0.50, 0.53, 0.54, 0.54, 0.51, 0.46,
                       0.40, 0.34, 0.27, 0.21, 0.15, 0.10, 0.06, 0.03,
                       0.01, -0.01, -0.02, -0.03, -0.03, -0.03, -0.03, -0.02,
                       -0.02, -0.02, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.00, 0.00, 0.01, 0.02,
                       0.03, 0.04, 0.05, 0.07, 0.08, 0.09, 0.09, 0.10,
                       0.09, 0.09, 0.08, 0.07, 0.06, 0.05, 0.03, 0.02,
                       0.01, 0.01, 0.00, -0.00, -0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01,
                       -0.02, -0.02, -0.02, -0.03, -0.03, -0.03, -0.03, -0.03,
                       -0.03, -0.03, -0.03, -0.03, -0.02, -0.02, -0.02, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.01, -0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.01, -0.01, -0.01, -0.01, -0.01,
                       -0.02, -0.02, -0.03, -0.03, -0.04, -0.05, -0.05, -0.05,
                       -0.06, -0.05, -0.05, -0.05, -0.04, -0.04, -0.03, -0.03,
                       -0.02, -0.02, -0.01, -0.01, -0.01, -0.01, -0.01, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01,
                       -0.00, -0.00, 0.00, 0.01, 0.01, 0.02, 0.03, 0.04,
                       0.04, 0.05, 0.05, 0.06, 0.06, 0.06, 0.05, 0.05,
                       0.04, 0.03, 0.02, 0.02, 0.01, 0.01, 0.00, 0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.01, -0.01, -0.02, -0.03, -0.04,
                       -0.05, -0.06, -0.07, -0.09, -0.10, -0.10, -0.11, -0.11,
                       -0.11, -0.10, -0.09, -0.08, -0.07, -0.05, -0.04, -0.03,
                       -0.02, -0.02, -0.01, -0.01, -0.00, -0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, 0.00, 0.00, 0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.00, -0.00, -0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.01, 0.01, 0.01,
                       0.01, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.01, 0.01, 0.01, 0.01,
                       0.01, 0.01, 0.01, 0.01, 0.01, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00]),
                        amp_Z = np.array([-0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.02, -0.02, -0.02, -0.03,
                       -0.03, -0.04, -0.05, -0.05, -0.05, -0.05, -0.04, -0.02,
                       0.01, 0.05, 0.11, 0.18, 0.27, 0.37, 0.49, 0.61,
                       0.73, 0.84, 0.92, 0.98, 1.00, 0.98, 0.93, 0.84,
                       0.74, 0.62, 0.49, 0.38, 0.27, 0.18, 0.11, 0.05,
                       0.01, -0.02, -0.04, -0.05, -0.05, -0.05, -0.05, -0.04,
                       -0.04, -0.03, -0.02, -0.02, -0.02, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.02, -0.02,
                       -0.02, -0.03, -0.03, -0.03, -0.04, -0.04, -0.04, -0.04,
                       -0.04, -0.04, -0.04, -0.03, -0.03, -0.03, -0.02, -0.02,
                       -0.02, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.02, -0.03,
                       -0.03, -0.04, -0.05, -0.06, -0.07, -0.08, -0.09, -0.10,
                       -0.10, -0.10, -0.10, -0.09, -0.08, -0.07, -0.06, -0.05,
                       -0.04, -0.03, -0.02, -0.02, -0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.02, -0.02, -0.03, -0.04, -0.05, -0.06, -0.07,
                       -0.08, -0.09, -0.10, -0.10, -0.10, -0.10, -0.09, -0.08,
                       -0.07, -0.06, -0.05, -0.04, -0.03, -0.02, -0.01, -0.01,
                       -0.00, 0.00, 0.00, 0.00, 0.01, 0.00, 0.00, 0.00,
                       0.00, -0.00, -0.00, -0.00, -0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.00, -0.00, -0.00, 0.00,
                       0.00, 0.01, 0.01, 0.01, 0.01, 0.02, 0.02, 0.02,
                       0.02, 0.01, 0.01, 0.01, 0.01, 0.00, 0.00, -0.00,
                       -0.00, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.00, -0.00,
                       -0.00, 0.00, 0.00, 0.00, 0.01, 0.01, 0.01, 0.01,
                       0.01, 0.01, 0.01, 0.00, 0.00, 0.00, 0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.00, -0.00,
                       -0.00, 0.00, 0.00, 0.01, 0.01, 0.01, 0.01, 0.01,
                       0.01, 0.01, 0.01, 0.01, 0.01, 0.00, 0.00, 0.00,
                       -0.00, -0.00, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00]),
                        dt = 0.05,
                            ),
                        ),
                    ('Sp Moho', model,
                     rf_in._replace(rf_phase = 'Sp', ray_param = 0.1157),
                     pipeline.BodyWaveform(
                            amp_R = np.array([0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.01, 0.01, 0.01,
                       0.01, 0.01, 0.01, 0.01, 0.01, 0.01,
                       0.01, 0.01, 0.01, 0.01, 0.01, 0.01,
                       0.01, 0.01, 0.01, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.01, 0.01, 0.01,
                       0.01, 0.01, 0.01, 0.01, 0.01, 0.01,
                       0.01, 0.01, 0.01, 0.01, 0.01, 0.01,
                       0.01, 0.01, 0.01, 0.01, 0.01, 0.01,
                       0.01, 0.01, 0.01, 0.01, 0.01, 0.01,
                       0.01, 0.01, 0.01, 0.01, 0.01, 0.01,
                       0.01, 0.01, 0.01, 0.01, 0.01, 0.01,
                       0.01, 0.01, 0.01, 0.01, 0.01, 0.01,
                       0.01, 0.01, 0.01, 0.01, 0.01, 0.01,
                       0.01, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.01, 0.01, 0.01, 0.01,
                       0.01, 0.01, 0.01, 0.01, 0.01, 0.01,
                       0.01, 0.01, 0.01, 0.01, 0.01, 0.01,
                       0.01, 0.01, 0.01, 0.01, 0.01, 0.01,
                       0.01, 0.01, 0.01, 0.01, 0.01, 0.01,
                       0.01, 0.01, 0.01, 0.01, 0.01, 0.01,
                       0.01, 0.01, 0.01, 0.01, 0.01, 0.01,
                       0.01, 0.01, 0.01, 0.01, 0.01, 0.01,
                       0.01, 0.01, 0.01, 0.01, 0.01, 0.01,
                       0.01, 0.01, 0.01, 0.01, 0.01, 0.01,
                       0.01, 0.01, 0.01, 0.01, 0.01, 0.01,
                       0.01, 0.01, 0.01, 0.01, 0.01, 0.01,
                       0.01, 0.01, 0.01, 0.01, 0.01, 0.01,
                       0.01, 0.01, 0.01, 0.01, 0.01, 0.01,
                       0.01, 0.01, 0.01, 0.01, 0.01, 0.01,
                       0.01, 0.00, 0.00, 0.00, 0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, 0.00, 0.00, 0.00, 0.01,
                       0.01, 0.01, 0.01, 0.01, 0.01, 0.01,
                       0.01, 0.01, 0.01, 0.01, 0.01, 0.01,
                       0.01, 0.01, 0.01, 0.01, 0.01, 0.01,
                       0.01, 0.01, 0.01, 0.01, 0.01, 0.01,
                       0.01, 0.01, 0.01, 0.01, 0.01, 0.01,
                       0.01, 0.01, 0.01, 0.01, 0.01, 0.01,
                       0.01, 0.01, 0.01, 0.01, 0.01, 0.01,
                       0.01, 0.01, 0.01, 0.01, 0.01, 0.01,
                       0.01, 0.01, 0.01, 0.01, 0.01, 0.01,
                       0.01, 0.01, 0.01, 0.01, 0.01, 0.01,
                       0.01, 0.01, 0.01, 0.01, 0.01, 0.02,
                       0.02, 0.02, 0.02, 0.03, 0.03, 0.03,
                       0.03, 0.03, 0.03, 0.03, 0.03, 0.02,
                       0.02, 0.02, 0.02, 0.01, 0.01, 0.01,
                       0.01, 0.01, 0.01, 0.01, 0.01, 0.01,
                       0.01, 0.01, 0.01, 0.01, 0.01, 0.01,
                       0.01, 0.01, 0.01, 0.01, 0.01, 0.01,
                       0.01, 0.01, 0.01, 0.01, 0.01, 0.01,
                       0.01, 0.01, 0.01, 0.01, 0.01, 0.01,
                       0.01, 0.01, 0.01, 0.01, 0.01, 0.01,
                       0.01, 0.01, 0.01, 0.01, 0.01, 0.01,
                       0.01, 0.01, 0.01, 0.01, 0.01, 0.01,
                       0.01, 0.01, 0.01, 0.01, 0.01, 0.01,
                       0.01, 0.01, 0.01, 0.01, 0.01, 0.01,
                       0.01, 0.01, 0.01, 0.01, 0.01, 0.01,
                       0.01, 0.01, 0.01, 0.01, 0.01, 0.01,
                       0.01, 0.01, 0.01, 0.01, 0.01, 0.01,
                       0.01, 0.01, 0.01, 0.02, 0.02, 0.03,
                       0.04, 0.04, 0.05, 0.06, 0.07, 0.08,
                       0.08, 0.08, 0.08, 0.08, 0.07, 0.07,
                       0.06, 0.05, 0.04, 0.03, 0.03, 0.02,
                       0.02, 0.01, 0.01, 0.01, 0.01, 0.01,
                       0.01, 0.01, 0.01, 0.01, 0.01, 0.01,
                       0.01, 0.01, 0.01, 0.01, 0.01, 0.01,
                       0.01, 0.01, 0.01, 0.01, 0.01, 0.01,
                       0.01, 0.01, 0.01, 0.01, 0.01, 0.01,
                       0.01, 0.01, 0.01, 0.01, 0.01, 0.01,
                       0.01, 0.01, 0.01, 0.01, 0.01, 0.01,
                       0.01, 0.01, 0.01, 0.01, 0.01, 0.01,
                       0.01, 0.01, 0.02, 0.02, 0.02, 0.02,
                       0.02, 0.02, 0.02, 0.02, 0.01, 0.01,
                       -0.00, -0.01, -0.02, -0.04, -0.06, -0.08,
                       -0.10, -0.12, -0.14, -0.15, -0.16, -0.16,
                       -0.16, -0.15, -0.13, -0.11, -0.09, -0.07,
                       -0.05, -0.03, -0.02, -0.01, 0.00, 0.01,
                       0.01, 0.02, 0.02, 0.02, 0.02, 0.02,
                       0.02, 0.02, 0.02, 0.01, 0.01, 0.01,
                       0.01, 0.01, 0.01, 0.01, 0.01, 0.01,
                       0.01, 0.01, 0.01, 0.01, 0.01, 0.01,
                       0.01, 0.01, 0.01, 0.01, 0.01, 0.01,
                       0.01, 0.01, 0.01, 0.01, 0.01, 0.01,
                       0.01, 0.01, 0.01, 0.01, 0.01, 0.01,
                       0.01, 0.01, 0.01, 0.01, 0.01, 0.01,
                       0.01, 0.01, 0.01, 0.01, 0.01, 0.01,
                       0.01, 0.01, 0.01, 0.01, 0.01, 0.01,
                       0.01, 0.01, 0.01, 0.01, 0.01, 0.01,
                       0.02, 0.02, 0.02, 0.03, 0.03, 0.04,
                       0.04, 0.05, 0.05, 0.05, 0.04, 0.02,
                       -0.01, -0.05, -0.11, -0.18, -0.27, -0.37,
                       -0.49, -0.61, -0.73, -0.84, -0.92, -0.98,
                       -1.00, -0.98, -0.93, -0.84, -0.73, -0.61,
                       -0.49, -0.38, -0.27, -0.18, -0.11, -0.05,
                       -0.01, 0.02, 0.04, 0.05, 0.05, 0.05,
                       0.05, 0.04, 0.04, 0.03, 0.03, 0.02,
                       0.02, 0.02, 0.01, 0.01, 0.01, 0.01,
                       0.01, 0.01, 0.01, 0.01, 0.01, 0.01,
                       0.01, 0.01, 0.01, 0.01, 0.01, 0.01,
                       0.01, 0.01, 0.01, 0.01, 0.01, 0.01,
                       0.01, 0.01, 0.01, 0.01, 0.01, 0.01,
                       0.01, 0.01, 0.01, 0.01, 0.01, 0.01,
                       0.01, 0.01, 0.01, 0.01, 0.01, 0.01,
                       0.01, 0.01, 0.01, 0.01, 0.02, 0.02,
                       0.03, 0.04, 0.05, 0.06, 0.08, 0.09,
                       0.11, 0.12, 0.12, 0.13, 0.13, 0.12,
                       0.11, 0.10, 0.09, 0.07, 0.06, 0.05,
                       0.04, 0.03, 0.02, 0.02, 0.01, 0.01,
                       0.01, 0.01, 0.01, 0.01, 0.01, 0.01,
                       0.01, 0.01, 0.01, 0.01, 0.01, 0.01,
                       0.01, 0.01, 0.01, 0.01, 0.01, 0.01,
                       0.01, 0.01, 0.01, 0.01, 0.01, 0.01,
                       0.01, 0.01, 0.01, 0.01, 0.01, 0.01,
                       0.01, 0.01, 0.01, 0.01, 0.01, 0.01,
                       0.01, 0.01]),
                            amp_Z = np.array([-0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.01, -0.01, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, 0.00,
                       0.00, 0.01, 0.01, 0.01, 0.01, 0.01,
                       0.01, 0.01, 0.01, 0.01, 0.01, 0.01,
                       0.00, 0.00, 0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.01, -0.01, -0.01, -0.01, -0.01,
                       -0.02, -0.02, -0.02, -0.03, -0.03, -0.03,
                       -0.04, -0.04, -0.04, -0.04, -0.03, -0.03,
                       -0.03, -0.02, -0.02, -0.02, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.01, -0.01,
                       -0.02, -0.02, -0.03, -0.04, -0.06, -0.07,
                       -0.09, -0.10, -0.11, -0.12, -0.13, -0.13,
                       -0.13, -0.12, -0.11, -0.09, -0.08, -0.06,
                       -0.05, -0.04, -0.03, -0.02, -0.01, -0.01,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.02, -0.02, -0.02, -0.02,
                       -0.03, -0.03, -0.03, -0.03, -0.02, -0.01,
                       0.00, 0.03, 0.06, 0.10, 0.15, 0.21,
                       0.27, 0.34, 0.41, 0.47, 0.52, 0.55,
                       0.56, 0.55, 0.52, 0.47, 0.41, 0.34,
                       0.27, 0.21, 0.15, 0.10, 0.06, 0.03,
                       0.01, -0.01, -0.02, -0.03, -0.03, -0.03,
                       -0.03, -0.02, -0.02, -0.02, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.00, 0.00,
                       0.01, 0.01, 0.02, 0.03, 0.04, 0.05,
                       0.06, 0.07, 0.07, 0.07, 0.07, 0.07,
                       0.06, 0.06, 0.05, 0.04, 0.03, 0.02,
                       0.01, 0.00, -0.00, -0.00, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.01]),
                            dt = 0.05,
                            ),
                        ),
            ])

    def test_CalcSynthWV(self, name, model, rf_in, expected):
        out = pipeline._SynthesiseWV(pipeline.MakeFullModel(model), rf_in)
        self.assertBodyWavesEqual(out, expected)


    @parameterized.expand([
            ("Moho only", model, rf_in,
             pipeline.RotBodyWaveform(
                     parent = np.array([-0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.02, -0.02, -0.02,
                       -0.03, -0.03, -0.03, -0.03, -0.02, -0.01, 0.00, 0.02,
                       0.06, 0.09, 0.14, 0.20, 0.27, 0.33, 0.40, 0.46,
                       0.51, 0.55, 0.56, 0.56, 0.53, 0.48, 0.42, 0.36,
                       0.29, 0.22, 0.16, 0.11, 0.07, 0.03, 0.01, -0.01,
                       -0.02, -0.03, -0.03, -0.03, -0.03, -0.02, -0.02, -0.02,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.01, -0.01, -0.01, -0.01, -0.01, -0.02, -0.02,
                       -0.03, -0.03, -0.04, -0.04, -0.05, -0.05, -0.05, -0.05,
                       -0.05, -0.05, -0.04, -0.04, -0.03, -0.03, -0.02, -0.02,
                       -0.01, -0.01, -0.01, -0.01, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.02, -0.02, -0.02, -0.03, -0.03, -0.03,
                       -0.04, -0.04, -0.04, -0.04, -0.03, -0.03, -0.03, -0.02,
                       -0.02, -0.02, -0.01, -0.01, -0.01, -0.01, -0.01, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.01, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, 0.00, 0.00, 0.00, 0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00]),
                     daughter = np.array([-0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, 0.00, 0.00, 0.01, 0.01, 0.02, 0.02,
                       0.03, 0.03, 0.04, 0.04, 0.04, 0.05, 0.05, 0.04,
                       0.04, 0.04, 0.03, 0.02, 0.02, 0.01, 0.01, 0.01,
                       0.00, 0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 0.00, 0.00,
                       0.01, 0.01, 0.01, 0.02, 0.02, 0.03, 0.04, 0.04,
                       0.04, 0.05, 0.05, 0.05, 0.04, 0.04, 0.03, 0.03,
                       0.02, 0.02, 0.01, 0.01, 0.00, 0.00, 0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       -0.00, -0.00, -0.00, -0.01, -0.01, -0.02, -0.02, -0.03,
                       -0.03, -0.04, -0.04, -0.05, -0.05, -0.05, -0.05, -0.05,
                       -0.04, -0.04, -0.03, -0.02, -0.02, -0.01, -0.01, -0.01,
                       -0.00, -0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, -0.00, -0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 0.00, 0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00]),
                        dt = 0.05),
                )
            ])
    def test_RotatetoPSV(self, name, model, rf_in, expected):
        model = pipeline.MakeFullModel(model)
        wv = pipeline._SynthesiseWV(model, rf_in)
        self.assertRotBodyWavesEqual(pipeline._RotateToPSV(wv, model, rf_in),
                expected)

    @parameterized.expand([
            ("Moho only", model, rf_in, pipeline.RotBodyWaveform(
                     parent = np.array([0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01,
                       -0.02, -0.02, -0.02, -0.02, -0.03, -0.03, -0.04, -0.04,
                       -0.04, -0.04, -0.04, -0.04, -0.03, -0.01, 0.00, 0.03,
                       0.06, 0.10, 0.14, 0.18, 0.23, 0.28, 0.33, 0.38,
                       0.42, 0.45, 0.47, 0.47, 0.47, 0.45, 0.43, 0.39,
                       0.35, 0.30, 0.25, 0.20, 0.15, 0.11, 0.07, 0.04,
                       0.01, -0.01, -0.02, -0.03, -0.04, -0.04, -0.04, -0.04,
                       -0.04, -0.03, -0.03, -0.03, -0.02, -0.02, -0.02, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.02, -0.02, -0.02,
                       -0.03, -0.03, -0.04, -0.04, -0.04, -0.05, -0.05, -0.05,
                       -0.05, -0.05, -0.05, -0.04, -0.04, -0.04, -0.03, -0.03,
                       -0.02, -0.02, -0.02, -0.01, -0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.02, -0.02, -0.02, -0.02, -0.03, -0.03,
                       -0.03, -0.03, -0.03, -0.03, -0.03, -0.03, -0.03, -0.03,
                       -0.03, -0.02, -0.02, -0.02, -0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01,
                       -0.01, -0.01, -0.01, -0.01, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.01, 0.01, 0.01, 0.01,
                       0.01, 0.01, 0.01, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00]),
                    daughter = np.array([0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, 0.00, 0.00, 0.01, 0.01, 0.01, 0.02,
                       0.02, 0.03, 0.03, 0.03, 0.04, 0.04, 0.04, 0.04,
                       0.04, 0.03, 0.03, 0.03, 0.02, 0.02, 0.02, 0.01,
                       0.01, 0.01, 0.00, 0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 0.00, 0.00,
                       0.01, 0.01, 0.01, 0.02, 0.02, 0.03, 0.03, 0.03,
                       0.04, 0.04, 0.04, 0.04, 0.04, 0.04, 0.03, 0.03,
                       0.03, 0.02, 0.02, 0.01, 0.01, 0.01, 0.00, 0.00,
                       0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       -0.00, -0.00, -0.00, -0.01, -0.01, -0.02, -0.02, -0.02,
                       -0.03, -0.03, -0.04, -0.04, -0.04, -0.04, -0.04, -0.04,
                       -0.04, -0.04, -0.04, -0.03, -0.03, -0.02, -0.02, -0.01,
                       -0.01, -0.01, -0.00, -0.00, -0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00, -0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00]),
                    dt = 0.05
                     )
            ),
            ])
    def test_PrepWaveform(self, name, model, rf_in, expected):
        model = pipeline.MakeFullModel(model)
        wv = pipeline._SynthesiseWV(model, rf_in)
        wv = pipeline._RotateToPSV(wv, model, rf_in)
        self.assertRotBodyWavesEqual(pipeline._PrepWaveform(wv, Ts = [1, 50]),
                                     expected)


    @parameterized.expand([
            ("Moho only parent", model, rf_in, -1,
             np.array([0.27, 0.26, 0.24, 0.25,
                       0.29, 0.34, 0.35, 0.34, 0.34, 0.34, 0.33, 0.33,
                       0.33, 0.34, 0.34, 0.32, 0.30, 0.30, 0.31, 0.30,
                       0.29, 0.27, 0.26, 0.25, 0.24, 0.23, 0.22, 0.21,
                       0.20, 0.18, 0.17, 0.16, 0.15, 0.14, 0.12, 0.10,
                       0.09, 0.09, 0.08, 0.07, 0.06, 0.05, 0.04, 0.04,
                       0.03, 0.03, 0.02, 0.02, 0.02, 0.01, 0.01, 0.01,
                       0.01, 0.01, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00,
                       0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.01,
                       0.01, 0.01, 0.01, 0.01, 0.02, 0.02, 0.02, 0.03,
                       0.03, 0.04, 0.04, 0.05, 0.06, 0.07, 0.08, 0.09,
                       0.09, 0.10, 0.12, 0.14, 0.15, 0.16, 0.17, 0.18,
                       0.20, 0.21, 0.22, 0.23, 0.24, 0.25, 0.26, 0.27,
                       0.29, 0.30, 0.31, 0.30, 0.30, 0.32, 0.34, 0.34,
                       0.33, 0.33, 0.33, 0.34, 0.34, 0.34, 0.35, 0.34,
                       0.29, 0.25, 0.24, 0.26])),
            ("Moho only D5", model, rf_in, 5,
             np.array([-0.01 + 0.00j, -0.01 + 0.00j, -0.01 + 0.01j, 0.00 + 0.00j,
                       -0.00 -0.00j, -0.01 -0.00j, -0.00 + 0.00j, -0.00 + 0.00j,
                       -0.00 + 0.01j, 0.01 + 0.00j, 0.00 -0.01j, -0.01 -0.00j,
                       -0.00 + 0.01j, 0.00 + 0.00j, -0.00 + 0.01j, 0.01 + 0.01j,
                       0.00 -0.01j, -0.01 -0.00j, -0.00 + 0.01j, 0.00 + 0.00j,
                       0.00 + 0.00j, 0.00 + 0.00j, 0.00 -0.00j, -0.00 -0.00j,
                       -0.00 + 0.00j, 0.00 + 0.00j, 0.00 -0.00j, 0.00 + 0.00j,
                       0.00 -0.00j, -0.00 -0.00j, -0.00 + 0.00j, 0.00 + 0.00j,
                       0.00 + 0.00j, 0.00 + 0.00j, 0.00 -0.00j, -0.00 -0.00j,
                       -0.00 + 0.00j, 0.00 + 0.00j, 0.00 -0.00j, 0.00 -0.00j,
                       0.00 -0.00j, -0.00 -0.00j, -0.00 + 0.00j, 0.00 + 0.00j,
                       0.00 -0.00j, 0.00 -0.00j, 0.00 -0.00j, -0.00 -0.00j,
                       -0.00 + 0.00j, 0.00 + 0.00j, 0.00 -0.00j, 0.00 -0.00j,
                       -0.00 -0.00j, -0.00 -0.00j, -0.00 -0.00j, -0.00 + 0.00j,
                       0.00 + 0.00j, 0.00 -0.00j, -0.00 -0.00j, -0.00 -0.00j,
                       -0.00 -0.00j, -0.00 + 0.00j, 0.00 + 0.00j, 0.00 -0.00j,
                       -0.00 -0.00j, -0.00 -0.00j, -0.00 + 0.00j, -0.00 + 0.00j,
                       0.00 + 0.00j, 0.00 -0.00j, -0.00 -0.00j, -0.00 + 0.00j,
                       0.00 + 0.00j, -0.00 + 0.00j, 0.00 + 0.00j, 0.00 -0.00j,
                       -0.00 -0.00j, -0.00 + 0.00j, -0.00 + 0.00j, -0.00 + 0.00j,
                       0.00 + 0.00j, 0.00 -0.00j, -0.00 -0.00j, -0.00 + 0.00j,
                       0.00 + 0.00j, 0.00 + 0.00j, 0.00 + 0.00j, 0.00 -0.00j,
                       -0.00 -0.00j, -0.00 + 0.00j, 0.00 + 0.00j, 0.00 + 0.00j,
                       0.00 + 0.00j, 0.00 -0.00j, -0.00 -0.00j, -0.00 + 0.00j,
                       0.00 + 0.00j, 0.00 + 0.00j, 0.00 -0.00j, 0.00 -0.00j,
                       0.00 -0.00j, -0.00 -0.00j, -0.00 + 0.00j, 0.00 + 0.00j,
                       0.00 -0.00j, 0.00 -0.00j, 0.00 -0.00j, -0.00 -0.00j,
                       -0.00 + 0.00j, 0.00 + 0.00j, 0.00 -0.00j, 0.00 -0.00j,
                       -0.00 -0.00j, -0.00 -0.00j, -0.00 + 0.00j, 0.00 + 0.00j,
                       0.00 -0.00j, -0.00 -0.00j, -0.00 -0.00j, -0.00 -0.00j,
                       -0.00 + 0.00j, 0.00 + 0.00j, 0.00 -0.00j, -0.00 -0.00j,
                       -0.00 -0.00j, -0.00 + 0.00j, -0.00 + 0.00j, -0.00 + 0.00j,
                       0.00 -0.00j, -0.00 -0.00j, -0.00 + 0.00j, -0.00 + 0.00j,
                       -0.00 + 0.00j, -0.00 + 0.00j, 0.00 + 0.00j, -0.00 -0.00j,
                       -0.00 + 0.00j, -0.00 + 0.00j, 0.00 + 0.00j, 0.00 + 0.00j,
                       0.00 + 0.00j, -0.00 -0.00j, -0.00 + 0.00j, -0.00 + 0.00j,
                       0.00 + 0.00j, -0.00 + 0.00j, 0.00 + 0.00j, 0.00 -0.00j,
                       -0.00 + 0.00j, 0.00 -0.00j, -0.00 + 0.00j, 0.00 -0.00j,
                       -0.00 + 0.00j, 0.00 + 0.00j, -0.00 + 0.00j, 0.00 + 0.00j,
                       -0.00 + 0.00j, 0.00 + 0.00j, -0.00 -0.00j, 0.00 + 0.00j,
                       -0.00 -0.00j, -0.00 + 0.00j, -0.00 -0.00j, -0.00 + 0.00j,
                       0.00 + 0.00j, -0.00 + 0.00j, 0.00 -0.00j, 0.00 + 0.00j,
                       0.00 -0.00j, -0.00 -0.00j, 0.00 -0.00j, -0.00 + 0.00j,
                       0.00 + 0.00j, -0.00 + 0.00j, 0.00 + 0.00j, -0.00 + 0.00j,
                       0.00 + 0.00j, 0.00 -0.00j, 0.00 + 0.00j, 0.00 -0.00j,
                       0.00 + 0.00j, -0.00 -0.00j, -0.00 + 0.00j, 0.00 + 0.00j,
                       -0.00 + 0.00j, 0.00 + 0.00j, 0.00 + 0.00j, 0.00 + 0.00j,
                       0.00 -0.00j, 0.00 -0.00j, -0.00 + 0.00j, 0.00 + 0.00j,
                       -0.00 + 0.00j, 0.00 + 0.00j, 0.00 + 0.00j, 0.00 + 0.00j,
                       0.00 -0.00j, 0.00 + 0.00j, 0.00 -0.00j, 0.00 -0.00j,
                       0.00 -0.00j, -0.00 -0.00j, 0.00 -0.00j, 0.00 + 0.00j,
                       0.00 + 0.00j, 0.00 + 0.00j, 0.00 -0.00j, 0.00 -0.00j,
                       0.00 -0.00j, -0.00 -0.00j, 0.00 -0.00j, -0.00 -0.00j,
                       0.00 + 0.00j, -0.00 + 0.00j, 0.00 + 0.00j, 0.00 -0.00j,
                       0.00 + 0.00j, 0.00 -0.00j, 0.00 -0.00j, 0.00 -0.00j,
                       -0.00 -0.00j, 0.00 -0.00j, -0.00 + 0.00j, 0.00 -0.00j,
                       0.00 + 0.00j, 0.00 -0.00j, 0.00 -0.00j, 0.00 -0.00j,
                       0.00 -0.00j, -0.00 -0.00j, -0.00 -0.00j, 0.00 + 0.00j,
                       -0.00 -0.00j, 0.00 -0.00j, 0.00 -0.00j, 0.00 + 0.00j,
                       0.00 -0.00j, 0.00 -0.00j, 0.00 -0.00j, -0.00 -0.00j,
                       -0.00 -0.00j, -0.00 + 0.00j, 0.00 -0.00j, -0.00 -0.00j,
                       0.00 + 0.00j, 0.00 -0.00j, 0.00 -0.00j, 0.00 -0.00j,
                       0.00 -0.00j, -0.00 -0.00j, -0.00 -0.00j, -0.00 + 0.00j,
                       -0.00 + 0.00j, 0.00 -0.00j, 0.00 -0.00j, 0.00 -0.00j,
                       -0.00 -0.00j, 0.00 -0.00j, -0.00 -0.00j, -0.00 -0.00j,
                       0.00 + 0.00j, -0.00 -0.00j, -0.00 + 0.00j, 0.00 -0.00j,
                       -0.00 + 0.00j, 0.00 -0.00j, -0.00 -0.00j, -0.00 -0.00j,
                       -0.00 -0.00j, -0.00 + 0.00j, -0.00 + 0.00j, -0.00 + 0.00j,
                       0.00 + 0.00j, 0.00 -0.00j, -0.00 -0.00j, -0.00 -0.00j,
                       -0.00 -0.00j, -0.00 + 0.00j, -0.00 -0.00j, -0.00 -0.00j,
                       -0.00 + 0.00j, -0.00 + 0.00j, 0.00 + 0.00j, 0.00 + 0.00j,
                       0.00 + 0.00j, -0.00 -0.00j, -0.00 -0.00j, -0.00 -0.00j,
                       -0.00 -0.00j, -0.00 + 0.00j, -0.00 + 0.00j, 0.00 -0.00j,
                       -0.00 + 0.00j, -0.00 -0.00j, -0.00 -0.00j, 0.00 -0.00j,
                       -0.00 -0.00j, -0.00 -0.00j, -0.00 -0.00j, -0.00 + 0.00j,
                       -0.00 + 0.00j, -0.00 + 0.00j, 0.00 + 0.00j, -0.00 + 0.00j,
                       -0.00 -0.00j, -0.00 -0.00j, -0.00 + 0.00j, -0.00 -0.00j,
                       -0.00 + 0.00j, -0.00 + 0.00j, -0.00 + 0.00j, 0.00 + 0.00j,
                       0.00 + 0.00j, 0.00 + 0.00j, 0.00 + 0.00j, 0.00 -0.00j,
                       -0.00 -0.00j, -0.00 -0.00j, -0.00 + 0.00j, -0.00 + 0.00j,
                       -0.00 + 0.00j, 0.00 + 0.00j, 0.00 -0.00j, -0.00 -0.00j,
                       0.00 + 0.00j, -0.00 -0.00j, -0.00 -0.00j, -0.00 -0.00j,
                       -0.00 -0.00j, -0.00 + 0.00j, -0.00 + 0.00j, 0.00 + 0.00j,
                       0.00 -0.00j, 0.00 + 0.00j, 0.00 + 0.00j, -0.00 + 0.00j,
                       -0.00 + 0.00j, 0.00 + 0.00j, 0.00 + 0.00j, 0.00 + 0.00j,
                       -0.00 -0.00j, -0.00 + 0.00j, 0.00 + 0.00j, 0.00 + 0.00j,
                       -0.00 + 0.00j, -0.00 + 0.00j, -0.00 + 0.00j, -0.00 + 0.00j,
                       0.00 + 0.00j, 0.00 + 0.00j, 0.00 -0.00j, 0.00 + 0.00j,
                       0.00 -0.00j, -0.00 -0.00j, -0.00 + 0.00j, 0.00 + 0.00j,
                       0.00 + 0.00j, 0.00 + 0.00j, -0.00 + 0.00j, 0.00 + 0.00j,
                       0.00 + 0.00j, 0.00 + 0.00j, 0.00 -0.00j, 0.00 -0.00j,
                       0.00 -0.00j, -0.00 -0.00j, 0.00 + 0.00j, 0.00 + 0.00j,
                       0.00 -0.00j, 0.00 -0.00j, 0.00 -0.00j, 0.00 -0.00j,
                       0.00 -0.00j, 0.00 -0.00j, 0.00 -0.00j, -0.00 -0.00j,
                       -0.00 + 0.00j, -0.00 + 0.00j, -0.00 + 0.00j, -0.00 + 0.00j,
                       0.00 + 0.00j, 0.00 -0.00j, -0.00 -0.00j, 0.00 + 0.00j,
                       0.00 -0.00j, 0.00 + 0.00j, 0.00 + 0.00j, 0.00 -0.00j,
                       0.00 + 0.00j, 0.00 + 0.00j, 0.00 + 0.00j, 0.00 -0.00j,
                       -0.00 + 0.00j, -0.00 + 0.00j, -0.00 + 0.00j, -0.00 + 0.00j,
                       0.00 + 0.00j, 0.00 -0.00j, -0.00 -0.00j, 0.00 -0.00j,
                       0.00 -0.00j, 0.00 -0.00j, 0.00 -0.00j, 0.00 -0.00j,
                       -0.00 -0.00j, -0.00 + 0.00j, -0.00 + 0.00j, -0.00 + 0.00j,
                       0.00 -0.00j, -0.00 -0.00j, -0.00 + 0.00j, -0.00 + 0.00j,
                       -0.00 + 0.00j, -0.00 + 0.00j, 0.00 + 0.00j, -0.00 + 0.00j,
                       -0.00 + 0.00j, 0.00 + 0.00j, 0.00 + 0.00j, 0.00 + 0.00j,
                       0.00 + 0.00j, 0.00 -0.00j, -0.00 -0.00j, -0.00 -0.00j,
                       0.00 -0.00j, 0.00 -0.00j, 0.00 -0.00j, -0.00 -0.00j,
                       -0.00 + 0.00j, 0.00 -0.00j, 0.00 -0.00j, 0.00 -0.00j,
                       0.00 -0.00j, 0.00 -0.00j, 0.00 -0.00j, -0.00 + 0.00j,
                       0.00 + 0.00j, 0.00 + 0.00j, 0.00 + 0.00j, 0.00 -0.00j,
                       0.00 -0.00j, -0.00 -0.00j, -0.00 -0.00j, -0.00 -0.00j,
                       -0.00 -0.00j, -0.00 + 0.00j, 0.00 -0.00j, 0.00 -0.00j,
                       0.00 -0.00j, 0.00 -0.00j, 0.00 + 0.00j, 0.00 -0.00j,
                       0.00 -0.00j, 0.00 -0.00j, -0.00 + 0.00j, -0.00 + 0.00j,
                       0.00 + 0.00j, 0.00 + 0.00j, 0.00 + 0.00j, 0.00 -0.00j,
                       -0.00 -0.00j, -0.00 + 0.00j, -0.00 + 0.00j, -0.00 + 0.00j,
                       -0.00 + 0.00j, -0.00 + 0.00j, -0.00 + 0.00j, -0.00 + 0.00j,
                       0.00 + 0.00j, 0.00 -0.00j, 0.00 -0.00j, -0.00 -0.00j,
                       -0.00 -0.00j, -0.00 -0.00j, -0.00 + 0.00j, 0.00 + 0.00j,
                       0.00 + 0.00j, 0.00 -0.00j, -0.00 -0.00j, -0.00 + 0.00j,
                       -0.00 + 0.00j, 0.00 + 0.00j, 0.00 -0.00j, 0.00 + 0.00j,
                       -0.00 -0.00j, -0.00 + 0.00j, 0.00 + 0.00j, 0.00 + 0.00j,
                       0.00 -0.00j, 0.00 -0.00j, 0.00 -0.00j, -0.00 -0.00j,
                       -0.00 -0.00j, 0.00 + 0.00j, 0.00 -0.00j, -0.00 -0.00j,
                       -0.00 -0.00j, -0.00 -0.00j, -0.00 + 0.00j, -0.00 + 0.00j,
                       0.00 -0.00j, -0.00 -0.00j, -0.00 -0.00j, -0.00 + 0.00j,
                       -0.00 + 0.00j, 0.00 + 0.00j, 0.00 + 0.00j, 0.00 -0.00j,
                       -0.00 -0.00j, -0.00 + 0.00j, -0.00 + 0.00j, 0.00 + 0.00j,
                       0.00 + 0.00j, 0.00 -0.00j, -0.00 -0.00j, -0.00 -0.00j,
                       -0.00 + 0.00j, 0.00 + 0.00j, 0.00 -0.00j, 0.00 -0.00j,
                       -0.00 -0.00j, -0.00 -0.00j, -0.00 + 0.00j, -0.00 + 0.00j,
                       0.00 + 0.00j, -0.00 -0.00j, -0.00 -0.00j, -0.00 + 0.00j,
                       -0.00 + 0.00j, -0.00 + 0.00j, 0.00 + 0.00j, 0.00 -0.00j,
                       -0.00 + 0.00j, -0.00 + 0.00j, 0.00 + 0.00j, 0.00 + 0.00j,
                       0.00 + 0.00j, 0.00 -0.00j, 0.00 -0.00j, -0.00 -0.00j,
                       -0.00 + 0.00j, 0.00 -0.00j, 0.00 + 0.00j, 0.00 -0.00j,
                       -0.00 -0.00j, -0.00 -0.00j, -0.00 + 0.00j, 0.00 + 0.00j,
                       0.00 -0.00j, 0.00 -0.00j, -0.00 -0.00j, -0.00 + 0.00j,
                       -0.00 + 0.00j, -0.00 + 0.00j, 0.00 + 0.00j, 0.00 + 0.00j,
                       0.00 -0.00j, -0.00 -0.00j, -0.00 -0.00j, -0.00 -0.00j,
                       -0.00 -0.00j, -0.00 -0.00j, -0.00 -0.00j, -0.00 -0.00j,
                       -0.00 + 0.00j, 0.00 + 0.00j, 0.00 -0.00j, 0.00 -0.00j,
                       0.00 -0.00j, -0.00 -0.00j, -0.00 -0.00j, 0.00 + 0.00j,
                       0.00 + 0.00j, 0.00 + 0.00j, 0.00 -0.00j, 0.00 + 0.00j,
                       0.00 + 0.00j, 0.00 + 0.00j, 0.00 + 0.00j, -0.00 -0.00j,
                       -0.00 + 0.00j, -0.00 + 0.00j, -0.00 + 0.00j, -0.00 + 0.00j,
                       0.00 + 0.00j, 0.00 + 0.00j, 0.00 -0.00j, 0.00 -0.00j,
                       0.00 -0.00j, -0.00 -0.00j, 0.00 + 0.00j, 0.00 + 0.00j,
                       0.00 + 0.00j, 0.00 + 0.00j, 0.00 + 0.00j, 0.00 + 0.00j,
                       -0.00 -0.00j, -0.00 + 0.00j, 0.00 + 0.00j, 0.00 + 0.00j,
                       0.00 + 0.00j, -0.00 + 0.00j, -0.00 + 0.00j, 0.00 + 0.00j,
                       0.00 -0.00j, 0.00 -0.00j, 0.00 -0.00j, 0.00 -0.00j,
                       -0.00 -0.00j, -0.00 -0.00j, 0.00 -0.00j, -0.00 -0.00j,
                       -0.00 -0.00j, -0.00 -0.00j, -0.00 -0.00j, -0.00 + 0.00j,
                       0.00 + 0.00j, -0.00 -0.00j, -0.00 -0.00j, -0.00 -0.00j,
                       -0.00 + 0.00j, 0.00 + 0.00j, 0.00 + 0.00j, 0.00 + 0.00j,
                       0.00 + 0.00j, 0.00 + 0.00j, -0.00 + 0.00j, 0.00 + 0.00j,
                       0.00 -0.00j, -0.00 -0.00j, -0.00 -0.00j, -0.00 -0.00j,
                       -0.00 -0.00j, 0.00 + 0.00j, 0.00 -0.00j, 0.00 -0.00j,
                       0.00 -0.00j, 0.00 + 0.00j, 0.00 -0.00j, 0.00 -0.00j,
                       0.00 + 0.00j, 0.00 -0.00j, -0.00 + 0.00j, 0.00 + 0.00j,
                       0.00 -0.00j, -0.00 -0.00j, -0.00 -0.00j, -0.00 -0.00j,
                       -0.00 -0.00j, -0.00 + 0.00j, 0.00 + 0.00j, 0.00 + 0.00j,
                       0.00 + 0.00j, 0.00 + 0.00j, 0.00 + 0.00j, 0.00 + 0.00j,
                       0.00 + 0.00j, 0.00 -0.00j, 0.00 -0.00j, -0.00 + 0.00j,
                       0.00 + 0.00j, 0.00 + 0.00j, 0.00 + 0.00j, 0.00 -0.00j,
                       0.00 -0.00j, 0.00 -0.00j, -0.00 -0.00j, 0.00 -0.00j,
                       0.00 -0.00j, 0.00 -0.00j, -0.00 -0.00j, -0.00 + 0.00j,
                       0.00 + 0.00j, 0.00 -0.00j, 0.00 + 0.00j, 0.00 -0.00j,
                       0.00 -0.00j, -0.00 -0.00j, -0.00 -0.00j, -0.00 -0.00j,
                       -0.00 -0.00j, 0.00 -0.00j, 0.00 -0.00j, -0.00 -0.00j,
                       -0.00 + 0.00j, 0.00 -0.00j, 0.00 -0.00j, 0.00 -0.00j,
                       -0.00 -0.00j, -0.00 -0.00j, 0.00 -0.00j, 0.00 -0.00j,
                       0.00 + 0.00j, 0.00 -0.00j, -0.00 -0.00j, -0.00 -0.00j,
                       -0.00 + 0.00j, -0.00 + 0.00j, -0.00 + 0.00j, -0.00 + 0.00j,
                       0.00 -0.00j, -0.00 + 0.00j, 0.00 + 0.00j, 0.00 -0.00j,
                       -0.00 -0.00j, -0.00 -0.00j, -0.00 -0.00j, -0.00 + 0.00j,
                       -0.00 + 0.00j, 0.00 + 0.00j, 0.00 -0.00j, 0.00 -0.00j,
                       0.00 -0.00j, 0.00 -0.00j, -0.00 -0.00j, -0.00 -0.00j,
                       -0.00 -0.00j, -0.00 + 0.00j, -0.00 -0.00j, -0.00 + 0.00j,
                       -0.00 + 0.00j, -0.00 -0.00j, 0.00 -0.00j, -0.00 -0.00j,
                       -0.00 -0.00j, -0.00 -0.00j, -0.00 + 0.00j, -0.00 + 0.00j,
                       -0.00 + 0.00j, 0.00 + 0.00j, -0.00 + 0.00j, -0.00 + 0.00j,
                       -0.00 -0.00j, 0.00 + 0.00j, -0.00 -0.00j, -0.00 -0.00j,
                       -0.00 + 0.00j, -0.00 + 0.00j, -0.00 + 0.00j, -0.00 + 0.00j,
                       0.00 -0.00j, 0.00 -0.00j, 0.00 -0.00j, -0.00 -0.00j,
                       -0.00 -0.00j, -0.00 + 0.00j, -0.00 + 0.00j, -0.00 -0.00j,
                       -0.00 + 0.00j, -0.00 + 0.00j, -0.00 + 0.00j, 0.00 + 0.00j,
                       0.00 -0.00j, -0.00 -0.00j, -0.00 -0.00j, -0.00 -0.00j,
                       -0.00 + 0.00j, -0.00 + 0.00j, -0.00 + 0.00j, 0.00 + 0.00j,
                       -0.00 -0.00j, 0.00 + 0.00j, -0.00 -0.00j, -0.00 + 0.00j,
                       0.00 -0.00j, -0.00 + 0.00j, -0.00 + 0.00j, 0.00 + 0.00j,
                       -0.00 + 0.00j, 0.00 + 0.00j, 0.00 + 0.00j, 0.00 + 0.00j,
                       -0.00 -0.00j, -0.00 -0.00j, -0.00 + 0.00j, -0.00 + 0.00j,
                       0.00 + 0.00j, 0.00 + 0.00j, 0.00 + 0.00j, 0.00 + 0.00j,
                       0.00 -0.00j, -0.00 + 0.00j, 0.00 + 0.00j, -0.00 -0.00j,
                       -0.00 + 0.00j, -0.00 + 0.00j, 0.00 + 0.00j, 0.00 + 0.00j,
                       0.00 + 0.00j, 0.00 -0.00j, 0.00 + 0.00j, 0.00 + 0.00j,
                       -0.00 + 0.00j, 0.00 -0.00j, -0.00 + 0.00j, -0.00 + 0.00j,
                       0.00 + 0.00j, 0.00 + 0.00j, 0.00 + 0.00j, 0.00 + 0.00j,
                       0.00 -0.00j, 0.00 + 0.00j, -0.00 -0.00j, 0.00 + 0.00j,
                       -0.00 + 0.00j, 0.00 + 0.00j, 0.00 + 0.00j, 0.00 + 0.00j,
                       0.00 -0.00j, 0.00 + 0.00j, 0.00 -0.00j, -0.00 -0.00j,
                       0.00 -0.00j, -0.00 + 0.00j, 0.00 + 0.00j, -0.00 + 0.00j,
                       0.00 + 0.00j, 0.00 + 0.00j, 0.00 + 0.00j, 0.00 -0.00j,
                       0.00 -0.00j, 0.00 -0.00j, 0.00 + 0.00j, -0.00 + 0.00j,
                       0.00 + 0.00j, 0.00 + 0.00j, 0.00 + 0.00j, 0.00 -0.00j,
                       0.00 + 0.00j, 0.00 -0.00j, 0.00 -0.00j, 0.00 -0.00j,
                       -0.00 -0.00j, 0.00 -0.00j, -0.00 -0.00j, 0.00 + 0.00j,
                       0.00 + 0.00j, 0.00 -0.00j, 0.00 -0.00j, 0.00 -0.00j,
                       -0.00 -0.00j, 0.00 -0.00j, -0.00 -0.00j, -0.00 + 0.00j,
                       0.00 -0.00j, 0.00 + 0.00j, 0.00 -0.00j, 0.00 + 0.00j,
                       0.00 -0.00j, -0.00 -0.00j, 0.00 -0.00j, -0.00 -0.00j,
                       0.00 -0.00j, -0.00 -0.00j, 0.00 + 0.00j, -0.00 + 0.00j,
                       0.00 + 0.00j, 0.00 -0.00j, 0.00 + 0.00j, -0.00 -0.00j,
                       0.00 -0.00j, -0.00 -0.00j, -0.00 + 0.00j, -0.00 -0.00j,
                       -0.00 + 0.00j, 0.00 -0.00j, -0.00 + 0.00j, 0.00 -0.00j,
                       -0.00 -0.00j, 0.00 -0.00j, -0.00 -0.00j, 0.00 -0.00j,
                       -0.00 -0.00j, 0.00 + 0.00j, -0.00 -0.00j, 0.00 + 0.00j,
                       -0.00 -0.00j, 0.00 + 0.00j, 0.00 -0.00j, -0.00 -0.00j,
                       0.00 -0.00j, -0.00 -0.00j, -0.00 -0.00j, -0.00 + 0.00j,
                       0.00 -0.00j, 0.00 -0.00j, 0.00 -0.00j, -0.00 -0.00j,
                       -0.00 -0.00j, -0.00 + 0.00j, 0.00 -0.00j, -0.00 -0.00j,
                       -0.00 -0.00j, -0.00 -0.00j, -0.00 -0.00j, -0.00 + 0.00j,
                       0.00 + 0.00j, -0.00 -0.00j, -0.00 -0.00j, -0.00 -0.00j,
                       -0.00 + 0.00j, -0.00 + 0.00j, 0.00 + 0.00j, 0.00 -0.00j,
                       -0.00 -0.00j, -0.00 + 0.00j, -0.00 + 0.00j, -0.00 + 0.00j,
                       0.00 + 0.00j, 0.00 -0.00j, -0.00 -0.00j, -0.00 + 0.00j,
                       -0.00 + 0.00j, 0.00 + 0.00j, 0.00 + 0.00j, 0.00 -0.00j,
                       -0.00 -0.00j, -0.00 + 0.00j, 0.00 + 0.00j, 0.00 + 0.00j,
                       0.00 + 0.00j, 0.00 -0.00j, -0.00 -0.00j, -0.00 + 0.00j,
                       0.00 + 0.00j, 0.00 + 0.00j, 0.00 + 0.00j, 0.00 -0.00j,
                       0.00 -0.00j, -0.00 -0.00j, -0.00 + 0.00j, 0.00 + 0.00j,
                       0.00 -0.00j, 0.00 -0.00j, 0.00 -0.00j, -0.00 -0.00j,
                       -0.00 + 0.00j, 0.00 + 0.00j, 0.00 -0.00j, 0.00 -0.00j,
                       0.00 -0.00j, -0.00 -0.00j, -0.00 + 0.00j, 0.00 + 0.00j,
                       0.00 -0.00j, -0.00 -0.00j, -0.00 -0.00j, -0.00 -0.00j,
                       -0.00 + 0.00j, 0.00 + 0.00j, 0.00 -0.00j, -0.00 -0.00j,
                       0.00 -0.00j, -0.00 -0.00j, -0.00 + 0.00j, 0.00 + 0.00j,
                       0.00 -0.00j, -0.00 -0.00j, -0.00 -0.00j, -0.00 + 0.00j,
                       -0.00 + 0.00j, 0.00 + 0.00j, 0.00 -0.00j, -0.00 -0.00j,
                       -0.00 + 0.00j, -0.00 + 0.00j, -0.00 + 0.00j, 0.00 + 0.00j,
                       0.00 -0.00j, -0.00 -0.00j, -0.00 + 0.00j, -0.00 + 0.00j,
                       -0.00 + 0.00j, 0.00 + 0.00j, 0.00 + 0.00j, 0.00 -0.00j,
                       -0.00 -0.00j, -0.00 + 0.00j, 0.00 + 0.00j, 0.00 + 0.00j,
                       0.00 + 0.00j, 0.00 -0.00j, -0.00 -0.00j, -0.00 + 0.00j,
                       0.00 + 0.00j, 0.00 + 0.00j, 0.00 + 0.00j, 0.00 -0.00j,
                       -0.00 -0.00j, -0.00 + 0.00j, 0.00 + 0.00j, 0.00 -0.00j,
                       0.00 -0.00j, 0.00 -0.00j, -0.00 -0.00j, -0.00 + 0.00j,
                       0.00 + 0.00j, 0.00 -0.00j, 0.00 + 0.00j, 0.00 -0.00j,
                       -0.00 -0.00j, -0.00 + 0.00j, 0.00 + 0.00j, 0.00 -0.00j,
                       0.00 -0.00j, 0.00 -0.00j, -0.00 -0.01j, -0.01 + 0.00j,
                       0.00 + 0.01j, 0.01 -0.01j, -0.00 -0.01j, 0.00 -0.00j,
                       -0.00 -0.01j, -0.01 + 0.00j, 0.00 + 0.01j, 0.01 -0.00j,
                       -0.00 -0.01j, -0.00 -0.00j, -0.00 -0.00j, -0.01 + 0.00j,
                       -0.00 + 0.00j, 0.00 -0.00j, -0.01 -0.01j, -0.01 + -0.00j])),
            ])
    def test_ETMTMSumFFT(self, name, model, rf_in, which_daughter, expected):
        model = pipeline.MakeFullModel(model)
        wv = pipeline._SynthesiseWV(model, rf_in)
        wv = pipeline._RotateToPSV(wv, model, rf_in)
        wv = pipeline._PrepWaveform(wv, Ts = [1, 50])
        win_length = 50
        num_windows = 7
        n_samp = 2**(int(win_length / wv.dt).bit_length())
        tapers = matlab.slepian(n_samp, num_windows)
        i_t0 = int(wv.parent.size/2)
        incident_win = i_t0+int(n_samp/2)*np.array([-1, 1])
        Parent = wv.parent[incident_win[0]:incident_win[1]]

        i_shift = 0.1
        pad = np.zeros(int(np.ceil(n_samp*i_shift)))
        Daughter_all = np.concatenate([pad, wv.daughter, pad])
        i_starts = np.arange(0,Daughter_all.size-(n_samp - 1), int(i_shift*n_samp))

        if which_daughter < 0:
            Daughter = Parent
        else:
            Daughter = matlab.Taper(
                    Daughter_all[i_starts[which_daughter]:i_starts[which_daughter]+n_samp],
                             int(n_samp/5), int(n_samp/5), int(4*n_samp/5))

        np.testing.assert_array_almost_equal(
                pipeline._ETMTMSumFFT(tapers, Parent, Daughter, num_windows),
                expected, decimal = 2)


    # And finally, check the RF calculation
    @parameterized.expand([
            ("Moho only", model, rf_in,
             pipeline.RecvFunc(amp = np.array([-0.00477, -0.00483, -0.00283,
                       -0.00104, -0.00067, -0.00126, -0.00126, 0.00018, 0.00094,
                       -0.00272, -0.00830, -0.00256, 0.02441, 0.05777, 0.06658,
                       0.04176, 0.00834, -0.00745, -0.00527, 0.00042, 0.00155,
                       0.00043, -0.00053, -0.00082, -0.00050, 0.00132, 0.00443,
                       0.00642, 0.00523, 0.00209, -0.00017, -0.00049, 0.00001,
                       0.00023, 0.00010, -0.00018, -0.00062, -0.00071, 0.00045,
                       0.00174, -0.00067, -0.00776, -0.00660, 0.01810, 0.05798,
                       0.07836, 0.05802, 0.01768, -0.00761, -0.00878, -0.00141,
                       0.00063, -0.00270, -0.00344, 0.00315, 0.00836, -0.00707,
                       -0.04769, -0.08416, -0.08077, -0.04126, -0.00365, 0.00871,
                       0.00194, -0.00443, -0.00443, -0.00243, -0.00154, -0.00144,
                       -0.00212, -0.00444, -0.00730, -0.00780, -0.00553, -0.00409,
                       -0.00602, -0.00880, -0.00837, -0.00478, -0.00144, -0.00039,
                       -0.00077, -0.00134, -0.00138, -0.00135, -0.00118, -0.00078,
                       -0.00070, -0.00159, -0.00284, -0.00294, -0.00154, 0.00010,
                       0.00077, 0.00060, 0.00042, 0.00060, 0.00086, 0.00074,
                       0.00024, 0.00031, 0.00218, 0.00538, 0.00851, 0.00709,
                       0.00360, 0.00136, 0.00132, 0.00193, 0.00197, 0.00170,
                       0.00140, 0.00071, 0.00012, 0.00161, 0.00606, 0.01038,
                       0.01032, 0.00610, 0.00220]),
                        std = np.ones(120,),
                        dt = 0.25, ray_param = 0.0618,
                        rf_phase = 'Ps', std_sc = 1, filter_corners = [1,100],
                        weight_by = 'even')),
            ("Moho and LAB", model._replace(vs = np.array([4, 4.7, 4.6]),
                                         idep = np.array([60, 80, 110])), rf_in,
            pipeline.RecvFunc(amp = np.array([-0.00524, -0.00487, -0.00294,
                       -0.00113, -0.00075, -0.00136, -0.00125, 0.00061, 0.00155,
                       -0.00319, -0.01041, -0.00307, 0.03162, 0.07456, 0.08589,
                       0.05391, 0.01088, -0.00941, -0.00659, 0.00068, 0.00225,
                       0.00055, -0.00062, -0.00087, -0.00050, 0.00157, 0.00558,
                       0.00896, 0.00824, 0.00242, -0.00592, -0.01180, -0.01139,
                       -0.00587, -0.00043, 0.00125, 0.00000, -0.00098, 0.00035,
                       0.00219, -0.00055, -0.00812, -0.00698, 0.01942, 0.06212,
                       0.08395, 0.06218, 0.01903, -0.00797, -0.00916, -0.00122,
                       0.00095, -0.00267, -0.00344, 0.00377, 0.00957, -0.00691,
                       -0.05065, -0.09003, -0.08649, -0.04402, -0.00354, 0.00875,
                       0.00229, -0.00382, -0.00385, -0.00200, -0.00122, -0.00123,
                       -0.00205, -0.00453, -0.00754, -0.00807, -0.00560, -0.00374,
                       -0.00523, -0.00781, -0.00752, -0.00425, -0.00117, -0.00015,
                       -0.00035, -0.00057, -0.00060, -0.00077, -0.00080, -0.00044,
                       -0.00017, -0.00066, -0.00154, -0.00169, -0.00078, 0.00032,
                       0.00067, 0.00034, 0.00019, 0.00081, 0.00149, 0.00032,
                       -0.00337, -0.00657, -0.00501, 0.00101, 0.00605, 0.00614,
                       0.00301, 0.00077, 0.00074, 0.00137, 0.00138, 0.00098,
                       0.00080, 0.00090, 0.00134, 0.00285, 0.00573, 0.00825,
                       0.00785, 0.00471, 0.00186]), dt = 0.25,
                        std = np.ones(120,),
                        rf_phase = 'Ps', ray_param = 0.0618, std_sc = 1,
                        filter_corners = [1,100], weight_by = 'even')),
            ("Moho, Sp", model, rf_in._replace(ray_param = 0.1157, rf_phase = 'Sp'),
             pipeline.RecvFunc(amp = np.array([-0.00107, -0.00113, -0.00143,
                       -0.00179, -0.00210, -0.00246, -0.00275, -0.00252, -0.00204,
                       -0.00297, -0.00585, -0.00598, 0.00254, 0.01135, -0.00614,
                       -0.06236, -0.12081, -0.12550, -0.07156, -0.01180, 0.01118,
                       0.00417, -0.00538, -0.00618, -0.00325, -0.00198, -0.00236,
                       -0.00264, -0.00239, -0.00206, -0.00179, -0.00142, -0.00096,
                       -0.00068, -0.00064, -0.00062, -0.00039, -0.00006, 0.00015,
                       0.00020, 0.00026, 0.00038, 0.00063, 0.00084, 0.00100,
                       0.00115, 0.00141, 0.00177, 0.00185, 0.00137, 0.00106,
                       0.00264, 0.00656, 0.01022, 0.01023, 0.00667, 0.00294,
                       0.00154, 0.00197, 0.00255, 0.00261, 0.00241, 0.00234,
                       0.00230, 0.00226, 0.00221, 0.00217, 0.00204, 0.00178,
                       0.00148, 0.00136, 0.00146, 0.00156, 0.00151, 0.00137,
                       0.00129, 0.00130, 0.00129, 0.00123, 0.00113, 0.00104,
                       0.00096, 0.00091, 0.00081, 0.00072, 0.00065, 0.00060,
                       0.00053, 0.00037, 0.00017, 0.00004, 0.00005, 0.00012,
                       0.00016, 0.00015, 0.00012, 0.00010, 0.00009, 0.00009,
                       0.00008, 0.00007, 0.00007, 0.00006, 0.00008, 0.00009,
                       0.00009, 0.00010, 0.00010, 0.00010, 0.00010, 0.00010,
                       0.00010, 0.00010, 0.00010, 0.00010, 0.00009, 0.00009,
                       0.00009, 0.00008, 0.00008]), dt = 0.25,
                        std = np.ones(120,),
                        rf_phase = 'Sp', ray_param = 0.1157,
                        std_sc = 1, filter_corners = [1,100],
                        weight_by = 'even')),
            ("Moho Sp, broader filter", model, rf_in._replace(ray_param = 0.1157,
                                                             rf_phase = 'Sp',
                                                             filter_corners = [4,100]),
#            pipeline.RecvFunc(amp = np.array([0.00007, -0.00063, -0.00145,
#                       -0.00208, -0.00206, -0.00108, 0.00081, 0.00294, 0.00383,
#                       0.00140, -0.00664, -0.02195, -0.04463, -0.07249, -0.10099,
#                       -0.12413, -0.13629, -0.13431, -0.11874, -0.09362, -0.06485,
#                       -0.03793, -0.01725, -0.00415, 0.00206, 0.00330, 0.00186,
#                       -0.00035, -0.00211, -0.00295, -0.00292, -0.00238, -0.00171,
#                       -0.00119, -0.00093, -0.00088, -0.00093, -0.00094, -0.00082,
#                       -0.00055, -0.00016, 0.00014, 0.00061, 0.00108, 0.00155,
#                       0.00209, 0.00283, 0.00391, 0.00541, 0.00733, 0.00950,
#                       0.01162, 0.01331, 0.01424, 0.01421, 0.01328, 0.01170,
#                       0.00983, 0.00804, 0.00657, 0.00556, 0.00498, 0.00481,
#                       0.00479, 0.00480, 0.00475, 0.00459, 0.00434, 0.00405,
#                       0.00376, 0.00352, 0.00334, 0.00321, 0.00313, 0.00307,
#                       0.00301, 0.00294, 0.00284, 0.00270, 0.00254, 0.00234,
#                       0.00212, 0.00190, 0.00164, 0.00138, 0.00113, 0.00090,
#                       0.00070, 0.00054, 0.00042, 0.00035, 0.00030, 0.00026,
#                       0.00023, 0.00021, 0.00019, 0.00017, 0.00016, 0.00015,
#                       0.00014, 0.00013, 0.00012, 0.00015, 0.00016, 0.00017,
#                       0.00018, 0.00019, 0.00020, 0.00021, 0.00023, 0.00024,
#                       0.00025, 0.00025, 0.00025, 0.00025, 0.00024, 0.00022,
#                       0.00020, 0.00019, 0.]),
    # Note, due to filtering done on different length signals, these end up
    # being slightly off from the MATLAB output (above) - I think it's fine though..
                pipeline.RecvFunc(amp = np.array([-0.001, -0.001, -0.,  0.,  0,
                        -0.   , -0.001, -0.004, -0.008, -0.016, -0.027, -0.041,
                        -0.06 , -0.082, -0.104, -0.124, -0.136, -0.135, -0.123,
                        -0.103, -0.08 , -0.058, -0.04 , -0.026, -0.015, -0.008,
                        -0.003, -0.001,  0,  0.001,  0, -0, -0.001, -0.001,
                        -0.001, -0.001, -0.001, -0.001, -0.001, -0, 0,  0.001,
                        0.001,  0.002,  0.003,  0.004,  0.005,  0.006, 0.007,
                        0.009,  0.011,  0.013,  0.015,  0.016,  0.016,  0.015,
                        0.014,  0.012,  0.011,  0.01 ,  0.009,  0.008,  0.007,
                        0.007, 0.007,  0.006,  0.006,  0.006,  0.006,  0.005,
                        0.005,  0.005, 0.005,  0.005,  0.005,  0.005,  0.004,
                        0.004,  0.004,  0.004, 0.004,  0.003,  0.003,  0.003,
                        0.003,  0.002,  0.002,  0.002, 0.001,  0.001,  0.001,
                        0.001,  0.001,  0.001,  0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]),
                        std = np.ones(120,),
                        dt = 0.25, rf_phase = 'Sp',
                        ray_param = 0.1157, std_sc = 1, filter_corners = [4,100],
                        weight_by = 'even')),
        ])
    def test_CalcSynthRF(self, name, model, rf_in, expected):
        model = pipeline.MakeFullModel(model)
        rf = pipeline.SynthesiseRF(model, [rf_in])
        self.assertSynthRFalmostEqual(rf[0], expected)

    del deps, model

    # Test surface wave dispersion calculations
    swd_obs = pipeline.SurfaceWaveDisp(period = 1/np.arange(0.02, 0.11, 0.01),
                                       c = np.array([3.9583, 3.8536, 3.6781,
                                                     3.4724, 3.3217, 3.2340,
                                                     3.1850, 3.1572, 3.1410]),
                                        std = np.ones(9,))
    deps = np.concatenate((np.arange(0,10,0.2), np.arange(10,60,1), np.arange(60,201,5)))
    model = pipeline.Model(vs = np.array([3.4, 4.5]), all_deps = deps,
                           idep = np.array([60, 80]),
                           std_rf_sc = 0, lam_rf = 0, std_swd_sc = 0) # irrelevant

    @parameterized.expand([("Moho only", model, 3.1099)])
    def test_homogeneous(self, name, model, expected):
        model = pipeline.MakeFullModel(model)
        self.assertAlmostEqual(
                pipeline._CalcRaylPhaseVelInHalfSpace(model.vp[0], model.vs[0]),
                expected, places = 4)


    @parameterized.expand([
            ("Moho only", model, swd_obs, 0.9, 0, 1.2031),
            ("Moho only", model, swd_obs, 1.5, 3, 3.6431),
            ("Three layers", model._replace(vs = np.array([3.2, 4.0, 4.6]),
                                            idep = np.array([20, 50, 90])),
                                swd_obs, 1.5, 3, 0.5127),
            ("Many layers", model._replace(vs = np.array([3.2, 3.5, 3.8, 4.2, 4.5]),
                                           idep = np.array([3, 15, 42, 60, 90])),
                                swd_obs, 1.9, 8, 10.5059),
            ("Many slow layers", model._replace(vs =np.array([0.7, 1.8, 2.2, 3.5]),
                                                idep = np.array([2, 10, 60, 101])),
                                swd_obs._replace(period = np.array([47])),
                                1.32, 0, 94.0398),
            ("Exact match", model._replace(vs = np.array([3.2, 3.5, 3.8, 4.2, 4.5]),
                                           idep = np.array([3, 15, 42, 60, 90])),
                                swd_obs, 2, 7, 6.33),
        ])
    def test_secular(self, name, model, swd_obs, k_sc, swd_i, expected):
        # k_sc should be between 0.9-2; swd_i between 0-len(swd_obs.period)-1
        model = pipeline.MakeFullModel(model)
        if k_sc <= 1:
            v = k_sc * np.min(model.vs)
        else:
            v = ((k_sc-1)*np.diff([np.min(model.vs), np.max(model.vs)]) +
                    np.min(model.vs))
        om = 2*np.pi/swd_obs.period[swd_i]
        mu = model.rho * model.vs**2
        self.assertAlmostEqual(pipeline._Secular(om/v, om, model.thickness,
                                                 mu, model.rho, model.vp,
                                                 model.vs),
            expected, places = 4)


    @parameterized.expand([
            ("Moho only", model, swd_obs),
            ("Halfspace only", model._replace(vs = np.array([3.]),
                                              idep = np.array([40])),
                                swd_obs._replace(c = np.ones((9))*2.7406)),
            ("Complicated model", model._replace(vs = np.array([4., 1.2, 4.3, 2.7, 3.1]),
                                                 idep = np.array([2, 17, 42, 58, 91])),
                                swd_obs._replace(c = np.array([2.7731, 2.6669, 2.5958,
                                                               2.5647, 2.5514, 2.5301,
                                                               2.4498, 2.1482, 1.8616]))),
            ])

    def test_SurfaceWaveDisp(self, name, model, swd_obs):
        model = pipeline.MakeFullModel(model)
        self.assertSurfaceWaveDispEqual(pipeline.SynthesiseSWD(model, swd_obs, 1e6),
                                        swd_obs)

# =============================================================================
#       Test model acceptance things
# =============================================================================

#   Calculate misfit
    deps = np.concatenate((np.arange(0,10,0.2), np.arange(10,60,1), np.arange(60,201,5)))
    model = pipeline.Model(vs = np.array([3.4, 4.5]), all_deps = deps,
                           idep = np.array([60, 80]),
                           std_rf_sc = np.array([1]), lam_rf = np.array([0.2]),
                           std_swd_sc = 1)
    swd_obs = pipeline.SurfaceWaveDisp(c = 0, std = 0.2,
                                       period = 1/np.arange(0.02,0.11,0.01))
    rf_obs = pipeline.RecvFunc(amp = np.array([0]), dt = 0.25,
                               std = 0.1*np.ones(120,),
                               std_sc = 1, ray_param = 0.0618,
                               rf_phase = 'Ps', filter_corners = [1,100],
                               weight_by = 'even')

    @parameterized.expand([
            ("Moho only", model, swd_obs, rf_obs, 2, 1, 0.00806), #1.0496), check with matlab!
            ("More complicated", model._replace(vs = np.array([1.8, 2.5, 3.7, 4.7, 4.6]),
                                                idep = np.array([12, 30, 42, 68, 120])),
                        swd_obs, rf_obs, 2, 1, 0.01166), #1.535),
            ("Worse misfit", model, swd_obs, rf_obs, 0, 1, 14.9089), #44.197)
            ("Weight differently", model, swd_obs, rf_obs._replace(weight_by = 2),
                         0, 1, 15.4059),
             ("Two RFs", model._replace(std_rf_sc = np.ones(2,),
                                        lam_rf = 0.2*np.ones(2,)),
                         swd_obs, rf_obs, 2, 2, 0.00512)
            ])

    def test_Mahalanobis(self, name, model, swd_obs, rf_obs, round_to,
                         nrfs, expected):
        fullmodel = pipeline.MakeFullModel(model)
        rf_obs = pipeline.SynthesiseRF(fullmodel, [rf_obs])
        swd_obs = pipeline.SynthesiseSWD(fullmodel, swd_obs, 1e6)
        rf_round = [rf_obs[0]._replace(amp = np.round(rf_obs[0].amp, round_to))]
        rf_obs = rf_obs * nrfs # make repeated list
        rf_round = rf_round * nrfs
        swd_round = swd_obs._replace(c = np.round(swd_obs.c, round_to))

        cov = pipeline.CalcCovarianceMatrix(model, rf_obs, swd_obs)

        out = pipeline.Mahalanobis(rf_obs, rf_round, swd_obs,
                                   swd_round, cov.invCovar)
        self.assertAlmostEqual(out, expected, places = 3)


    m_change = pipeline.ModelChange(theta = 0, old_param = 0, new_param = 0,
                                    which_change = '')

#    Calculate acceptance probability
    @parameterized.expand([
            ("Simple Vs Improvement", 0.7, 1.5, 0, 0,
             m_change._replace(which_change = 'Vs'), 1),
            ("Simple Vs Worse", 1.5, 0.7, 0, 0,
             m_change._replace(which_change = 'Vs'), 0.67),
            ("Simple Dep Worse", 1.5, 0.7, 0, 0,
             m_change._replace(which_change = 'Dep'),0.67),
            ("Simple Death Worse", 1.5, 0.7, 0, 0,
             m_change._replace(which_change = 'Death', theta = 1,
                               old_param = 3.4, new_param = 3.6),
                               0.05),
             ("Simple Death Worse", 1.5, 0.7, 0, 0,
             m_change._replace(which_change = 'Death', theta = 1,
                               old_param = 4.3, new_param = 3.3),
                               0.16),
            ("Simple Death Worse", 1.5, 0.7, 0, 0,
             m_change._replace(which_change = 'Death', theta = 1,
                               old_param = 1.3, new_param = 3.3),
                               0.07),
            ("Simple Birth Worse", 4.2, 0.2, 0, 0,
             m_change._replace(which_change = 'Birth', theta = 1,
                               old_param = 3.7, new_param = 3.3),
                               0.92),
            ("Simple Birth Better", 0.2, 0.3, 0, 0,
             m_change._replace(which_change = 'Birth', theta = 1,
                               old_param = 3.7, new_param = 3.3),
                               1),
            ("Simple Noise Worse", 1.5, 0.7, 1, 1,
             m_change._replace(which_change = 'Noise'), 0.67),
            ("Simple Noise Worse", 1.5, 0.7, 1, 2,
             m_change._replace(which_change = 'Noise'), 1),
            ("Simple Noise Worse", 1.5, 0.7, 0.75, 0.25,
             m_change._replace(which_change = 'Noise'), 0.223),

            ])

    def test_AcceptFromLikelihood(self, name, fit_to_obs_m, fit_to_obs_m0,
                         cov_m, cov_m0, model_change, expected):
        keep_yn = np.zeros(10000)
        cov_m = pipeline.CovarianceMatrix(0,0,R=0, detCovar = cov_m)
        cov_m0 = pipeline.CovarianceMatrix(0,0,R=0, detCovar = cov_m0)
        for k in range(keep_yn.size):
            keep_yn[k] = pipeline.AcceptFromLikelihood(fit_to_obs_m,
                   fit_to_obs_m0, cov_m, cov_m0, model_change)[0]
        self.assertAlmostEqual(np.mean(keep_yn), expected, places = 1)

    model = pipeline.Model(vs = np.array([4, 4.5]), idep = np.array([6, 8]),
                           all_deps = np.arange(0.,100.,5),
                           std_rf_sc = 0, lam_rf = 0, std_swd_sc = 0)
    @parameterized.expand([
            ("Moho only", model,  np.array([4, 4, 4, 4, 4, 4, 4,
                                            4, 4, 4, 4, 4, 4, 4,
                                            4.5, 4.5, 4.5, 4.5, 4.5,
                                            4.5, 4.5, 4.5, 4.5, 4.5,
                                            4.5, 4.5, 4.5, 4.5, 4.5,
                                            4.5, 4.5, 4.5, 4.5, 4.5,
                                            4.5, 4.5, 4.5, 4.5, 4.5])),
            ("More complex", model._replace(vs = np.array([1.8, 2.7, 3.5, 4.4, 4.8]),
                                            idep = np.array([2,4,7,10,15])),
                        np.array([1.8, 1.8, 1.8, 1.8, 1.8, 1.8,
                                  2.7, 2.7, 2.7, 2.7, 2.7,
                                  3.5, 3.5, 3.5, 3.5, 3.5, 3.5,
                                  4.4, 4.4, 4.4, 4.4, 4.4, 4.4, 4.4, 4.4,
                                  4.8, 4.8, 4.8, 4.8, 4.8, 4.8, 4.8, 4.8,
                                  4.8, 4.8, 4.8, 4.8, 4.8, 4.8])),
            ])
    def test_SaveModel(self, name, model, expected):
        fullmodel = pipeline.MakeFullModel(model)
        ddeps=np.zeros(model.all_deps.size*2-1)
        ddeps[::2] = model.all_deps
        ddeps[1::2] = model.all_deps[:-1]+np.diff(model.all_deps)/2
        np.testing.assert_array_equal(
                pipeline.SaveModel(fullmodel, ddeps), expected)

    del model, m_change, deps, swd_obs

# =============================================================================
#         Test the whole thing???!
# =============================================================================
    rf_phase = 'Sp' # 'Ps'

    model = pipeline.Model(vs = np.array([3.7, 4.3, 4.7, 4.6]),
                           all_deps = np.concatenate((np.arange(0,10,0.2),
                                                      np.arange(10,60,1),
                                                      np.arange(60,201,5))),
                           idep = np.array([10, 30, 90, 110]),
                           std_rf_sc = np.array([1]),
                           lam_rf = np.array([0.2]), std_swd_sc = 1)



    @parameterized.expand([
        ("Sp simple model, 100 runs", rf_phase, model, 100, 20,
             pipeline.SynthModel(vs = np.array([4.5144]),
                                  vp = np.array([7.9]),
                                  rho = np.array([3.428]),
                                  thickness = np.array([125.]),
                                  layertops = np.array([0.]),
                                  avdep = np.array([62.5]),
                                  ),
            ),
        ("Ps simple model, 120 runs", 'Ps', model, 120, 8,
             pipeline.SynthModel(vs = np.array([4.418, 4.4432]),
                                  vp = np.array([7.752, 7.8]),
                                  rho = np.array([3.205, 3.221]),
                                  thickness = np.array([89.8, 89.8]),
                                  layertops = np.array([0., 89.8]),
                                  avdep = np.array([44.9, 134.7])
                                  ),
            ),
#        ("Both Ps and Sp, 100 runs", 'Both', model._replace(
#                    vs = np.array([2.5, 3.7, 4.3, 4.6]),
#                    idep = np.array([4, 10, 30, 90])),
#                100, 20, pipeline.SynthModel(vs = np.array([4.128, 4.6153]),
#                                             vp = np.array([7.189, 8.077]),
#                                             rho = np.array([3.024, 3.433]),
#                                             thickness = np.array([30.5, 30.5]),
#                                             layertops = np.array([0, 30.5]),
#                                             avdep = np.array([15.25, 45.75]),
#                                             ),
#            ),
        ])

    def testRunJointInv(self, name, rf_phase, model, max_it, rnd_sd, model_out):
        fullmodel = pipeline.MakeFullModel(model)
        all_lims = pipeline.Limits(
                    vs = (0.5, 5.0),dep = (0,200), std_rf_sc = (1, 2),
                    lam_rf = (0.05, 0.5),std_swd_sc = (1, 2),
                    crustal_thick = (25,)
                    )


        swd_in = pipeline.SurfaceWaveDisp(
                    period = np.array([9, 10.12, 11.57, 13.5, 16.2, 20.25, 25,
                                   32, 40, 50, 60, 80,]),
                    c = np.zeros(12,), std = np.sqrt(0.05)*np.ones(12,)
                    )
        swd = pipeline.SynthesiseSWD(fullmodel, swd_in, 1e6)

        if rf_phase == 'Both':
            # NOTE that have to weight by rf2 if inverting 2 RFs so
            # total weighting of each datum (Ps, Sp, SWD) is equal
            # (as weight misfit to SWD and RFs by length of the signal)
            rf_in = pipeline.RecvFunc(amp = np.array([0,1]), dt = 0.25,
                            std = np.sqrt(0.05)*np.ones(120,),
                            rf_phase = 'Ps', ray_param = 0.06147,
                            filter_corners = [1,100], std_sc = 5,
                            weight_by = 'rf2')
            rf_Ps = pipeline.SynthesiseRF(fullmodel, [rf_in])
            rf_in = pipeline.RecvFunc(amp = np.array([0,1]), dt = 0.25,
                            std = np.sqrt(0.05)*np.ones(120,),
                            rf_phase = 'Sp', ray_param = 0.11012,
                            filter_corners = [4,100], std_sc = 5,
                            weight_by = 'rf2')
            rf_Sp = pipeline.SynthesiseRF(fullmodel, [rf_in])

            out = pipeline.JointInversion([rf_Ps[0], rf_Sp[0]], swd, all_lims,
                                          max_it, rnd_sd, 'junk')
            self.assertSynthModelEqual(model_out, out[-1])
        else:

            if rf_phase == 'Ps': rp = 0.06147; fc = [1, 100]
            if rf_phase == 'Sp': rp = 0.11012; fc = [4, 100]
            rf_in = pipeline.RecvFunc(amp = np.array([0,1]), dt = 0.25,
                                      std = np.sqrt(0.05)*np.ones(120,),
                                      rf_phase = rf_phase, ray_param = rp,
                                      filter_corners = fc, std_sc = 5,
                                      weight_by = 'even')
            rf = pipeline.SynthesiseRF(fullmodel, [rf_in])

            out = pipeline.JointInversion(rf, swd, all_lims, max_it, rnd_sd, 'junk')
            self.assertSynthModelEqual(model_out, out[-1])





if __name__ == "__main__":
    unittest.main()
